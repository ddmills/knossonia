/*! For license information please see main.6b05dc0b09e3b72a55b4.js.LICENSE.txt */
(()=>{var leafPrototypes,getProto,__webpack_modules__=[(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__);var _utils_ImageLoader__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);__webpack_require__(2);(0,_utils_ImageLoader__WEBPACK_IMPORTED_MODULE_0__.loadImages)().then((function(){var game=__webpack_require__(3).game;window.game=game,window.ecs=game.ecs,game.start()}))},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{loadImages:()=>loadImages});var loadImage=function(img){return new Promise((function(resolve,reject){img.complete&&resolve(),img.addEventListener("load",(function(){resolve()})),img.addEventListener("error",(function(error){reject(error)}))}))},loadImages=function(){var imgs=Array.from(document.querySelectorAll("img"));return Promise.all(imgs.map(loadImage))}},(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_RESULT__;function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}!function(){"use strict";var HowlerGlobal=function(){this.init()};HowlerGlobal.prototype={init:function(){var self=this||Howler;return self._counter=1e3,self._html5AudioPool=[],self.html5PoolSize=10,self._codecs={},self._howls=[],self._muted=!1,self._volume=1,self._canPlayEvent="canplaythrough",self._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,self.masterGain=null,self.noAudio=!1,self.usingWebAudio=!0,self.autoSuspend=!0,self.ctx=null,self.autoUnlock=!0,self._setup(),self},volume:function(vol){var self=this||Howler;if(vol=parseFloat(vol),self.ctx||setupAudioContext(),void 0!==vol&&vol>=0&&vol<=1){if(self._volume=vol,self._muted)return self;self.usingWebAudio&&self.masterGain.gain.setValueAtTime(vol,Howler.ctx.currentTime);for(var i=0;i<self._howls.length;i++)if(!self._howls[i]._webAudio)for(var ids=self._howls[i]._getSoundIds(),j=0;j<ids.length;j++){var sound=self._howls[i]._soundById(ids[j]);sound&&sound._node&&(sound._node.volume=sound._volume*vol)}return self}return self._volume},mute:function(muted){var self=this||Howler;self.ctx||setupAudioContext(),self._muted=muted,self.usingWebAudio&&self.masterGain.gain.setValueAtTime(muted?0:self._volume,Howler.ctx.currentTime);for(var i=0;i<self._howls.length;i++)if(!self._howls[i]._webAudio)for(var ids=self._howls[i]._getSoundIds(),j=0;j<ids.length;j++){var sound=self._howls[i]._soundById(ids[j]);sound&&sound._node&&(sound._node.muted=!!muted||sound._muted)}return self},stop:function(){for(var self=this||Howler,i=0;i<self._howls.length;i++)self._howls[i].stop();return self},unload:function(){for(var self=this||Howler,i=self._howls.length-1;i>=0;i--)self._howls[i].unload();return self.usingWebAudio&&self.ctx&&void 0!==self.ctx.close&&(self.ctx.close(),self.ctx=null,setupAudioContext()),self},codecs:function(ext){return(this||Howler)._codecs[ext.replace(/^x-/,"")]},_setup:function(){var self=this||Howler;if(self.state=self.ctx&&self.ctx.state||"suspended",self._autoSuspend(),!self.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(self._canPlayEvent="canplay")}catch(e){self.noAudio=!0}else self.noAudio=!0;try{(new Audio).muted&&(self.noAudio=!0)}catch(e){}return self.noAudio||self._setupCodecs(),self},_setupCodecs:function(){var self=this||Howler,audioTest=null;try{audioTest="undefined"!=typeof Audio?new Audio:null}catch(err){return self}if(!audioTest||"function"!=typeof audioTest.canPlayType)return self;var mpegTest=audioTest.canPlayType("audio/mpeg;").replace(/^no$/,""),checkOpera=self._navigator&&self._navigator.userAgent.match(/OPR\/([0-6].)/g),isOldOpera=checkOpera&&parseInt(checkOpera[0].split("/")[1],10)<33;return self._codecs={mp3:!(isOldOpera||!mpegTest&&!audioTest.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!mpegTest,opus:!!audioTest.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!audioTest.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!audioTest.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(audioTest.canPlayType('audio/wav; codecs="1"')||audioTest.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!audioTest.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!audioTest.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(audioTest.canPlayType("audio/x-m4a;")||audioTest.canPlayType("audio/m4a;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(audioTest.canPlayType("audio/x-m4b;")||audioTest.canPlayType("audio/m4b;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(audioTest.canPlayType("audio/x-mp4;")||audioTest.canPlayType("audio/mp4;")||audioTest.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!audioTest.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!audioTest.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!audioTest.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(audioTest.canPlayType("audio/x-flac;")||audioTest.canPlayType("audio/flac;")).replace(/^no$/,"")},self},_unlockAudio:function(){var self=this||Howler;if(!self._audioUnlocked&&self.ctx){self._audioUnlocked=!1,self.autoUnlock=!1,self._mobileUnloaded||44100===self.ctx.sampleRate||(self._mobileUnloaded=!0,self.unload()),self._scratchBuffer=self.ctx.createBuffer(1,1,22050);var unlock=function unlock(e){for(;self._html5AudioPool.length<self.html5PoolSize;)try{var audioNode=new Audio;audioNode._unlocked=!0,self._releaseHtml5Audio(audioNode)}catch(e){self.noAudio=!0;break}for(var i=0;i<self._howls.length;i++)if(!self._howls[i]._webAudio)for(var ids=self._howls[i]._getSoundIds(),j=0;j<ids.length;j++){var sound=self._howls[i]._soundById(ids[j]);sound&&sound._node&&!sound._node._unlocked&&(sound._node._unlocked=!0,sound._node.load())}self._autoResume();var source=self.ctx.createBufferSource();source.buffer=self._scratchBuffer,source.connect(self.ctx.destination),void 0===source.start?source.noteOn(0):source.start(0),"function"==typeof self.ctx.resume&&self.ctx.resume(),source.onended=function(){source.disconnect(0),self._audioUnlocked=!0,document.removeEventListener("touchstart",unlock,!0),document.removeEventListener("touchend",unlock,!0),document.removeEventListener("click",unlock,!0);for(var i=0;i<self._howls.length;i++)self._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",unlock,!0),document.addEventListener("touchend",unlock,!0),document.addEventListener("click",unlock,!0),self}},_obtainHtml5Audio:function(){var self=this||Howler;if(self._html5AudioPool.length)return self._html5AudioPool.pop();var testPlay=(new Audio).play();return testPlay&&"undefined"!=typeof Promise&&(testPlay instanceof Promise||"function"==typeof testPlay.then)&&testPlay.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(audio){var self=this||Howler;return audio._unlocked&&self._html5AudioPool.push(audio),self},_autoSuspend:function(){var self=this;if(self.autoSuspend&&self.ctx&&void 0!==self.ctx.suspend&&Howler.usingWebAudio){for(var i=0;i<self._howls.length;i++)if(self._howls[i]._webAudio)for(var j=0;j<self._howls[i]._sounds.length;j++)if(!self._howls[i]._sounds[j]._paused)return self;return self._suspendTimer&&clearTimeout(self._suspendTimer),self._suspendTimer=setTimeout((function(){if(self.autoSuspend){self._suspendTimer=null,self.state="suspending";var handleSuspension=function(){self.state="suspended",self._resumeAfterSuspend&&(delete self._resumeAfterSuspend,self._autoResume())};self.ctx.suspend().then(handleSuspension,handleSuspension)}}),3e4),self}},_autoResume:function(){var self=this;if(self.ctx&&void 0!==self.ctx.resume&&Howler.usingWebAudio)return"running"===self.state&&"interrupted"!==self.ctx.state&&self._suspendTimer?(clearTimeout(self._suspendTimer),self._suspendTimer=null):"suspended"===self.state||"running"===self.state&&"interrupted"===self.ctx.state?(self.ctx.resume().then((function(){self.state="running";for(var i=0;i<self._howls.length;i++)self._howls[i]._emit("resume")})),self._suspendTimer&&(clearTimeout(self._suspendTimer),self._suspendTimer=null)):"suspending"===self.state&&(self._resumeAfterSuspend=!0),self}};var Howler=new HowlerGlobal,Howl=function(o){o.src&&0!==o.src.length?this.init(o):console.error("An array of source files must be passed with any new Howl.")};Howl.prototype={init:function(o){var self=this;return Howler.ctx||setupAudioContext(),self._autoplay=o.autoplay||!1,self._format="string"!=typeof o.format?o.format:[o.format],self._html5=o.html5||!1,self._muted=o.mute||!1,self._loop=o.loop||!1,self._pool=o.pool||5,self._preload="boolean"!=typeof o.preload&&"metadata"!==o.preload||o.preload,self._rate=o.rate||1,self._sprite=o.sprite||{},self._src="string"!=typeof o.src?o.src:[o.src],self._volume=void 0!==o.volume?o.volume:1,self._xhr={method:o.xhr&&o.xhr.method?o.xhr.method:"GET",headers:o.xhr&&o.xhr.headers?o.xhr.headers:null,withCredentials:!(!o.xhr||!o.xhr.withCredentials)&&o.xhr.withCredentials},self._duration=0,self._state="unloaded",self._sounds=[],self._endTimers={},self._queue=[],self._playLock=!1,self._onend=o.onend?[{fn:o.onend}]:[],self._onfade=o.onfade?[{fn:o.onfade}]:[],self._onload=o.onload?[{fn:o.onload}]:[],self._onloaderror=o.onloaderror?[{fn:o.onloaderror}]:[],self._onplayerror=o.onplayerror?[{fn:o.onplayerror}]:[],self._onpause=o.onpause?[{fn:o.onpause}]:[],self._onplay=o.onplay?[{fn:o.onplay}]:[],self._onstop=o.onstop?[{fn:o.onstop}]:[],self._onmute=o.onmute?[{fn:o.onmute}]:[],self._onvolume=o.onvolume?[{fn:o.onvolume}]:[],self._onrate=o.onrate?[{fn:o.onrate}]:[],self._onseek=o.onseek?[{fn:o.onseek}]:[],self._onunlock=o.onunlock?[{fn:o.onunlock}]:[],self._onresume=[],self._webAudio=Howler.usingWebAudio&&!self._html5,void 0!==Howler.ctx&&Howler.ctx&&Howler.autoUnlock&&Howler._unlockAudio(),Howler._howls.push(self),self._autoplay&&self._queue.push({event:"play",action:function(){self.play()}}),self._preload&&"none"!==self._preload&&self.load(),self},load:function(){var url=null;if(Howler.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var i=0;i<this._src.length;i++){var ext,str;if(this._format&&this._format[i])ext=this._format[i];else{if("string"!=typeof(str=this._src[i])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(ext=/^data:audio\/([^;,]+);/i.exec(str))||(ext=/\.([^.]+)$/.exec(str.split("?",1)[0])),ext&&(ext=ext[1].toLowerCase())}if(ext||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),ext&&Howler.codecs(ext)){url=this._src[i];break}}if(url)return this._src=url,this._state="loading","https:"===window.location.protocol&&"http:"===url.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new Sound(this),this._webAudio&&loadBuffer(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(sprite,internal){var self=this,id=null;if("number"==typeof sprite)id=sprite,sprite=null;else{if("string"==typeof sprite&&"loaded"===self._state&&!self._sprite[sprite])return null;if(void 0===sprite&&(sprite="__default",!self._playLock)){for(var num=0,i=0;i<self._sounds.length;i++)self._sounds[i]._paused&&!self._sounds[i]._ended&&(num++,id=self._sounds[i]._id);1===num?sprite=null:id=null}}var sound=id?self._soundById(id):self._inactiveSound();if(!sound)return null;if(id&&!sprite&&(sprite=sound._sprite||"__default"),"loaded"!==self._state){sound._sprite=sprite,sound._ended=!1;var soundId=sound._id;return self._queue.push({event:"play",action:function(){self.play(soundId)}}),soundId}if(id&&!sound._paused)return internal||self._loadQueue("play"),sound._id;self._webAudio&&Howler._autoResume();var seek=Math.max(0,sound._seek>0?sound._seek:self._sprite[sprite][0]/1e3),duration=Math.max(0,(self._sprite[sprite][0]+self._sprite[sprite][1])/1e3-seek),timeout=1e3*duration/Math.abs(sound._rate),start=self._sprite[sprite][0]/1e3,stop=(self._sprite[sprite][0]+self._sprite[sprite][1])/1e3;sound._sprite=sprite,sound._ended=!1;var setParams=function(){sound._paused=!1,sound._seek=seek,sound._start=start,sound._stop=stop,sound._loop=!(!sound._loop&&!self._sprite[sprite][2])};if(!(seek>=stop)){var node=sound._node;if(self._webAudio){var playWebAudio=function(){self._playLock=!1,setParams(),self._refreshBuffer(sound);var vol=sound._muted||self._muted?0:sound._volume;node.gain.setValueAtTime(vol,Howler.ctx.currentTime),sound._playStart=Howler.ctx.currentTime,void 0===node.bufferSource.start?sound._loop?node.bufferSource.noteGrainOn(0,seek,86400):node.bufferSource.noteGrainOn(0,seek,duration):sound._loop?node.bufferSource.start(0,seek,86400):node.bufferSource.start(0,seek,duration),timeout!==1/0&&(self._endTimers[sound._id]=setTimeout(self._ended.bind(self,sound),timeout)),internal||setTimeout((function(){self._emit("play",sound._id),self._loadQueue()}),0)};"running"===Howler.state&&"interrupted"!==Howler.ctx.state?playWebAudio():(self._playLock=!0,self.once("resume",playWebAudio),self._clearTimer(sound._id))}else{var playHtml5=function(){node.currentTime=seek,node.muted=sound._muted||self._muted||Howler._muted||node.muted,node.volume=sound._volume*Howler.volume(),node.playbackRate=sound._rate;try{var play=node.play();if(play&&"undefined"!=typeof Promise&&(play instanceof Promise||"function"==typeof play.then)?(self._playLock=!0,setParams(),play.then((function(){self._playLock=!1,node._unlocked=!0,internal||(self._emit("play",sound._id),self._loadQueue())})).catch((function(){self._playLock=!1,self._emit("playerror",sound._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),sound._ended=!0,sound._paused=!0}))):internal||(self._playLock=!1,setParams(),self._emit("play",sound._id),self._loadQueue()),node.playbackRate=sound._rate,node.paused)return void self._emit("playerror",sound._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==sprite||sound._loop?self._endTimers[sound._id]=setTimeout(self._ended.bind(self,sound),timeout):(self._endTimers[sound._id]=function(){self._ended(sound),node.removeEventListener("ended",self._endTimers[sound._id],!1)},node.addEventListener("ended",self._endTimers[sound._id],!1))}catch(err){self._emit("playerror",sound._id,err)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===node.src&&(node.src=self._src,node.load());var loadedNoReadyState=window&&window.ejecta||!node.readyState&&Howler._navigator.isCocoonJS;if(node.readyState>=3||loadedNoReadyState)playHtml5();else{self._playLock=!0;node.addEventListener(Howler._canPlayEvent,(function listener(){playHtml5(),node.removeEventListener(Howler._canPlayEvent,listener,!1)}),!1),self._clearTimer(sound._id)}}return sound._id}self._ended(sound)},pause:function(id){var self=this;if("loaded"!==self._state||self._playLock)return self._queue.push({event:"pause",action:function(){self.pause(id)}}),self;for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++){self._clearTimer(ids[i]);var sound=self._soundById(ids[i]);if(sound&&!sound._paused&&(sound._seek=self.seek(ids[i]),sound._rateSeek=0,sound._paused=!0,self._stopFade(ids[i]),sound._node))if(self._webAudio){if(!sound._node.bufferSource)continue;void 0===sound._node.bufferSource.stop?sound._node.bufferSource.noteOff(0):sound._node.bufferSource.stop(0),self._cleanBuffer(sound._node)}else isNaN(sound._node.duration)&&sound._node.duration!==1/0||sound._node.pause();arguments[1]||self._emit("pause",sound?sound._id:null)}return self},stop:function(id,internal){var self=this;if("loaded"!==self._state||self._playLock)return self._queue.push({event:"stop",action:function(){self.stop(id)}}),self;for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++){self._clearTimer(ids[i]);var sound=self._soundById(ids[i]);sound&&(sound._seek=sound._start||0,sound._rateSeek=0,sound._paused=!0,sound._ended=!0,self._stopFade(ids[i]),sound._node&&(self._webAudio?sound._node.bufferSource&&(void 0===sound._node.bufferSource.stop?sound._node.bufferSource.noteOff(0):sound._node.bufferSource.stop(0),self._cleanBuffer(sound._node)):isNaN(sound._node.duration)&&sound._node.duration!==1/0||(sound._node.currentTime=sound._start||0,sound._node.pause(),sound._node.duration===1/0&&self._clearSound(sound._node))),internal||self._emit("stop",sound._id))}return self},mute:function(muted,id){var self=this;if("loaded"!==self._state||self._playLock)return self._queue.push({event:"mute",action:function(){self.mute(muted,id)}}),self;if(void 0===id){if("boolean"!=typeof muted)return self._muted;self._muted=muted}for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++){var sound=self._soundById(ids[i]);sound&&(sound._muted=muted,sound._interval&&self._stopFade(sound._id),self._webAudio&&sound._node?sound._node.gain.setValueAtTime(muted?0:sound._volume,Howler.ctx.currentTime):sound._node&&(sound._node.muted=!!Howler._muted||muted),self._emit("mute",sound._id))}return self},volume:function(){var vol,id,sound,self=this,args=arguments;if(0===args.length)return self._volume;if(1===args.length||2===args.length&&void 0===args[1]){var ids=self._getSoundIds(),index=ids.indexOf(args[0]);index>=0?id=parseInt(args[0],10):vol=parseFloat(args[0])}else args.length>=2&&(vol=parseFloat(args[0]),id=parseInt(args[1],10));if(!(void 0!==vol&&vol>=0&&vol<=1))return(sound=id?self._soundById(id):self._sounds[0])?sound._volume:0;if("loaded"!==self._state||self._playLock)return self._queue.push({event:"volume",action:function(){self.volume.apply(self,args)}}),self;void 0===id&&(self._volume=vol),id=self._getSoundIds(id);for(var i=0;i<id.length;i++)(sound=self._soundById(id[i]))&&(sound._volume=vol,args[2]||self._stopFade(id[i]),self._webAudio&&sound._node&&!sound._muted?sound._node.gain.setValueAtTime(vol,Howler.ctx.currentTime):sound._node&&!sound._muted&&(sound._node.volume=vol*Howler.volume()),self._emit("volume",sound._id));return self},fade:function(from,to,len,id){var self=this;if("loaded"!==self._state||self._playLock)return self._queue.push({event:"fade",action:function(){self.fade(from,to,len,id)}}),self;from=Math.min(Math.max(0,parseFloat(from)),1),to=Math.min(Math.max(0,parseFloat(to)),1),len=parseFloat(len),self.volume(from,id);for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++){var sound=self._soundById(ids[i]);if(sound){if(id||self._stopFade(ids[i]),self._webAudio&&!sound._muted){var currentTime=Howler.ctx.currentTime,end=currentTime+len/1e3;sound._volume=from,sound._node.gain.setValueAtTime(from,currentTime),sound._node.gain.linearRampToValueAtTime(to,end)}self._startFadeInterval(sound,from,to,len,ids[i],void 0===id)}}return self},_startFadeInterval:function(sound,from,to,len,id,isGroup){var self=this,vol=from,diff=to-from,steps=Math.abs(diff/.01),stepLen=Math.max(4,steps>0?len/steps:len),lastTick=Date.now();sound._fadeTo=to,sound._interval=setInterval((function(){var tick=(Date.now()-lastTick)/len;lastTick=Date.now(),vol+=diff*tick,vol=Math.round(100*vol)/100,vol=diff<0?Math.max(to,vol):Math.min(to,vol),self._webAudio?sound._volume=vol:self.volume(vol,sound._id,!0),isGroup&&(self._volume=vol),(to<from&&vol<=to||to>from&&vol>=to)&&(clearInterval(sound._interval),sound._interval=null,sound._fadeTo=null,self.volume(to,sound._id),self._emit("fade",sound._id))}),stepLen)},_stopFade:function(id){var sound=this._soundById(id);return sound&&sound._interval&&(this._webAudio&&sound._node.gain.cancelScheduledValues(Howler.ctx.currentTime),clearInterval(sound._interval),sound._interval=null,this.volume(sound._fadeTo,id),sound._fadeTo=null,this._emit("fade",id)),this},loop:function(){var loop,id,sound,self=this,args=arguments;if(0===args.length)return self._loop;if(1===args.length){if("boolean"!=typeof args[0])return!!(sound=self._soundById(parseInt(args[0],10)))&&sound._loop;loop=args[0],self._loop=loop}else 2===args.length&&(loop=args[0],id=parseInt(args[1],10));for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++)(sound=self._soundById(ids[i]))&&(sound._loop=loop,self._webAudio&&sound._node&&sound._node.bufferSource&&(sound._node.bufferSource.loop=loop,loop&&(sound._node.bufferSource.loopStart=sound._start||0,sound._node.bufferSource.loopEnd=sound._stop)));return self},rate:function(){var rate,id,sound,self=this,args=arguments;if(0===args.length)id=self._sounds[0]._id;else if(1===args.length){var ids=self._getSoundIds(),index=ids.indexOf(args[0]);index>=0?id=parseInt(args[0],10):rate=parseFloat(args[0])}else 2===args.length&&(rate=parseFloat(args[0]),id=parseInt(args[1],10));if("number"!=typeof rate)return(sound=self._soundById(id))?sound._rate:self._rate;if("loaded"!==self._state||self._playLock)return self._queue.push({event:"rate",action:function(){self.rate.apply(self,args)}}),self;void 0===id&&(self._rate=rate),id=self._getSoundIds(id);for(var i=0;i<id.length;i++)if(sound=self._soundById(id[i])){self.playing(id[i])&&(sound._rateSeek=self.seek(id[i]),sound._playStart=self._webAudio?Howler.ctx.currentTime:sound._playStart),sound._rate=rate,self._webAudio&&sound._node&&sound._node.bufferSource?sound._node.bufferSource.playbackRate.setValueAtTime(rate,Howler.ctx.currentTime):sound._node&&(sound._node.playbackRate=rate);var seek=self.seek(id[i]),duration=(self._sprite[sound._sprite][0]+self._sprite[sound._sprite][1])/1e3-seek,timeout=1e3*duration/Math.abs(sound._rate);!self._endTimers[id[i]]&&sound._paused||(self._clearTimer(id[i]),self._endTimers[id[i]]=setTimeout(self._ended.bind(self,sound),timeout)),self._emit("rate",sound._id)}return self},seek:function(){var seek,id,self=this,args=arguments;if(0===args.length)id=self._sounds[0]._id;else if(1===args.length){var ids=self._getSoundIds(),index=ids.indexOf(args[0]);index>=0?id=parseInt(args[0],10):self._sounds.length&&(id=self._sounds[0]._id,seek=parseFloat(args[0]))}else 2===args.length&&(seek=parseFloat(args[0]),id=parseInt(args[1],10));if(void 0===id)return self;if("number"==typeof seek&&("loaded"!==self._state||self._playLock))return self._queue.push({event:"seek",action:function(){self.seek.apply(self,args)}}),self;var sound=self._soundById(id);if(sound){if(!("number"==typeof seek&&seek>=0)){if(self._webAudio){var realTime=self.playing(id)?Howler.ctx.currentTime-sound._playStart:0,rateSeek=sound._rateSeek?sound._rateSeek-sound._seek:0;return sound._seek+(rateSeek+realTime*Math.abs(sound._rate))}return sound._node.currentTime}var playing=self.playing(id);playing&&self.pause(id,!0),sound._seek=seek,sound._ended=!1,self._clearTimer(id),self._webAudio||!sound._node||isNaN(sound._node.duration)||(sound._node.currentTime=seek);var seekAndEmit=function(){self._emit("seek",id),playing&&self.play(id,!0)};if(playing&&!self._webAudio){var emitSeek=function emitSeek(){self._playLock?setTimeout(emitSeek,0):seekAndEmit()};setTimeout(emitSeek,0)}else seekAndEmit()}return self},playing:function(id){if("number"==typeof id){var sound=this._soundById(id);return!!sound&&!sound._paused}for(var i=0;i<this._sounds.length;i++)if(!this._sounds[i]._paused)return!0;return!1},duration:function(id){var duration=this._duration,sound=this._soundById(id);return sound&&(duration=this._sprite[sound._sprite][1]/1e3),duration},state:function(){return this._state},unload:function(){for(var self=this,sounds=self._sounds,i=0;i<sounds.length;i++)sounds[i]._paused||self.stop(sounds[i]._id),self._webAudio||(self._clearSound(sounds[i]._node),sounds[i]._node.removeEventListener("error",sounds[i]._errorFn,!1),sounds[i]._node.removeEventListener(Howler._canPlayEvent,sounds[i]._loadFn,!1),sounds[i]._node.removeEventListener("ended",sounds[i]._endFn,!1),Howler._releaseHtml5Audio(sounds[i]._node)),delete sounds[i]._node,self._clearTimer(sounds[i]._id);var index=Howler._howls.indexOf(self);index>=0&&Howler._howls.splice(index,1);var remCache=!0;for(i=0;i<Howler._howls.length;i++)if(Howler._howls[i]._src===self._src||self._src.indexOf(Howler._howls[i]._src)>=0){remCache=!1;break}return cache&&remCache&&delete cache[self._src],Howler.noAudio=!1,self._state="unloaded",self._sounds=[],self=null,null},on:function(event,fn,id,once){var events=this["_on"+event];return"function"==typeof fn&&events.push(once?{id,fn,once}:{id,fn}),this},off:function(event,fn,id){var events=this["_on"+event],i=0;if("number"==typeof fn&&(id=fn,fn=null),fn||id)for(i=0;i<events.length;i++){var isId=id===events[i].id;if(fn===events[i].fn&&isId||!fn&&isId){events.splice(i,1);break}}else if(event)this["_on"+event]=[];else{var keys=Object.keys(this);for(i=0;i<keys.length;i++)0===keys[i].indexOf("_on")&&Array.isArray(this[keys[i]])&&(this[keys[i]]=[])}return this},once:function(event,fn,id){return this.on(event,fn,id,1),this},_emit:function(event,id,msg){for(var events=this["_on"+event],i=events.length-1;i>=0;i--)events[i].id&&events[i].id!==id&&"load"!==event||(setTimeout(function(fn){fn.call(this,id,msg)}.bind(this,events[i].fn),0),events[i].once&&this.off(event,events[i].fn,events[i].id));return this._loadQueue(event),this},_loadQueue:function(event){if(this._queue.length>0){var task=this._queue[0];task.event===event&&(this._queue.shift(),this._loadQueue()),event||task.action()}return this},_ended:function(sound){var sprite=sound._sprite;if(!this._webAudio&&sound._node&&!sound._node.paused&&!sound._node.ended&&sound._node.currentTime<sound._stop)return setTimeout(this._ended.bind(this,sound),100),this;var loop=!(!sound._loop&&!this._sprite[sprite][2]);if(this._emit("end",sound._id),!this._webAudio&&loop&&this.stop(sound._id,!0).play(sound._id),this._webAudio&&loop){this._emit("play",sound._id),sound._seek=sound._start||0,sound._rateSeek=0,sound._playStart=Howler.ctx.currentTime;var timeout=1e3*(sound._stop-sound._start)/Math.abs(sound._rate);this._endTimers[sound._id]=setTimeout(this._ended.bind(this,sound),timeout)}return this._webAudio&&!loop&&(sound._paused=!0,sound._ended=!0,sound._seek=sound._start||0,sound._rateSeek=0,this._clearTimer(sound._id),this._cleanBuffer(sound._node),Howler._autoSuspend()),this._webAudio||loop||this.stop(sound._id,!0),this},_clearTimer:function(id){if(this._endTimers[id]){if("function"!=typeof this._endTimers[id])clearTimeout(this._endTimers[id]);else{var sound=this._soundById(id);sound&&sound._node&&sound._node.removeEventListener("ended",this._endTimers[id],!1)}delete this._endTimers[id]}return this},_soundById:function(id){for(var i=0;i<this._sounds.length;i++)if(id===this._sounds[i]._id)return this._sounds[i];return null},_inactiveSound:function(){this._drain();for(var i=0;i<this._sounds.length;i++)if(this._sounds[i]._ended)return this._sounds[i].reset();return new Sound(this)},_drain:function(){var limit=this._pool,cnt=0,i=0;if(!(this._sounds.length<limit)){for(i=0;i<this._sounds.length;i++)this._sounds[i]._ended&&cnt++;for(i=this._sounds.length-1;i>=0;i--){if(cnt<=limit)return;this._sounds[i]._ended&&(this._webAudio&&this._sounds[i]._node&&this._sounds[i]._node.disconnect(0),this._sounds.splice(i,1),cnt--)}}},_getSoundIds:function(id){if(void 0===id){for(var ids=[],i=0;i<this._sounds.length;i++)ids.push(this._sounds[i]._id);return ids}return[id]},_refreshBuffer:function(sound){return sound._node.bufferSource=Howler.ctx.createBufferSource(),sound._node.bufferSource.buffer=cache[this._src],sound._panner?sound._node.bufferSource.connect(sound._panner):sound._node.bufferSource.connect(sound._node),sound._node.bufferSource.loop=sound._loop,sound._loop&&(sound._node.bufferSource.loopStart=sound._start||0,sound._node.bufferSource.loopEnd=sound._stop||0),sound._node.bufferSource.playbackRate.setValueAtTime(sound._rate,Howler.ctx.currentTime),this},_cleanBuffer:function(node){var isIOS=Howler._navigator&&Howler._navigator.vendor.indexOf("Apple")>=0;if(Howler._scratchBuffer&&node.bufferSource&&(node.bufferSource.onended=null,node.bufferSource.disconnect(0),isIOS))try{node.bufferSource.buffer=Howler._scratchBuffer}catch(e){}return node.bufferSource=null,this},_clearSound:function(node){/MSIE |Trident\//.test(Howler._navigator&&Howler._navigator.userAgent)||(node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var Sound=function(howl){this._parent=howl,this.init()};Sound.prototype={init:function(){var parent=this._parent;return this._muted=parent._muted,this._loop=parent._loop,this._volume=parent._volume,this._rate=parent._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++Howler._counter,parent._sounds.push(this),this.create(),this},create:function(){var parent=this._parent,volume=Howler._muted||this._muted||this._parent._muted?0:this._volume;return parent._webAudio?(this._node=void 0===Howler.ctx.createGain?Howler.ctx.createGainNode():Howler.ctx.createGain(),this._node.gain.setValueAtTime(volume,Howler.ctx.currentTime),this._node.paused=!0,this._node.connect(Howler.masterGain)):Howler.noAudio||(this._node=Howler._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(Howler._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=parent._src,this._node.preload=!0===parent._preload?"auto":parent._preload,this._node.volume=volume*Howler.volume(),this._node.load()),this},reset:function(){var parent=this._parent;return this._muted=parent._muted,this._loop=parent._loop,this._volume=parent._volume,this._rate=parent._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++Howler._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var parent=this._parent;parent._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(parent._sprite).length&&(parent._sprite={__default:[0,1e3*parent._duration]}),"loaded"!==parent._state&&(parent._state="loaded",parent._emit("load"),parent._loadQueue()),this._node.removeEventListener(Howler._canPlayEvent,this._loadFn,!1)},_endListener:function(){var parent=this._parent;parent._duration===1/0&&(parent._duration=Math.ceil(10*this._node.duration)/10,parent._sprite.__default[1]===1/0&&(parent._sprite.__default[1]=1e3*parent._duration),parent._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var cache={},loadBuffer=function(self){var url=self._src;if(cache[url])return self._duration=cache[url].duration,void loadSound(self);if(/^data:[^;]+;base64,/.test(url)){for(var data=atob(url.split(",")[1]),dataView=new Uint8Array(data.length),i=0;i<data.length;++i)dataView[i]=data.charCodeAt(i);decodeAudioData(dataView.buffer,self)}else{var xhr=new XMLHttpRequest;xhr.open(self._xhr.method,url,!0),xhr.withCredentials=self._xhr.withCredentials,xhr.responseType="arraybuffer",self._xhr.headers&&Object.keys(self._xhr.headers).forEach((function(key){xhr.setRequestHeader(key,self._xhr.headers[key])})),xhr.onload=function(){var code=(xhr.status+"")[0];"0"===code||"2"===code||"3"===code?decodeAudioData(xhr.response,self):self._emit("loaderror",null,"Failed loading audio file with status: "+xhr.status+".")},xhr.onerror=function(){self._webAudio&&(self._html5=!0,self._webAudio=!1,self._sounds=[],delete cache[url],self.load())},safeXhrSend(xhr)}},safeXhrSend=function(xhr){try{xhr.send()}catch(e){xhr.onerror()}},decodeAudioData=function(arraybuffer,self){var error=function(){self._emit("loaderror",null,"Decoding audio data failed.")},success=function(buffer){buffer&&self._sounds.length>0?(cache[self._src]=buffer,loadSound(self,buffer)):error()};"undefined"!=typeof Promise&&1===Howler.ctx.decodeAudioData.length?Howler.ctx.decodeAudioData(arraybuffer).then(success).catch(error):Howler.ctx.decodeAudioData(arraybuffer,success,error)},loadSound=function(self,buffer){buffer&&!self._duration&&(self._duration=buffer.duration),0===Object.keys(self._sprite).length&&(self._sprite={__default:[0,1e3*self._duration]}),"loaded"!==self._state&&(self._state="loaded",self._emit("load"),self._loadQueue())},setupAudioContext=function(){if(Howler.usingWebAudio){try{"undefined"!=typeof AudioContext?Howler.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?Howler.ctx=new webkitAudioContext:Howler.usingWebAudio=!1}catch(e){Howler.usingWebAudio=!1}Howler.ctx||(Howler.usingWebAudio=!1);var iOS=/iP(hone|od|ad)/.test(Howler._navigator&&Howler._navigator.platform),appVersion=Howler._navigator&&Howler._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),version=appVersion?parseInt(appVersion[1],10):null;if(iOS&&version&&version<9){var safari=/safari/.test(Howler._navigator&&Howler._navigator.userAgent.toLowerCase());Howler._navigator&&!safari&&(Howler.usingWebAudio=!1)}Howler.usingWebAudio&&(Howler.masterGain=void 0===Howler.ctx.createGain?Howler.ctx.createGainNode():Howler.ctx.createGain(),Howler.masterGain.gain.setValueAtTime(Howler._muted?0:Howler._volume,Howler.ctx.currentTime),Howler.masterGain.connect(Howler.ctx.destination)),Howler._setup()}};void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return{Howler,Howl}}.apply(exports,[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__),exports.Howler=Howler,exports.Howl=Howl,void 0!==__webpack_require__.g?(__webpack_require__.g.HowlerGlobal=HowlerGlobal,__webpack_require__.g.Howler=Howler,__webpack_require__.g.Howl=Howl,__webpack_require__.g.Sound=Sound):"undefined"!=typeof window&&(window.HowlerGlobal=HowlerGlobal,window.Howler=Howler,window.Howl=Howl,window.Sound=Sound)}(),function(){"use strict";var _super;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(pan){if(!this.ctx||!this.ctx.listener)return this;for(var i=this._howls.length-1;i>=0;i--)this._howls[i].stereo(pan);return this},HowlerGlobal.prototype.pos=function(x,y,z){return this.ctx&&this.ctx.listener?(y="number"!=typeof y?this._pos[1]:y,z="number"!=typeof z?this._pos[2]:z,"number"!=typeof x?this._pos:(this._pos=[x,y,z],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(x,y,z,xUp,yUp,zUp){if(!this.ctx||!this.ctx.listener)return this;var or=this._orientation;return y="number"!=typeof y?or[1]:y,z="number"!=typeof z?or[2]:z,xUp="number"!=typeof xUp?or[3]:xUp,yUp="number"!=typeof yUp?or[4]:yUp,zUp="number"!=typeof zUp?or[5]:zUp,"number"!=typeof x?or:(this._orientation=[x,y,z,xUp,yUp,zUp],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(x,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(y,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(z,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(xUp,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(yUp,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(zUp,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(x,y,z,xUp,yUp,zUp),this)},Howl.prototype.init=(_super=Howl.prototype.init,function(o){return this._orientation=o.orientation||[1,0,0],this._stereo=o.stereo||null,this._pos=o.pos||null,this._pannerAttr={coneInnerAngle:void 0!==o.coneInnerAngle?o.coneInnerAngle:360,coneOuterAngle:void 0!==o.coneOuterAngle?o.coneOuterAngle:360,coneOuterGain:void 0!==o.coneOuterGain?o.coneOuterGain:0,distanceModel:void 0!==o.distanceModel?o.distanceModel:"inverse",maxDistance:void 0!==o.maxDistance?o.maxDistance:1e4,panningModel:void 0!==o.panningModel?o.panningModel:"HRTF",refDistance:void 0!==o.refDistance?o.refDistance:1,rolloffFactor:void 0!==o.rolloffFactor?o.rolloffFactor:1},this._onstereo=o.onstereo?[{fn:o.onstereo}]:[],this._onpos=o.onpos?[{fn:o.onpos}]:[],this._onorientation=o.onorientation?[{fn:o.onorientation}]:[],_super.call(this,o)}),Howl.prototype.stereo=function(pan,id){var self=this;if(!self._webAudio)return self;if("loaded"!==self._state)return self._queue.push({event:"stereo",action:function(){self.stereo(pan,id)}}),self;var pannerType=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===id){if("number"!=typeof pan)return self._stereo;self._stereo=pan,self._pos=[pan,0,0]}for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++){var sound=self._soundById(ids[i]);if(sound){if("number"!=typeof pan)return sound._stereo;sound._stereo=pan,sound._pos=[pan,0,0],sound._node&&(sound._pannerAttr.panningModel="equalpower",sound._panner&&sound._panner.pan||setupPanner(sound,pannerType),"spatial"===pannerType?void 0!==sound._panner.positionX?(sound._panner.positionX.setValueAtTime(pan,Howler.ctx.currentTime),sound._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),sound._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):sound._panner.setPosition(pan,0,0):sound._panner.pan.setValueAtTime(pan,Howler.ctx.currentTime)),self._emit("stereo",sound._id)}}return self},Howl.prototype.pos=function(x,y,z,id){var self=this;if(!self._webAudio)return self;if("loaded"!==self._state)return self._queue.push({event:"pos",action:function(){self.pos(x,y,z,id)}}),self;if(y="number"!=typeof y?0:y,z="number"!=typeof z?-.5:z,void 0===id){if("number"!=typeof x)return self._pos;self._pos=[x,y,z]}for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++){var sound=self._soundById(ids[i]);if(sound){if("number"!=typeof x)return sound._pos;sound._pos=[x,y,z],sound._node&&(sound._panner&&!sound._panner.pan||setupPanner(sound,"spatial"),void 0!==sound._panner.positionX?(sound._panner.positionX.setValueAtTime(x,Howler.ctx.currentTime),sound._panner.positionY.setValueAtTime(y,Howler.ctx.currentTime),sound._panner.positionZ.setValueAtTime(z,Howler.ctx.currentTime)):sound._panner.setPosition(x,y,z)),self._emit("pos",sound._id)}}return self},Howl.prototype.orientation=function(x,y,z,id){var self=this;if(!self._webAudio)return self;if("loaded"!==self._state)return self._queue.push({event:"orientation",action:function(){self.orientation(x,y,z,id)}}),self;if(y="number"!=typeof y?self._orientation[1]:y,z="number"!=typeof z?self._orientation[2]:z,void 0===id){if("number"!=typeof x)return self._orientation;self._orientation=[x,y,z]}for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++){var sound=self._soundById(ids[i]);if(sound){if("number"!=typeof x)return sound._orientation;sound._orientation=[x,y,z],sound._node&&(sound._panner||(sound._pos||(sound._pos=self._pos||[0,0,-.5]),setupPanner(sound,"spatial")),void 0!==sound._panner.orientationX?(sound._panner.orientationX.setValueAtTime(x,Howler.ctx.currentTime),sound._panner.orientationY.setValueAtTime(y,Howler.ctx.currentTime),sound._panner.orientationZ.setValueAtTime(z,Howler.ctx.currentTime)):sound._panner.setOrientation(x,y,z)),self._emit("orientation",sound._id)}}return self},Howl.prototype.pannerAttr=function(){var o,id,sound,self=this,args=arguments;if(!self._webAudio)return self;if(0===args.length)return self._pannerAttr;if(1===args.length){if("object"!==_typeof(args[0]))return(sound=self._soundById(parseInt(args[0],10)))?sound._pannerAttr:self._pannerAttr;o=args[0],void 0===id&&(o.pannerAttr||(o.pannerAttr={coneInnerAngle:o.coneInnerAngle,coneOuterAngle:o.coneOuterAngle,coneOuterGain:o.coneOuterGain,distanceModel:o.distanceModel,maxDistance:o.maxDistance,refDistance:o.refDistance,rolloffFactor:o.rolloffFactor,panningModel:o.panningModel}),self._pannerAttr={coneInnerAngle:void 0!==o.pannerAttr.coneInnerAngle?o.pannerAttr.coneInnerAngle:self._coneInnerAngle,coneOuterAngle:void 0!==o.pannerAttr.coneOuterAngle?o.pannerAttr.coneOuterAngle:self._coneOuterAngle,coneOuterGain:void 0!==o.pannerAttr.coneOuterGain?o.pannerAttr.coneOuterGain:self._coneOuterGain,distanceModel:void 0!==o.pannerAttr.distanceModel?o.pannerAttr.distanceModel:self._distanceModel,maxDistance:void 0!==o.pannerAttr.maxDistance?o.pannerAttr.maxDistance:self._maxDistance,refDistance:void 0!==o.pannerAttr.refDistance?o.pannerAttr.refDistance:self._refDistance,rolloffFactor:void 0!==o.pannerAttr.rolloffFactor?o.pannerAttr.rolloffFactor:self._rolloffFactor,panningModel:void 0!==o.pannerAttr.panningModel?o.pannerAttr.panningModel:self._panningModel})}else 2===args.length&&(o=args[0],id=parseInt(args[1],10));for(var ids=self._getSoundIds(id),i=0;i<ids.length;i++)if(sound=self._soundById(ids[i])){var pa=sound._pannerAttr;pa={coneInnerAngle:void 0!==o.coneInnerAngle?o.coneInnerAngle:pa.coneInnerAngle,coneOuterAngle:void 0!==o.coneOuterAngle?o.coneOuterAngle:pa.coneOuterAngle,coneOuterGain:void 0!==o.coneOuterGain?o.coneOuterGain:pa.coneOuterGain,distanceModel:void 0!==o.distanceModel?o.distanceModel:pa.distanceModel,maxDistance:void 0!==o.maxDistance?o.maxDistance:pa.maxDistance,refDistance:void 0!==o.refDistance?o.refDistance:pa.refDistance,rolloffFactor:void 0!==o.rolloffFactor?o.rolloffFactor:pa.rolloffFactor,panningModel:void 0!==o.panningModel?o.panningModel:pa.panningModel};var panner=sound._panner;panner?(panner.coneInnerAngle=pa.coneInnerAngle,panner.coneOuterAngle=pa.coneOuterAngle,panner.coneOuterGain=pa.coneOuterGain,panner.distanceModel=pa.distanceModel,panner.maxDistance=pa.maxDistance,panner.refDistance=pa.refDistance,panner.rolloffFactor=pa.rolloffFactor,panner.panningModel=pa.panningModel):(sound._pos||(sound._pos=self._pos||[0,0,-.5]),setupPanner(sound,"spatial"))}return self},Sound.prototype.init=function(_super){return function(){var parent=this._parent;this._orientation=parent._orientation,this._stereo=parent._stereo,this._pos=parent._pos,this._pannerAttr=parent._pannerAttr,_super.call(this),this._stereo?parent.stereo(this._stereo):this._pos&&parent.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(_super){return function(){var parent=this._parent;return this._orientation=parent._orientation,this._stereo=parent._stereo,this._pos=parent._pos,this._pannerAttr=parent._pannerAttr,this._stereo?parent.stereo(this._stereo):this._pos?parent.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,parent._refreshBuffer(this)),_super.call(this)}}(Sound.prototype.reset);var setupPanner=function(sound,type){"spatial"===(type=type||"spatial")?(sound._panner=Howler.ctx.createPanner(),sound._panner.coneInnerAngle=sound._pannerAttr.coneInnerAngle,sound._panner.coneOuterAngle=sound._pannerAttr.coneOuterAngle,sound._panner.coneOuterGain=sound._pannerAttr.coneOuterGain,sound._panner.distanceModel=sound._pannerAttr.distanceModel,sound._panner.maxDistance=sound._pannerAttr.maxDistance,sound._panner.refDistance=sound._pannerAttr.refDistance,sound._panner.rolloffFactor=sound._pannerAttr.rolloffFactor,sound._panner.panningModel=sound._pannerAttr.panningModel,void 0!==sound._panner.positionX?(sound._panner.positionX.setValueAtTime(sound._pos[0],Howler.ctx.currentTime),sound._panner.positionY.setValueAtTime(sound._pos[1],Howler.ctx.currentTime),sound._panner.positionZ.setValueAtTime(sound._pos[2],Howler.ctx.currentTime)):sound._panner.setPosition(sound._pos[0],sound._pos[1],sound._pos[2]),void 0!==sound._panner.orientationX?(sound._panner.orientationX.setValueAtTime(sound._orientation[0],Howler.ctx.currentTime),sound._panner.orientationY.setValueAtTime(sound._orientation[1],Howler.ctx.currentTime),sound._panner.orientationZ.setValueAtTime(sound._orientation[2],Howler.ctx.currentTime)):sound._panner.setOrientation(sound._orientation[0],sound._orientation[1],sound._orientation[2])):(sound._panner=Howler.ctx.createStereoPanner(),sound._panner.pan.setValueAtTime(sound._stereo,Howler.ctx.currentTime)),sound._panner.connect(sound._node),sound._paused||sound._parent.pause(sound._id,!0).play(sound._id,!0)}}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Game,game:()=>game});var _rendering_RenderManager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),_input_InputController__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15),_systems_ActionSystem__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(19),_systems_RenderSystem__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(115),_systems_MovementSystem__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(116),_systems_UISystem__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(117),_input_MouseManager__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(118),_input_CommandManager__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(119),_screens_ScreenManager__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(125),_PlayerManager__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(142),_ecs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(143),_GameStateManager__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(172),_ClockManager__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(173),_systems_CursorSystem__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(174),_MapManager__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(175),_systems_FOVSystem__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(177),_systems_MeleeSystem__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(221),_systems_DeathSystem__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(222),_systems_ParticleSystem__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(223),_FactionManager__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(224),_CameraManager__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(225),_systems_FPSMonitoringSystem__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(226),_WorldManager__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(227),_ConsoleManager__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(253),_systems_DestroySystem__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(254),_MusicManager__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(255);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}var _lastUpdate=new WeakMap,Game=function(){function Game(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Game),_lastUpdate.set(this,{writable:!0,value:void 0}),this.engine=new _ecs__WEBPACK_IMPORTED_MODULE_10__.default(this),this.music=new _MusicManager__WEBPACK_IMPORTED_MODULE_25__.default(this),this.mouse=new _input_MouseManager__WEBPACK_IMPORTED_MODULE_6__.default(this),this.clock=new _ClockManager__WEBPACK_IMPORTED_MODULE_12__.default(this),this.renderer=new _rendering_RenderManager__WEBPACK_IMPORTED_MODULE_0__.default(this),this.camera=new _CameraManager__WEBPACK_IMPORTED_MODULE_20__.default(this),this.state=new _GameStateManager__WEBPACK_IMPORTED_MODULE_11__.default(this),this.world=new _WorldManager__WEBPACK_IMPORTED_MODULE_22__.WorldManager(this),this.map=new _MapManager__WEBPACK_IMPORTED_MODULE_14__.default(this),this.factions=new _FactionManager__WEBPACK_IMPORTED_MODULE_19__.default(this),this.player=new _PlayerManager__WEBPACK_IMPORTED_MODULE_9__.default(this),this.commands=new _input_CommandManager__WEBPACK_IMPORTED_MODULE_7__.default(this),this.screens=new _screens_ScreenManager__WEBPACK_IMPORTED_MODULE_8__.default(this),this.input=new _input_InputController__WEBPACK_IMPORTED_MODULE_1__.default(this),this.console=new _ConsoleManager__WEBPACK_IMPORTED_MODULE_23__.default(this),this.actionSystem=new _systems_ActionSystem__WEBPACK_IMPORTED_MODULE_2__.default(this),this.movementSystem=new _systems_MovementSystem__WEBPACK_IMPORTED_MODULE_4__.default(this),this.meleeSystem=new _systems_MeleeSystem__WEBPACK_IMPORTED_MODULE_16__.default(this),this.deathSystem=new _systems_DeathSystem__WEBPACK_IMPORTED_MODULE_17__.default(this),this.FOVSystem=new _systems_FOVSystem__WEBPACK_IMPORTED_MODULE_15__.default(this),this.renderSystem=new _systems_RenderSystem__WEBPACK_IMPORTED_MODULE_3__.default(this),this.UISystem=new _systems_UISystem__WEBPACK_IMPORTED_MODULE_5__.default(this),this.cursor=new _systems_CursorSystem__WEBPACK_IMPORTED_MODULE_13__.default(this),this.particles=new _systems_ParticleSystem__WEBPACK_IMPORTED_MODULE_18__.default(this),this.fps=new _systems_FPSMonitoringSystem__WEBPACK_IMPORTED_MODULE_21__.default(this),this.destroySystem=new _systems_DestroySystem__WEBPACK_IMPORTED_MODULE_24__.default(this)}return _createClass(Game,[{key:"ecs",get:function(){return this.engine.engine}}]),_createClass(Game,[{key:"start",value:function(){_classPrivateFieldSet(this,_lastUpdate,Date.now()),this.boundLoop=this.loop.bind(this),requestAnimationFrame(this.loop.bind(this))}},{key:"updateAdventureSystems",value:function(dt){this.clock.update(dt),this.actionSystem.update(dt),this.movementSystem.update(dt),this.meleeSystem.update(dt),this.deathSystem.update(dt),this.FOVSystem.update(dt),this.renderSystem.update(dt),this.particles.update(dt),this.UISystem.update(dt),this.map.update(dt),this.destroySystem.update(dt),this.console.render(dt)}},{key:"loop",value:function(t){var now=Date.now(),dt=now-function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}(this,_lastUpdate);this.screens.update(dt),this.fps.update(dt),this.renderer.render(),_classPrivateFieldSet(this,_lastUpdate,now),requestAnimationFrame(this.boundLoop)}}]),Game}(),game=new Game},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Renderer});var _Manager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_Display__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),_spritesheets__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _spritesheets=new WeakMap,_display=new WeakMap,Renderer=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Renderer,_Manager);var _super=_createSuper(Renderer);function Renderer(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Renderer),_defineProperty(_assertThisInitialized(_this=_super.call(this,game)),"tileWidth",16),_defineProperty(_assertThisInitialized(_this),"tileHeight",16),_spritesheets.set(_assertThisInitialized(_this),{writable:!0,value:{}}),_display.set(_assertThisInitialized(_this),{writable:!0,value:null}),(0,_spritesheets__WEBPACK_IMPORTED_MODULE_2__.default)().forEach((function(spritesheet){_classPrivateFieldGet(_assertThisInitialized(_this),_spritesheets)[spritesheet.name]=spritesheet})),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_display,new _Display__WEBPACK_IMPORTED_MODULE_1__.default({width:20,height:20,tileWidth:_this.tileWidth,tileHeight:_this.tileHeight})),document.body.appendChild(_this.display.canvas),_this}return _createClass(Renderer,[{key:"display",get:function(){return _classPrivateFieldGet(this,_display)}},{key:"canvas",get:function(){return this.display.canvas}}]),_createClass(Renderer,[{key:"resizeDisplay",value:function(width,height,zoom){this.display.setSize(width,height,zoom)}},{key:"draw",value:function(x,y,_char){var fg1=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#d0d6d8",fg2=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#333",bg=arguments.length>5?arguments[5]:void 0,sprite=_classPrivateFieldGet(this,_spritesheets).tiles.getSprite(_char);this.display.draw(x,y,sprite,fg1,fg2,bg)}},{key:"computeTextWidth",value:function(text){return.5*text.length}},{key:"drawText",value:function(x,y,text){for(var fg1=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#d0d6d8",fg2=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#333",bg=arguments.length>5?arguments[5]:void 0,i=0;i<text.length;i++){var sprite=_classPrivateFieldGet(this,_spritesheets).font.getSprite(text.charAt(i));this.display.draw(x+.5*i,y,sprite,fg1,fg2,bg)}}},{key:"drawTextCenter",value:function(y,text){var fg1=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#d0d6d8",fg2=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#333",bg=arguments.length>4?arguments[4]:void 0,len=this.computeTextWidth(text);this.drawText(Math.ceil((this.game.camera.width-len)/2),y,text,fg1,fg2,bg)}},{key:"clear",value:function(){this.display.clear()}},{key:"clearArea",value:function(x,y,width,height){this.display.clearArea(x,y,width,height)}},{key:"pxToTile",value:function(xPx,yPx){return{x:Math.trunc(xPx/this.tileWidth),y:Math.trunc(yPx/this.tileHeight)}}},{key:"render",value:function(){this.display.render()}}]),Renderer}(_Manager__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Manager});var _game=new WeakMap,Manager=function(){function Manager(game){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Manager),_game.set(this,{writable:!0,value:void 0}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_game,game)}return _createClass(Manager,[{key:"game",get:function(){return function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}(this,_game)}}]),_createClass(Manager,[{key:"onNewGame",value:function(){}},{key:"getSaveGameData",value:function(){}}]),Manager}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Display});var _utils_Grid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var Display=function(){function Display(_ref){var width=_ref.width,height=_ref.height,tileWidth=_ref.tileWidth,tileHeight=_ref.tileHeight;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Display),_defineProperty(this,"ctx",void 0),_defineProperty(this,"canvas",void 0),_defineProperty(this,"width",void 0),_defineProperty(this,"height",void 0),_defineProperty(this,"zoom",1),_defineProperty(this,"tileWidth",void 0),_defineProperty(this,"tileHeight",void 0),_defineProperty(this,"cells",void 0),_defineProperty(this,"clearColor","#141a23"),this.tileWidth=tileWidth,this.tileHeight=tileHeight,this.cells=new _utils_Grid__WEBPACK_IMPORTED_MODULE_0__.default(2*width,height,(function(){return null})),this.cells.suppressOOBWarn=!0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.ctx.globalCompositeOperation="destination-over",this.ctx.font="".concat(this.tileHeight,"px monospace"),this.ctx.textBaseline="top",this.setSize(width,height)}var Constructor,protoProps,staticProps;return Constructor=Display,(protoProps=[{key:"setSize",value:function(width,height,zoom){this.width=width,this.height=height,this.zoom=zoom;var widthPx=this.tileWidth*this.width,heightPx=this.tileHeight*this.height;this.canvas.style.cssText="width: ".concat(widthPx,"px; height: ").concat(heightPx,"px; transform: scale(").concat(this.zoom,")"),this.canvas.width=widthPx,this.canvas.height=heightPx,this.cells.clearAndResize(2*width,height)}},{key:"draw",value:function(x,y,sprite,fg1,fg2,bg){this.cells.set(2*x,y,{img:sprite.colorize(fg1,fg2),width:sprite.width,height:sprite.height,bg,x,y})}},{key:"clear",value:function(){this.ctx.fillStyle=this.clearColor,this.ctx.fillRect(0,0,this.tileWidth*this.width,this.tileHeight*this.height),this.cells.clear()}},{key:"clearArea",value:function(x,y,width,height){this.ctx.fillStyle=this.clearColor,this.ctx.fillRect(x*this.tileWidth,y*this.tileHeight,this.tileWidth*width,this.tileHeight*height);for(var offsetX=2*x,i=0;i<width;i++)for(var j=0;j<height;j++){var cellX=offsetX+2*i,cellY=y+j;this.cells.set(cellX,cellY,void 0),this.cells.set(cellX+1,cellY,void 0)}}},{key:"render",value:function(){var _this=this;this.cells.data.filter((function(c){return c})).forEach((function(cell){var pixelX=cell.x*_this.tileWidth,pixelY=cell.y*_this.tileHeight;cell.bg&&(_this.ctx.fillStyle=cell.bg,_this.ctx.fillRect(pixelX,pixelY,cell.width,cell.height)),cell.img&&_this.ctx.drawImage(cell.img,pixelX,pixelY)}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Display}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Grid});var _defaultValueGenerator=new WeakMap,Grid=function(){function Grid(width,height){var defaultValueGenerator=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return null};_classCallCheck(this,Grid),_defineProperty(this,"_width",0),_defineProperty(this,"_height",0),_defineProperty(this,"data",[]),_defineProperty(this,"suppressOOBWarn",!1),_defaultValueGenerator.set(this,{writable:!0,value:function(){return null}}),this._width=width,this._height=height,_classPrivateFieldSet(this,_defaultValueGenerator,defaultValueGenerator),this.clear()}return _createClass(Grid,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"size",get:function(){return this._width*this._height}}]),_createClass(Grid,[{key:"idx",value:function(x,y){return y*this._width+x}},{key:"coord",value:function(idx){return{x:Math.trunc(idx%this._width),y:Math.trunc(idx/this._width)}}},{key:"clear",value:function(){this.data=[];for(var i=0;i<this.size;i++){var _this$coord=this.coord(i),x=_this$coord.x,y=_this$coord.y;this.data[i]=_classPrivateFieldGet(this,_defaultValueGenerator).call(this,x,y)}}},{key:"set",value:function(x,y,value){if(this.isOutOfBounds(x,y))this.suppressOOBWarn||console.warn("Trying to set out-of-bounds coordinates (".concat(x,", ").concat(y,") to value ").concat(value));else{var idx=this.idx(x,y);this.data[idx]=value}}},{key:"get",value:function(x,y){return this.isOutOfBounds(x,y)?_classPrivateFieldGet(this,_defaultValueGenerator).call(this):this.data[this.idx(x,y)]}},{key:"isOutOfBounds",value:function(x,y){return x<0||y<0||x>=this._width||y>=this.height}},{key:"getNeighbors",value:function(x,y){return[this.get(x-1,y-1),this.get(x,y-1),this.get(x+1,y-1),this.get(x-1,y),this.get(x+1,y),this.get(x-1,y+1),this.get(x,y+1),this.get(x+1,y+1)]}},{key:"clearAndResize",value:function(width,height){this._width=width,this._height=height,this.clear()}}]),Grid}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _SpriteSheet__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9);const __WEBPACK_DEFAULT_EXPORT__=function(){var tileImage=document.getElementById("spritesheet-tiles"),fontImage=document.getElementById("spritesheet-font");return[new _SpriteSheet__WEBPACK_IMPORTED_MODULE_0__.default("tiles",tileImage),new _SpriteSheet__WEBPACK_IMPORTED_MODULE_0__.default("font",fontImage)]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>SpriteSheet});var _cp437__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),_Sprite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _name=new WeakMap,_defaultGlyph=new WeakMap,_sprites=new WeakMap,SpriteSheet=function(){function SpriteSheet(name,image){var _this=this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SpriteSheet),_name.set(this,{writable:!0,value:null}),_defaultGlyph.set(this,{writable:!0,value:"?"}),_sprites.set(this,{writable:!0,value:{}}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_name,name),this.image=image,this.spriteWidth=this.image.width/this.spriteCountX,this.spriteHeight=this.image.height/this.spriteCountY,_cp437__WEBPACK_IMPORTED_MODULE_0__.default.forEach((function(row,i){row.forEach((function(glyph,j){_classPrivateFieldGet(_this,_sprites)[glyph]=new _Sprite__WEBPACK_IMPORTED_MODULE_1__.default(glyph,_this,j,i)}))}))}return _createClass(SpriteSheet,[{key:"name",get:function(){return _classPrivateFieldGet(this,_name)}},{key:"width",get:function(){return this.image.width}},{key:"height",get:function(){return this.image.height}},{key:"spriteCountX",get:function(){return 16}},{key:"spriteCountY",get:function(){return 16}}]),_createClass(SpriteSheet,[{key:"getSprite",value:function(glyph){return _classPrivateFieldGet(this,_sprites)[glyph]?_classPrivateFieldGet(this,_sprites)[glyph]:_classPrivateFieldGet(this,_sprites)[_classPrivateFieldGet(this,_defaultGlyph)]}}]),SpriteSheet}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=[["NUL","☺","☻","♥","♦","♣","♠","•","◘","○","◙","♂","♀","♪","♫","☼"],["►","◄","↕","‼","¶","§","▬","↨","↑","↓","→","←","∟","↔","▲","▼"],[" ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/"],["0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?"],["@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O"],["P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_"],["`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o"],["p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","⌂"],["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å"],["É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","¢","£","¥","₧","ƒ"],["á","í","ó","ú","ñ","Ñ","ª","º","¿","⌐","¬","½","¼","¡","«","»"],["░","▒","▓","│","┤","╡","╢","╖","╕","╣","║","╗","╝","╜","╛","┐"],["└","┴","┬","├","─","┼","╞","╟","╚","╔","╩","╦","╠","═","╬","╧"],["╨","╤","╥","╙","╘","╒","╓","╫","╪","┘","┌","█","▄","▌","▐","▀"],["α","ß","Γ","π","Σ","σ","µ","τ","Φ","Θ","Ω","δ","∞","φ","ε","∩"],["≡","±","≥","≤","⌠","⌡","÷","≈","°","∙","·","√","ⁿ","²","■","NBSP"]]},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Sprite});var _utils_ColorParser__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(12);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var isBlack=function(r,g,b){return 0===r&&0===g&&0===b},_ctx=new WeakMap,_glyph=new WeakMap,_sheet=new WeakMap,_x=new WeakMap,_y=new WeakMap,Sprite=function(){function Sprite(glyph,sheet,x,y){var obj,key,value;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Sprite),_ctx.set(this,{writable:!0,value:null}),_glyph.set(this,{writable:!0,value:null}),_sheet.set(this,{writable:!0,value:null}),_x.set(this,{writable:!0,value:null}),_y.set(this,{writable:!0,value:null}),value={},(key="_cache")in(obj=this)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,_classPrivateFieldSet(this,_glyph,glyph),_classPrivateFieldSet(this,_sheet,sheet),_classPrivateFieldSet(this,_x,x),_classPrivateFieldSet(this,_y,y);var canvas=document.createElement("canvas");canvas.width=this.width,canvas.height=this.height,_classPrivateFieldSet(this,_ctx,canvas.getContext("2d")),_classPrivateFieldGet(this,_ctx).drawImage(this.sheet.image,this.sourceX,this.sourceY,this.width,this.height,0,0,this.width,this.height)}return _createClass(Sprite,[{key:"glyph",get:function(){return _classPrivateFieldGet(this,_glyph)}},{key:"x",get:function(){return _classPrivateFieldGet(this,_x)}},{key:"y",get:function(){return _classPrivateFieldGet(this,_y)}},{key:"sheet",get:function(){return _classPrivateFieldGet(this,_sheet)}},{key:"image",get:function(){return this.sheet.image}},{key:"sourceX",get:function(){return this.sheet.spriteWidth*this.x}},{key:"sourceY",get:function(){return this.sheet.spriteHeight*this.y}},{key:"width",get:function(){return this.sheet.spriteWidth}},{key:"height",get:function(){return this.sheet.spriteHeight}}]),_createClass(Sprite,[{key:"colorize",value:function(primaryCss,secondaryCss){var primary=(0,_utils_ColorParser__WEBPACK_IMPORTED_MODULE_0__.parseColor)(primaryCss),secondary=(0,_utils_ColorParser__WEBPACK_IMPORTED_MODULE_0__.parseColor)(secondaryCss),key="".concat(primary.key,"-").concat(secondary.key);if(this._cache.hasOwnProperty(key))return this._cache[key];for(var pixels=_classPrivateFieldGet(this,_ctx).getImageData(0,0,this.width,this.height),i=0;i<pixels.data.length;i+=4){var r=pixels.data[i],g=pixels.data[i+1],b=pixels.data[i+2];isBlack(r,g,b)?(pixels.data[i]=primary[0],pixels.data[i+1]=primary[1],pixels.data[i+2]=primary[2],pixels.data[i+4]=primary[3]):(pixels.data[i]=secondary[0],pixels.data[i+1]=secondary[1],pixels.data[i+2]=secondary[2],pixels.data[i+4]=secondary[3])}var cvs=document.createElement("canvas");return cvs.width=this.width,cvs.height=this.height,cvs.getContext("2d").putImageData(pixels,0,0),this._cache[key]=cvs,cvs}}]),Sprite}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{parseColor:()=>parseColor});var color_parse__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(13),cache={},parseColor=function(colorStr){if(!cache.hasOwnProperty(colorStr)){var parsed=(0,color_parse__WEBPACK_IMPORTED_MODULE_0__.default)(colorStr).values,data=[parsed[0],parsed[1],parsed[2],parsed.alpha];data.key="".concat(data[0],",").concat(data[1],",").concat(data[2],",").concat(data[3]),cache[colorStr]=data}return cache[colorStr]}},(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var color_name__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);const __WEBPACK_DEFAULT_EXPORT__=function(cstr){var m,space,parts=[],alpha=1;if("string"==typeof cstr)if(color_name__WEBPACK_IMPORTED_MODULE_0__[cstr])parts=color_name__WEBPACK_IMPORTED_MODULE_0__[cstr].slice(),space="rgb";else if("transparent"===cstr)alpha=0,space="rgb",parts=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(cstr)){var size=(base=cstr.slice(1)).length;alpha=1,size<=4?(parts=[parseInt(base[0]+base[0],16),parseInt(base[1]+base[1],16),parseInt(base[2]+base[2],16)],4===size&&(alpha=parseInt(base[3]+base[3],16)/255)):(parts=[parseInt(base[0]+base[1],16),parseInt(base[2]+base[3],16),parseInt(base[4]+base[5],16)],8===size&&(alpha=parseInt(base[6]+base[7],16)/255)),parts[0]||(parts[0]=0),parts[1]||(parts[1]=0),parts[2]||(parts[2]=0),space="rgb"}else if(m=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(cstr)){var name=m[1],isRGB="rgb"===name,base=name.replace(/a$/,"");space=base;size="cmyk"===base?4:"gray"===base?1:3;parts=m[2].trim().split(/\s*[,\/]\s*|\s+/).map((function(x,i){if(/%$/.test(x))return i===size?parseFloat(x)/100:"rgb"===base?255*parseFloat(x)/100:parseFloat(x);if("h"===base[i]){if(/deg$/.test(x))return parseFloat(x);if(void 0!==baseHues[x])return baseHues[x]}return parseFloat(x)})),name===base&&parts.push(1),alpha=isRGB||void 0===parts[size]?1:parts[size],parts=parts.slice(0,size)}else cstr.length>10&&/[0-9](?:\s|\/)/.test(cstr)&&(parts=cstr.match(/([0-9]+)/g).map((function(value){return parseFloat(value)})),space=cstr.match(/([a-z])/gi).join("").toLowerCase());else isNaN(cstr)?Array.isArray(cstr)||cstr.length?(parts=[cstr[0],cstr[1],cstr[2]],space="rgb",alpha=4===cstr.length?cstr[3]:1):cstr instanceof Object&&(null!=cstr.r||null!=cstr.red||null!=cstr.R?(space="rgb",parts=[cstr.r||cstr.red||cstr.R||0,cstr.g||cstr.green||cstr.G||0,cstr.b||cstr.blue||cstr.B||0]):(space="hsl",parts=[cstr.h||cstr.hue||cstr.H||0,cstr.s||cstr.saturation||cstr.S||0,cstr.l||cstr.lightness||cstr.L||cstr.b||cstr.brightness]),alpha=cstr.a||cstr.alpha||cstr.opacity||1,null!=cstr.opacity&&(alpha/=100)):(space="rgb",parts=[cstr>>>16,(65280&cstr)>>>8,255&cstr]);return{space,values:parts,alpha}};var baseHues={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}},module=>{"use strict";module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>InputController});var _events_InputKeyboardEvent__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(16),_events_InputMouseEvent__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(18);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var InputController=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(InputController,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(InputController);function InputController(game){var _this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,InputController),_this=_super.call(this,game),document.addEventListener("keydown",_this.onKeydown.bind(_assertThisInitialized(_this)));var container=_this.game.renderer.canvas;return container.addEventListener("click",_this.onMouseClick.bind(_assertThisInitialized(_this))),container.addEventListener("mousemove",_this.onMouseMove.bind(_assertThisInitialized(_this))),container.addEventListener("mouseenter",_this.onMouseEnter.bind(_assertThisInitialized(_this))),container.addEventListener("mouseleave",_this.onMouseLeave.bind(_assertThisInitialized(_this))),_this}return Constructor=InputController,(protoProps=[{key:"onKeydown",value:function(e){var evt=new _events_InputKeyboardEvent__WEBPACK_IMPORTED_MODULE_0__.default({key:e.keyCode,shift:e.shiftKey,ctrl:e.ctrlKey,alt:e.altKey,meta:e.metaKey});e.preventDefault(),this.game.commands.onInputEvent(evt)}},{key:"onMouseClick",value:function(e){var xPx=e.offsetX,yPx=e.offsetY,_this$game$renderer$p=this.game.renderer.pxToTile(xPx,yPx),x=_this$game$renderer$p.x,y=_this$game$renderer$p.y,evt=new _events_InputMouseEvent__WEBPACK_IMPORTED_MODULE_1__.default({key:e.button,x,y,shift:e.shiftKey,ctrl:e.ctrlKey,alt:e.altKey,meta:e.metaKey,xPx,yPx});this.game.commands.onInputEvent(evt)}},{key:"onMouseMove",value:function(e){var xPx=e.offsetX,yPx=e.offsetY,_this$game$renderer$p2=this.game.renderer.pxToTile(xPx,yPx),x=_this$game$renderer$p2.x,y=_this$game$renderer$p2.y;this.game.mouse.updatePosition(x,y)}},{key:"onMouseEnter",value:function(e){this.game.mouse.updateMouseEnter()}},{key:"onMouseLeave",value:function(e){this.game.mouse.updateMouseLeave()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),InputController}(__webpack_require__(5).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>InputKeyboardEvent});var InputKeyboardEvent=function(_InputEvent){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(InputKeyboardEvent,_InputEvent);var _super=_createSuper(InputKeyboardEvent);function InputKeyboardEvent(){return _classCallCheck(this,InputKeyboardEvent),_super.apply(this,arguments)}return InputKeyboardEvent}(__webpack_require__(17).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>InputEvent});var InputEvent=function InputEvent(data){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,InputEvent),_defineProperty(this,"key",!1),_defineProperty(this,"shift",!1),_defineProperty(this,"ctrl",!1),_defineProperty(this,"alt",!1),_defineProperty(this,"meta",!1),this.key=data.key,this.shift=data.shift,this.ctrl=data.ctrl,this.alt=data.alt,this.meta=data.meta}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>InputMouseEvent});var InputMouseEvent=function(_InputEvent){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(InputMouseEvent,_InputEvent);var _super=_createSuper(InputMouseEvent);function InputMouseEvent(data){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,InputMouseEvent),_defineProperty(_assertThisInitialized(_this=_super.call(this,data)),"x",!1),_defineProperty(_assertThisInitialized(_this),"y",!1),_defineProperty(_assertThisInitialized(_this),"tileX",!1),_defineProperty(_assertThisInitialized(_this),"tileY",!1),_this.x=data.x,_this.y=data.y,_this.tileX=data.tileX,_this.tileY=data.tileY,_this}return InputMouseEvent}(__webpack_require__(17).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ActionSystem});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_System__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var _query=new WeakMap,ActionSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ActionSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(ActionSystem);function ActionSystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ActionSystem),_this=_super.call(this,game),_query.set(_assertThisInitialized(_this),{writable:!0,value:null}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_query,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Actor],none:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsDestroying,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsDead]})),_this}return Constructor=ActionSystem,(protoProps=[{key:"update",value:function(dt){var _this2=this,entities=function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}(this,_query).get(),sorted=Array.from(entities);sorted.sort((function(a,b){return a.actor.energy<b.actor.energy?1:-1}));var entity=sorted[0];for(entity&&!entity.actor.hasEnergy&&(this.game.clock.incrementTick(-1*entity.actor.energy),entities.forEach((function(entity){entity.actor.addEnergy(_this2.game.clock.tickDelta)})));entity&&entity.actor.hasEnergy&&!entity.isPlayer;)entity.fireEvent("take-action"),entity=sorted.shift()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ActionSystem}(_System__WEBPACK_IMPORTED_MODULE_1__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Actor:()=>_Actor__WEBPACK_IMPORTED_MODULE_0__.Actor,IsDestroying:()=>_IsDestroying__WEBPACK_IMPORTED_MODULE_1__.IsDestroying,LiquidContainer:()=>_LiquidContainer__WEBPACK_IMPORTED_MODULE_2__.LiquidContainer,Door:()=>_Door__WEBPACK_IMPORTED_MODULE_3__.Door,Armor:()=>_Armor__WEBPACK_IMPORTED_MODULE_4__.Armor,Loot:()=>_Loot__WEBPACK_IMPORTED_MODULE_5__.Loot,Throwable:()=>_Throwable__WEBPACK_IMPORTED_MODULE_6__.Throwable,FragileGlass:()=>_FragileGlass__WEBPACK_IMPORTED_MODULE_7__.FragileGlass,Stackable:()=>_Stackable__WEBPACK_IMPORTED_MODULE_8__.Stackable,Inventory:()=>_Inventory__WEBPACK_IMPORTED_MODULE_9__.Inventory,IsInventoried:()=>_IsInventoried__WEBPACK_IMPORTED_MODULE_10__.IsInventoried,Brain:()=>_Brain__WEBPACK_IMPORTED_MODULE_11__.Brain,Body:()=>_Body__WEBPACK_IMPORTED_MODULE_12__.Body,Goal:()=>_Goal__WEBPACK_IMPORTED_MODULE_13__.Goal,Moniker:()=>_Moniker__WEBPACK_IMPORTED_MODULE_14__.Moniker,Logger:()=>_Logger__WEBPACK_IMPORTED_MODULE_15__.Logger,Position:()=>_Position__WEBPACK_IMPORTED_MODULE_16__.Position,Glyph:()=>_Glyph__WEBPACK_IMPORTED_MODULE_17__.Glyph,Legs:()=>_Legs__WEBPACK_IMPORTED_MODULE_18__.Legs,MoveCommand:()=>_MoveCommand__WEBPACK_IMPORTED_MODULE_19__.MoveCommand,MeleeCommand:()=>_MeleeCommand__WEBPACK_IMPORTED_MODULE_20__.MeleeCommand,IsPlayer:()=>_IsPlayer__WEBPACK_IMPORTED_MODULE_21__.IsPlayer,Wandering:()=>_Wandering__WEBPACK_IMPORTED_MODULE_22__.Wandering,Blocker:()=>_Blocker__WEBPACK_IMPORTED_MODULE_23__.Blocker,Shadowcaster:()=>_Shadowcaster__WEBPACK_IMPORTED_MODULE_24__.Shadowcaster,IsVisible:()=>_IsVisible__WEBPACK_IMPORTED_MODULE_25__.IsVisible,Explorable:()=>_Explorable__WEBPACK_IMPORTED_MODULE_26__.Explorable,Explored:()=>_Explored__WEBPACK_IMPORTED_MODULE_27__.Explored,Health:()=>_Health__WEBPACK_IMPORTED_MODULE_28__.Health,IsDead:()=>_IsDead__WEBPACK_IMPORTED_MODULE_29__.IsDead,FactionMember:()=>_FactionMember__WEBPACK_IMPORTED_MODULE_30__.FactionMember,Eyes:()=>_Eyes__WEBPACK_IMPORTED_MODULE_31__.Eyes,Particle:()=>_Particle__WEBPACK_IMPORTED_MODULE_32__.Particle,ParticleEmitter:()=>_ParticleEmitter__WEBPACK_IMPORTED_MODULE_33__.ParticleEmitter,LootDropper:()=>_LootDropper__WEBPACK_IMPORTED_MODULE_34__.LootDropper,IsEquipped:()=>_IsEquipped__WEBPACK_IMPORTED_MODULE_35__.IsEquipped,Equipment:()=>_Equipment__WEBPACK_IMPORTED_MODULE_36__.Equipment,EquipmentSlot:()=>_EquipmentSlot__WEBPACK_IMPORTED_MODULE_37__.EquipmentSlot,Stats:()=>_Stats__WEBPACK_IMPORTED_MODULE_38__.Stats,Race:()=>_Race__WEBPACK_IMPORTED_MODULE_39__.Race,Weapon:()=>_Weapon__WEBPACK_IMPORTED_MODULE_40__.Weapon});var _Actor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21),_IsDestroying__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(23),_LiquidContainer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24),_Door__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(47),_Armor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(50),_Loot__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(51),_Throwable__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(57),_FragileGlass__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(71),_Stackable__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(55),_Inventory__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(52),_IsInventoried__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(54),_Brain__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(74),_Body__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(69),_Goal__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(75),_Moniker__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(77),_Logger__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(78),_Position__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(79),_Glyph__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(80),_Legs__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(81),_MoveCommand__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(82),_MeleeCommand__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(84),_IsPlayer__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(85),_Wandering__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(86),_Blocker__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(48),_Shadowcaster__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(49),_IsVisible__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(70),_Explorable__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(87),_Explored__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(88),_Health__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(89),_IsDead__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(90),_FactionMember__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(91),_Eyes__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(94),_Particle__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(95),_ParticleEmitter__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(96),_LootDropper__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(97),_IsEquipped__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(102),_Equipment__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(103),_EquipmentSlot__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(105),_Stats__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(106),_Race__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(108),_Weapon__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(111)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Actor:()=>Actor});var obj,key,value,Actor=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Actor,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Actor);function Actor(){return _classCallCheck(this,Actor),_super.apply(this,arguments)}return Constructor=Actor,(protoProps=[{key:"onEnergyConsumed",value:function(evt){this.reduceEnergy(evt.data)}},{key:"onTick",value:function(evt){this.addEnergy(1)}},{key:"addEnergy",value:function(value){this.energy+=value,this.energy>=0&&(this.energy=0)}},{key:"reduceEnergy",value:function(value){this.addEnergy(-1*value)}},{key:"hasEnergy",get:function(){return this.energy>=0}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Actor}(__webpack_require__(22).Component);value={energy:0},(key="properties")in(obj=Actor)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e3){didErr=!0,err=_e3},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty2(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty2(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Component:()=>Component,Engine:()=>Engine,Prefab:()=>Prefab});var camelCase=function(input,options){if("string"!=typeof input&&!Array.isArray(input))throw new TypeError("Expected the input to be `string | string[]`");options=_objectSpread(_objectSpread({},{pascalCase:!1}),options);var x;return 0===(input=Array.isArray(input)?input.map((function(x){return x.trim()})).filter((function(x){return x.length})).join("-"):input.trim()).length?"":1===input.length?options.pascalCase?input.toLocaleUpperCase():input.toLocaleLowerCase():(input!==input.toLocaleLowerCase()&&(input=function(string){for(var isLastCharLower=!1,isLastCharUpper=!1,isLastLastCharUpper=!1,i=0;i<string.length;i++){var character=string[i];isLastCharLower&&/(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C2\uA7C4-\uA7C7\uA7C9\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])/.test(character)?(string=string.slice(0,i)+"-"+string.slice(i),isLastCharLower=!1,isLastLastCharUpper=isLastCharUpper,isLastCharUpper=!0,i++):isLastCharUpper&&isLastLastCharUpper&&/(?:[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0560-\u0588\u10D0-\u10FA\u10FD-\u10FF\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7AF\uA7B5\uA7B7\uA7B9\uA7BB\uA7BD\uA7BF\uA7C3\uA7C8\uA7CA\uA7F6\uA7FA\uAB30-\uAB5A\uAB60-\uAB68\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD81B[\uDE60-\uDE7F]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD83A[\uDD22-\uDD43])/.test(character)?(string=string.slice(0,i-1)+"-"+string.slice(i-1),isLastLastCharUpper=isLastCharUpper,isLastCharUpper=!1,isLastCharLower=!0):(isLastCharLower=character.toLocaleLowerCase()===character&&character.toLocaleUpperCase()!==character,isLastLastCharUpper=isLastCharUpper,isLastCharUpper=character.toLocaleUpperCase()===character&&character.toLocaleLowerCase()!==character)}return string}(input)),input=input.replace(/^[_.\- ]+/,"").toLocaleLowerCase().replace(/[ \x2D\._]+((?:[0-9A-Z_a-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0345\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05B0-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0657\u0659-\u0669\u066E-\u06D3\u06D5-\u06DC\u06E1-\u06E8\u06ED-\u06FC\u06FF\u0710-\u073F\u074D-\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0817\u081A-\u082C\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u08D4-\u08DF\u08E3-\u08E9\u08F0-\u093B\u093D-\u094C\u094E-\u0950\u0955-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C4\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A42\u0A47\u0A48\u0A4B\u0A4C\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC5\u0AC7-\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFC\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D-\u0B44\u0B47\u0B48\u0B4B\u0B4C\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4C\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCC\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D54-\u0D63\u0D66-\u0D78\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E46\u0E4D\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F71-\u0F81\u0F88-\u0F97\u0F99-\u0FBC\u1000-\u1036\u1038\u103B-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1713\u1720-\u1733\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17B3\u17B6-\u17C8\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A61-\u1A74\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1ABF\u1AC0\u1B00-\u1B33\u1B35-\u1B43\u1B45-\u1B4B\u1B50-\u1B59\u1B80-\u1BA9\u1BAC-\u1BE5\u1BE7-\u1BF1\u1C00-\u1C36\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1DE7-\u1DF4\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2189\u2150-\u2182\u2460-\u249B\u24B6-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA674-\uA67B\uA67F-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA805\uA807-\uA827\uA830-\uA835\uA840-\uA873\uA880-\uA8C3\uA8C5\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD-\uA92A\uA930-\uA952\uA960-\uA97C\uA980-\uA9B2\uA9B4-\uA9BF\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAABE\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD27\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC45\uDC52-\uDC6F\uDC82-\uDCB8\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD32\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD72\uDD76\uDD80-\uDDBF\uDDC1-\uDDC4\uDDCE-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE34\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEE8\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D-\uDF44\uDF47\uDF48\uDF4B\uDF4C\uDF50\uDF57\uDF5D-\uDF63]|\uD805[\uDC00-\uDC41\uDC43-\uDC45\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCC1\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDBE\uDDD8-\uDDDD\uDE00-\uDE3E\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB5\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC38\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B\uDD3C\uDD3F-\uDD42\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDDF\uDDE1\uDDE3\uDDE4\uDE00-\uDE32\uDE35-\uDE3E\uDE50-\uDE97\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC3E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD41\uDD43\uDD46\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD96\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9E]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD47\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C\uDD30-\uDD49\uDD50-\uDD69\uDD70-\uDD89]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])|$)/g,(function(_,p1){return p1.toLocaleUpperCase()})).replace(/[0-9]+((?:[0-9A-Z_a-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0345\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05B0-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0657\u0659-\u0669\u066E-\u06D3\u06D5-\u06DC\u06E1-\u06E8\u06ED-\u06FC\u06FF\u0710-\u073F\u074D-\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0817\u081A-\u082C\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u08D4-\u08DF\u08E3-\u08E9\u08F0-\u093B\u093D-\u094C\u094E-\u0950\u0955-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C4\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A42\u0A47\u0A48\u0A4B\u0A4C\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC5\u0AC7-\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFC\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D-\u0B44\u0B47\u0B48\u0B4B\u0B4C\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4C\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCC\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D54-\u0D63\u0D66-\u0D78\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E46\u0E4D\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F71-\u0F81\u0F88-\u0F97\u0F99-\u0FBC\u1000-\u1036\u1038\u103B-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1713\u1720-\u1733\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17B3\u17B6-\u17C8\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A61-\u1A74\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1ABF\u1AC0\u1B00-\u1B33\u1B35-\u1B43\u1B45-\u1B4B\u1B50-\u1B59\u1B80-\u1BA9\u1BAC-\u1BE5\u1BE7-\u1BF1\u1C00-\u1C36\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1DE7-\u1DF4\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2189\u2150-\u2182\u2460-\u249B\u24B6-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA674-\uA67B\uA67F-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA805\uA807-\uA827\uA830-\uA835\uA840-\uA873\uA880-\uA8C3\uA8C5\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD-\uA92A\uA930-\uA952\uA960-\uA97C\uA980-\uA9B2\uA9B4-\uA9BF\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAABE\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD27\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC45\uDC52-\uDC6F\uDC82-\uDCB8\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD32\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD72\uDD76\uDD80-\uDDBF\uDDC1-\uDDC4\uDDCE-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE34\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEE8\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D-\uDF44\uDF47\uDF48\uDF4B\uDF4C\uDF50\uDF57\uDF5D-\uDF63]|\uD805[\uDC00-\uDC41\uDC43-\uDC45\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCC1\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDBE\uDDD8-\uDDDD\uDE00-\uDE3E\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB5\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC38\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B\uDD3C\uDD3F-\uDD42\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDDF\uDDE1\uDDE3\uDDE4\uDE00-\uDE32\uDE35-\uDE3E\uDE50-\uDE97\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC3E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD41\uDD43\uDD46\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD96\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9E]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD47\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C\uDD30-\uDD49\uDD50-\uDD69\uDD70-\uDD89]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])|$)/g,(function(m){return m.toLocaleUpperCase()})),x=input,options.pascalCase?x.charAt(0).toLocaleUpperCase()+x.slice(1):x)},camelcase=camelCase,_default=camelCase;camelcase.default=_default;var camelCache=new Map,camelString=function(value){return camelCache.has(value)||camelCache.set(value,camelcase(value)),camelCache.get(value)},pascalCache=new Map,Property=function(){function Property(component){_classCallCheck(this,Property),_defineProperty(this,"component",void 0),this.component=component}return _createClass(Property,[{key:"get",value:function(){}},{key:"set",value:function(value){}},{key:"serialize",value:function(){}},{key:"onDestroyed",value:function(){}},{key:"cleanupReference",value:function(entity){}},{key:"ecs",get:function(){return this.component.ecs}},{key:"descriptor",get:function(){var _this=this;return{enumerable:!0,get:function(){return _this.get()},set:function(v){return _this.set(v)}}}}]),Property}(),SimpleProperty=function(_Property){_inherits(SimpleProperty,_Property);var _super=_createSuper(SimpleProperty);function SimpleProperty(){var _this2;_classCallCheck(this,SimpleProperty);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _defineProperty(_assertThisInitialized(_this2=_super.call.apply(_super,[this].concat(args))),"value",null),_this2}return _createClass(SimpleProperty,[{key:"set",value:function(value){this.value=value}},{key:"get",value:function(){return this.value}},{key:"serialize",value:function(){return this.value}}]),SimpleProperty}(Property),EntityProperty=function(_Property2){_inherits(EntityProperty,_Property2);var _super2=_createSuper(EntityProperty);function EntityProperty(){var _this3;_classCallCheck(this,EntityProperty);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return _defineProperty(_assertThisInitialized(_this3=_super2.call.apply(_super2,[this].concat(args))),"id",void 0),_this3}return _createClass(EntityProperty,[{key:"set",value:function(value){return!this.id||value&&value.id===this.id&&value===this.id||this.ecs.entities.removeRef(this.id,this),value&&value.id?(this.ecs.entities.addRef(value.id,this),void(this.id=value.id)):"string"==typeof value?(this.ecs.entities.addRef(value,this),void(this.id=value)):void(this.id=void 0)}},{key:"get",value:function(){return this.id&&this.component.ecs.getEntity(this.id)}},{key:"serialize",value:function(){return this.id}},{key:"onDestroyed",value:function(){this.id&&this.ecs.entities.removeRef(this.id,this)}},{key:"cleanupReference",value:function(entity){this.id===entity.id?this.id=void 0:console.warn('Property in unclean state. A reference to an entity "'.concat(entity.id,'" was never cleaned up.'),entity)}}]),EntityProperty}(Property),EntityArrayProperty=function(_Property3){_inherits(EntityArrayProperty,_Property3);var _super3=_createSuper(EntityArrayProperty);function EntityArrayProperty(component){var _this4;return _classCallCheck(this,EntityArrayProperty),_defineProperty(_assertThisInitialized(_this4=_super3.call(this,component)),"proxy",[]),_this4.proxy=new Proxy([],{get:function(target,prop,receiver){return Reflect.get(target,prop,receiver)},set:function(target,prop,value,receiver){if(isNaN(prop))return Reflect.set(target,prop,value,receiver);var old=Reflect.get(target,prop,receiver);return"string"==typeof value&&(value=_this4.ecs.entities.get(value)),old&&old!=value&&_this4.ecs.entities.removeRef(value,_assertThisInitialized(_this4)),value&&value.id?(_this4.ecs.entities.addRef(value.id,_assertThisInitialized(_this4)),Reflect.set(target,prop,value,receiver)):Reflect.set(target,prop,value,receiver)},deleteProperty:function(target,prop){if(isNaN(prop))return Reflect.deleteProperty(target,prop);var value=Reflect.get(target,prop);return _this4.ecs.entities.removeRef(value,_assertThisInitialized(_this4)),Reflect.deleteProperty(target,prop)}}),_this4}return _createClass(EntityArrayProperty,[{key:"set",value:function(){for(var values=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],len=Math.max(values.length,this.proxy.length),i=0;i<len;i++)i in values?this.proxy[i]=values[i]:delete this.proxy[i];this.proxy.length=values.length}},{key:"get",value:function(){return this.proxy}},{key:"serialize",value:function(){return this.proxy.map((function(ref){return ref.id}))}},{key:"onDestroyed",value:function(){this.set([])}},{key:"cleanupReference",value:function(entity){this.set(this.proxy.filter((function(ref){return ref.id!==entity.id})))}}]),EntityArrayProperty}(Property),PropertyStrategy=function(){function PropertyStrategy(){_classCallCheck(this,PropertyStrategy)}return _createClass(PropertyStrategy,null,[{key:"create",value:function(component,value){switch(value){case"<Entity>":return new EntityProperty(component);case"<EntityArray>":return new EntityArrayProperty(component);default:return new SimpleProperty(component)}}}]),PropertyStrategy}(),Component=function(){function Component(ecs){var properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,Component),_defineProperty(this,"entity",null),_defineProperty(this,"ecs",null),_defineProperty(this,"_props",{}),_defineProperty(this,"_isDestroyed",!1),this.ecs=ecs,this._defineProxies(properties)}return _createClass(Component,[{key:"type",get:function(){return this.constructor.name}},{key:"isAttached",get:function(){return Boolean(this.entity)}},{key:"isDestroyed",get:function(){return this._isDestroyed}},{key:"allowMultiple",get:function(){return this.constructor.allowMultiple}},{key:"keyProperty",get:function(){return this.constructor.keyProperty}},{key:"properties",get:function(){for(var ob={},_i=0,_Object$entries=Object.entries(this._props);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];ob[key]=value.get()}return ob}},{key:"key",get:function(){return this[this.keyProperty]}}],[{key:"type",get:function(){return this.name}}]),_createClass(Component,[{key:"serialize",value:function(){return Object.entries(this._props).reduce((function(o,_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];return _objectSpread(_objectSpread({},o),{},_defineProperty2({},key,value.serialize()))}),{})}},{key:"_onAttached",value:function(entity){this.entity=entity,this.ecs.queries.onComponentAdded(entity,this),this.onAttached()}},{key:"_onDetached",value:function(){if(this.isAttached){this.onDetached();var entity=this.entity;this.entity=null,this.ecs.queries.onComponentRemoved(entity,this)}}},{key:"_onDestroyed",value:function(){this._isDestroyed=!0,this.onDestroyed();for(var _i2=0,_Object$values=Object.values(this._props);_i2<_Object$values.length;_i2++){_Object$values[_i2].onDestroyed()}}},{key:"onAttached",value:function(){}},{key:"onDetached",value:function(){}},{key:"onDestroyed",value:function(){}},{key:"remove",value:function(){var destroy=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isAttached&&this.entity.remove(this),destroy&&this._onDestroyed()}},{key:"destroy",value:function(){this.remove(!0)}},{key:"clone",value:function(){return this.ecs.createComponent(this.type,this.serialize())}},{key:"_onEvent",value:function(evt){this.onEvent(evt);var handlerName=camelString("on ".concat(evt.name));"function"==typeof this[handlerName]&&this[handlerName](evt)}},{key:"onEvent",value:function(evt){}},{key:"_defaultPropertyValue",value:function(propertyName){var value=this.constructor.properties[propertyName];return"<EntityArray>"===value?[]:"<Entity>"!==value?value:void 0}},{key:"_defineProxies",value:function(initialProperties){for(var key in this.constructor.properties){var initialValue=initialProperties.hasOwnProperty(key)?initialProperties[key]:this._defaultPropertyValue(key),property=PropertyStrategy.create(this,this.constructor.properties[key]);this._props[key]=property,Object.defineProperty(this,key,property.descriptor),property.set(initialValue)}}}]),Component}();_defineProperty(Component,"allowMultiple",!1),_defineProperty(Component,"keyProperty",null),_defineProperty(Component,"properties",{});var ComponentRegistry=function(){function ComponentRegistry(ecs){_classCallCheck(this,ComponentRegistry),_defineProperty(this,"_definitions",new Map),_defineProperty(this,"_ecs",null),this._ecs=ecs}return _createClass(ComponentRegistry,[{key:"register",value:function(component){this._definitions.set(component.name,component),camelString(component.name)}},{key:"getAccessor",value:function(type){return camelString(type)}},{key:"get",value:function(typeOrClassOrComponent){var type=this._getType(typeOrClassOrComponent);return type?this._definitions.get(type):(console.warn("Cannot get component definition for type or class ".concat(typeOrClassOrComponent," since it is neither a Component class or type (string)")),null)}},{key:"create",value:function(typeOrClass){var properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},definition=this.get(typeOrClass);if(definition)return new definition(this._ecs,properties);console.warn("Could not create component definition for ".concat(typeOrClass," since it is not registered"))}},{key:"_getType",value:function(typeOrClassOrComponent){return"string"==typeof typeOrClassOrComponent?typeOrClassOrComponent:typeOrClassOrComponent instanceof Component?typeOrClassOrComponent.type:typeOrClassOrComponent.prototype instanceof Component?typeOrClassOrComponent.name:null}}]),ComponentRegistry}(),isMergeableObject=function(value){return function(value){return!!value&&"object"===_typeof(value)}(value)&&!function(value){var stringValue=Object.prototype.toString.call(value);return"[object RegExp]"===stringValue||"[object Date]"===stringValue||function(value){return value.$$typeof===REACT_ELEMENT_TYPE}(value)}(value)};var REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function cloneUnlessOtherwiseSpecified(value,options){return!1!==options.clone&&options.isMergeableObject(value)?deepmerge((val=value,Array.isArray(val)?[]:{}),value,options):value;var val}function defaultArrayMerge(target,source,options){return target.concat(source).map((function(element){return cloneUnlessOtherwiseSpecified(element,options)}))}function getKeys(target){return Object.keys(target).concat(function(target){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(target).filter((function(symbol){return target.propertyIsEnumerable(symbol)})):[]}(target))}function propertyIsOnObject(object,property){try{return property in object}catch(_){return!1}}function mergeObject(target,source,options){var destination={};return options.isMergeableObject(target)&&getKeys(target).forEach((function(key){destination[key]=cloneUnlessOtherwiseSpecified(target[key],options)})),getKeys(source).forEach((function(key){(function(target,key){return propertyIsOnObject(target,key)&&!(Object.hasOwnProperty.call(target,key)&&Object.propertyIsEnumerable.call(target,key))})(target,key)||(propertyIsOnObject(target,key)&&options.isMergeableObject(source[key])?destination[key]=function(key,options){if(!options.customMerge)return deepmerge;var customMerge=options.customMerge(key);return"function"==typeof customMerge?customMerge:deepmerge}(key,options)(target[key],source[key],options):destination[key]=cloneUnlessOtherwiseSpecified(source[key],options))})),destination}function deepmerge(target,source,options){(options=options||{}).arrayMerge=options.arrayMerge||defaultArrayMerge,options.isMergeableObject=options.isMergeableObject||isMergeableObject,options.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var sourceIsArray=Array.isArray(source);return sourceIsArray===Array.isArray(target)?sourceIsArray?options.arrayMerge(target,source,options):mergeObject(target,source,options):cloneUnlessOtherwiseSpecified(source,options)}deepmerge.all=function(array,options){if(!Array.isArray(array))throw new Error("first argument should be an array");return array.reduce((function(prev,next){return deepmerge(prev,next,options)}),{})};var cjs=deepmerge,PrefabComponent=function(){function PrefabComponent(componentDef){var properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},overwrite=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_classCallCheck(this,PrefabComponent),this.componentDef=componentDef,this.properties=properties,this.overwrite=overwrite}return _createClass(PrefabComponent,[{key:"type",get:function(){return this.componentDef.type}}]),_createClass(PrefabComponent,[{key:"applyToEntity",value:function(entity){var initialProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.componentDef.allowMultiple&&entity.has(this.componentDef)){if(!this.overwrite)return void console.log('Ignoring prefab component "'.concat(this.type,'" since the entity "').concat(entity.id,'" already has one.'));entity.remove(this.componentDef)}var props=cjs(this.properties,initialProps);entity.add(this.componentDef,props)}}]),PrefabComponent}(),Prefab=function(){function Prefab(ecs,name){_classCallCheck(this,Prefab),_defineProperty(this,"name",""),_defineProperty(this,"inherit",[]),_defineProperty(this,"components",[]),this.ecs=ecs,this.name=name}return _createClass(Prefab,[{key:"addComponent",value:function(prefabComponent){this.components.push(prefabComponent)}},{key:"applyToEntity",value:function(entity){var _this5=this,initialProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.inherit.forEach((function(parent){parent.applyToEntity(entity,initialProps)}));var arrComps={};return this.components.forEach((function(component,i){var definition=component.componentDef,accessor=_this5.ecs.components.getAccessor(definition.type),initialCompProps={};if(definition.allowMultiple)if(definition.keyProperty){var key=component.properties[definition.keyProperty];initialProps[accessor]&&initialProps[accessor][key]&&(initialCompProps=initialProps[accessor][key])}else arrComps[accessor]||(arrComps[accessor]=0),initialProps[accessor]&&initialProps[accessor][arrComps[accessor]]&&(initialCompProps=initialProps[accessor][arrComps[accessor]]),arrComps[accessor]++;else initialCompProps=initialProps[accessor];component.applyToEntity(entity,initialCompProps)})),entity}}]),Prefab}(),PrefabRegistry=function(){function PrefabRegistry(ecs){_classCallCheck(this,PrefabRegistry),_defineProperty(this,"_prefabs",{}),_defineProperty(this,"_ecs",null),this._ecs=ecs}return _createClass(PrefabRegistry,[{key:"deserialize",value:function(data){var _this6=this,registered=this.get(data.name);if(registered)return registered;var inherit,prefab=new Prefab(this._ecs,data.name);inherit=Array.isArray(data.inherit)?data.inherit:"string"==typeof data.inherit?[data.inherit]:[],prefab.inherit=inherit.map((function(parent){var ref=_this6.get(parent);return ref||(console.warn('Prefab "'.concat(data.name,'" cannot inherit from Prefab "').concat(parent,'" because is not registered yet! Prefabs must be registered in the right order.')),parent)}));var _step,_iterator=_createForOfIteratorHelper(data.components||[]);try{for(_iterator.s();!(_step=_iterator.n()).done;){var componentData=_step.value;if("string"==typeof componentData||componentData.prototype instanceof Component){var def=this._ecs.components.get(componentData);def&&prefab.addComponent(new PrefabComponent(def))}else if("object"===_typeof(componentData)){var type=componentData.type,_def=this._ecs.components.get(type);_def&&prefab.addComponent(new PrefabComponent(_def,componentData.properties,componentData.overwrite))}else console.warn('Unrecognized component reference "'.concat(componentData,'" in prefab "').concat(data.name,'". Ensure the component is registered before the prefab.'))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return this.register(prefab),prefab}},{key:"register",value:function(prefab){this._prefabs[prefab.name]=prefab}},{key:"get",value:function(nameOrClassOrPrefab){var name=PrefabRegistry._getName(nameOrClassOrPrefab);return this._prefabs[name]}},{key:"create",value:function(nameOrClass){var initialProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},prefab=this.get(nameOrClass);if(prefab){var entity=this._ecs.createEntity();return prefab.applyToEntity(entity,initialProps),entity}console.warn("Could not instantiate prefab for ".concat(nameOrClass," since it is not registered"))}}],[{key:"_getName",value:function(nameOrClassOrPrefab){return"string"==typeof nameOrClassOrPrefab?nameOrClassOrPrefab:nameOrClassOrPrefab instanceof Prefab||nameOrClassOrPrefab.prototype instanceof Prefab?nameOrClassOrPrefab.name:null}}]),PrefabRegistry}(),urlAlphabet="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",EntityEvent=function(){function EntityEvent(name){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,EntityEvent),_defineProperty(this,"data",{}),_defineProperty(this,"_prevented",!1),_defineProperty(this,"_handled",!1),this.name=name,this.data=data}return _createClass(EntityEvent,[{key:"prevented",get:function(){return this._prevented}},{key:"handled",get:function(){return this._handled}}]),_createClass(EntityEvent,[{key:"is",value:function(name){return this.name===name}},{key:"handle",value:function(){this._handled=!0,this._prevented=!0}},{key:"prevent",value:function(){this._prevented=!0}}]),EntityEvent}(),Entity=function(){function Entity(ecs){var id=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,Entity),_defineProperty(this,"id",null),_defineProperty(this,"components",{}),_defineProperty(this,"ecs",null),_defineProperty(this,"_isDestroyed",!1),this.ecs=ecs,this.id=id||ecs.generateId()}return _createClass(Entity,[{key:"isDestroyed",get:function(){return this._isDestroyed}}]),_createClass(Entity,[{key:"has",value:function(typeOrClass){var key=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,type=this.ecs.components._getType(typeOrClass),accessor=this.ecs.components.getAccessor(type),hasType=this.hasOwnProperty(accessor);return hasType&&key?this[accessor].hasOwnProperty(key):hasType}},{key:"get",value:function(typeOrClass){var key=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,type=this.ecs.components._getType(typeOrClass),accessor=this.ecs.components.getAccessor(type),components=this[accessor];return components&&key?components[key]:components}},{key:"destroy",value:function(){this._isDestroyed=!0;for(var _i3=0,_Object$values2=Object.values(this.components);_i3<_Object$values2.length;_i3++){var component=_Object$values2[_i3];if(component instanceof Component)component.destroy();else for(var _i4=0,_Object$values3=Object.values(component);_i4<_Object$values3.length;_i4++){_Object$values3[_i4].destroy()}}this.ecs.entities.onEntityDestroyed(this)}},{key:"add",value:function(typeOrClass){var properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(typeOrClass instanceof Component)return typeOrClass.isAttached?(console.warn('"'.concat(typeOrClass.type,'" component cannot be added, since it is already attached to an entity.')),!1):this.attach(typeOrClass);var component=this.ecs.components.create(typeOrClass,properties);return component?this.attach(component):(console.warn('"'.concat(typeOrClass,'" component cannot be added, since it is not registered.')),!1)}},{key:"attach",value:function(component){var accessor=this.ecs.components.getAccessor(component.type);return component.allowMultiple?component.keyProperty?component.key?(this.components[accessor]||(this.components[accessor]={},Object.defineProperty(this,accessor,{configurable:!0,enumerable:!0,get:function(){return this.components[accessor]}})),this.components[accessor][component.key]=component,component._onAttached(this),this.ecs.queries.onComponentAdded(this,component),!0):(console.warn('"'.concat(component.type,'" component has a falsy key of "').concat(component.key,'". The keyProperty is set to "').concat(component.keyProperty,'".')),!1):(this.components[accessor]||(this.components[accessor]=[],Object.defineProperty(this,accessor,{configurable:!0,enumerable:!0,get:function(){return this.components[accessor]}})),this.components[accessor].push(component),component._onAttached(this),this.ecs.queries.onComponentAdded(this),!0):this.has(component.type)?(console.warn('"'.concat(component.type,'" component has allowMultiple set to ').concat(component.allowMultiple,'. Trying to add a "').concat(component.type,'" component to an entity which already has one.')),!1):(this.components[accessor]=component,Object.defineProperty(this,accessor,{enumerable:!0,configurable:!0,get:function(){return this.components[accessor]}}),component._onAttached(this),this.ecs.queries.onComponentAdded(this),!0)}},{key:"owns",value:function(component){return component.entity===this}},{key:"remove",value:function(typeOrClassOrComponent){var key=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,isComponent=typeOrClassOrComponent instanceof Component;key=isComponent?typeOrClassOrComponent.key:key;var definition=this.ecs.components.get(typeOrClassOrComponent),accessor=this.ecs.components.getAccessor(definition.type);if(definition.allowMultiple){if(!definition.keyProperty){if(!isComponent){var _step2,_iterator2=_createForOfIteratorHelper(this.components[accessor]);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var instance=_step2.value;instance._onDetached()}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return delete this[accessor],delete this.components[accessor],this.ecs.queries.onComponentRemoved(this),!0}var _all=this.components[accessor];if(!_all)return void console.warn('Trying to remove a "'.concat(definition.type,"\" component from an entity, but it wasn't found."));var index=_all.indexOf(typeOrClassOrComponent);if(index>-1)return _all.splice(index,1),typeOrClassOrComponent._onDetached(),0===_all.length&&(delete this[accessor],delete this.components[accessor]),this.ecs.queries.onComponentRemoved(this),!0}if(!key)return void console.warn('Trying to remove a "'.concat(definition.type,'" component which allows multiple without specifying an key.'));var all=this.components[accessor],component=all[key];return component?(delete all[key],component._onDetached(),Object.keys(all).length<=0&&(delete this[accessor],delete this.components[accessor]),this.ecs.queries.onComponentRemoved(this),component):void console.warn('Trying to remove a "'.concat(definition.type,'" component from an entity at "').concat(key,"\", but it wasn't found."))}if(accessor in this){var _component=this.components[accessor];return delete this[accessor],delete this.components[accessor],_component._onDetached(),this.ecs.queries.onComponentRemoved(this),_component}console.warn('Trying to remove a "'.concat(definition.type,"\" component from an entity, but it wasn't found."))}},{key:"serialize",value:function(){return Object.entries(this.components).reduce((function(o,_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];return value instanceof Component?_objectSpread(_objectSpread({},o),{},_defineProperty2({},key,value.serialize())):Array.isArray(value)?_objectSpread(_objectSpread({},o),{},_defineProperty2({},key,value.map((function(v){return v.serialize()})))):_objectSpread(_objectSpread({},o),{},_defineProperty2({},key,Object.entries(value).reduce((function(o2,_ref5){var _ref6=_slicedToArray(_ref5,2),k2=_ref6[0],v2=_ref6[1];return _objectSpread(_objectSpread({},o2),{},_defineProperty2({},k2,v2.serialize()))}),{})))}),{id:this.id})}},{key:"fireEvent",value:function(name,data){for(var evt=new EntityEvent(name,data),_i5=0,_Object$values4=Object.values(this.components);_i5<_Object$values4.length;_i5++){var component=_Object$values4[_i5];if(component instanceof Component){if(component._onEvent(evt),evt.prevented)return evt}else for(var _i6=0,_Object$values5=Object.values(component);_i6<_Object$values5.length;_i6++){if(_Object$values5[_i6]._onEvent(evt),evt.prevented)return evt}}return evt}}]),Entity}(),EntityRegistry=function(){function EntityRegistry(ecs){_classCallCheck(this,EntityRegistry),_defineProperty(this,"_entities",new Map),_defineProperty(this,"_ecs",null),_defineProperty(this,"_refs",new Map),this._ecs=ecs}return _createClass(EntityRegistry,[{key:"register",value:function(entity){return this._entities.set(entity.id,entity),entity}},{key:"get",value:function(id){return this._entities.get(id)}},{key:"createOrGetById",value:function(id){var entity=this.get(id);return entity||this.create(id)}},{key:"create",value:function(){var id=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,entity=new Entity(this._ecs,id);return this.register(entity),this._ecs.queries.onEntityCreated(entity),entity}},{key:"destroy",value:function(entity){entity.destroy()}},{key:"onEntityDestroyed",value:function(entity){this.cleanupRefs(entity),this._entities.delete(entity.id),this._ecs.queries.onEntityDestroyed(entity)}},{key:"cleanupRefs",value:function(entity){var refs=this._refs.get(entity.id);if(refs){var _step3,_iterator3=_createForOfIteratorHelper(refs);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){_step3.value.cleanupReference(entity)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}delete this._refs[entity.id]}}},{key:"addRef",value:function(entityId,property){this._refs.has(entityId)?this._refs.get(entityId).add(property):this._refs.set(entityId,new Set([property]))}},{key:"removeRef",value:function(entityId,property){this._refs.has(entityId)&&this._refs.get(entityId).delete(property)}},{key:"serialize",value:function(entities){var json=[];return(entities||this._entities).forEach((function(entity){json.push(entity.serialize())})),json}},{key:"deserialize",value:function(data){var _step4,_iterator4=_createForOfIteratorHelper(data.entities);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var entityData=_step4.value;this.createOrGetById(entityData.id)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var _step5,_iterator5=_createForOfIteratorHelper(data.entities);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _entityData=_step5.value;this.deserializeEntity(_entityData)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}},{key:"deserializeEntity",value:function(data){var _this7=this,id=data.id,componentData=_objectWithoutProperties(data,["id"]),entity=this.createOrGetById(id);Object.entries(componentData).forEach((function(_ref7){var _ref8=_slicedToArray(_ref7,2),key=_ref8[0],value=_ref8[1],type=function(value){return pascalCache.has(value)||pascalCache.set(value,camelcase(value,{pascalCase:!0})),pascalCache.get(value)}(key),definition=_this7._ecs.components.get(type);definition.allowMultiple?Object.values(value).forEach((function(d){entity.add(definition,d)})):entity.add(definition,value)}))}},{key:"all",get:function(){return this._entities.values()}}]),EntityRegistry}(),Query=function(){function Query(ecs){var filter=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,Query),_defineProperty(this,"_ecs",void 0),_defineProperty(this,"_filter",void 0),_defineProperty(this,"_onEntityAddedCallbacks",[]),_defineProperty(this,"_onEntityRemovedCallbacks",[]),_defineProperty(this,"_cache",new Set),this._ecs=ecs,this._filter=cjs({any:[],all:[],none:[]},filter),this.bustCache()}return _createClass(Query,[{key:"isMatch",value:function(entity){var hasAny=!this._filter.any.length||this._filter.any.some((function(c){return entity.has(c)})),hasAll=this._filter.all.every((function(c){return entity.has(c)})),hasNone=!this._filter.none.some((function(c){return entity.has(c)}));return hasAny&&hasAll&&hasNone}},{key:"onEntityAdded",value:function(fn){this._onEntityAddedCallbacks.push(fn)}},{key:"onEntityRemoved",value:function(fn){this._onEntityRemovedCallbacks.push(fn)}},{key:"has",value:function(entity){return this._cache.has(entity)}},{key:"candidate",value:function(entity){var isTracking=this.has(entity);return this.isMatch(entity)?(isTracking||(this._cache.add(entity),this._onEntityAddedCallbacks.forEach((function(cb){return cb(entity)}))),!0):(isTracking&&(this._cache.delete(entity),this._onEntityRemovedCallbacks.forEach((function(cb){return cb(entity)}))),!1)}},{key:"_onEntityCreated",value:function(entity){this.candidate(entity)}},{key:"_onComponentAdded",value:function(entity){this.candidate(entity)}},{key:"_onComponentRemoved",value:function(entity){this.candidate(entity)}},{key:"_onEntityDestroyed",value:function(entity){this.has(entity)&&(this._cache.delete(entity),this._onEntityRemovedCallbacks.forEach((function(cb){return cb(entity)})))}},{key:"bustCache",value:function(){this._cache.clear();var _step6,_iterator6=_createForOfIteratorHelper(this._ecs.entities.all);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var entity=_step6.value;this.candidate(entity)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return this._cache}},{key:"get",value:function(){return this._cache}}]),Query}(),QueryRegistry=function(){function QueryRegistry(ecs){_classCallCheck(this,QueryRegistry),_defineProperty(this,"_ecs",void 0),_defineProperty(this,"_queries",[]),this._ecs=ecs}return _createClass(QueryRegistry,[{key:"create",value:function(filters){var query=new Query(this._ecs,filters);return this._queries.push(query),query}},{key:"onComponentAdded",value:function(entity){this._queries.forEach((function(query){return query._onComponentAdded(entity)}))}},{key:"onComponentRemoved",value:function(entity){this._queries.forEach((function(query){return query._onComponentRemoved(entity)}))}},{key:"onEntityCreated",value:function(entity){this._queries.forEach((function(query){return query._onEntityCreated(entity)}))}},{key:"onEntityDestroyed",value:function(entity){this._queries.forEach((function(query){return query._onEntityDestroyed(entity)}))}}]),QueryRegistry}(),Engine=function(){function Engine(){_classCallCheck(this,Engine),this.idGenerator=function(){return function(){for(var id="",i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;i--;)id+=urlAlphabet[64*Math.random()|0];return id}()},this.components=new ComponentRegistry(this),this.prefabs=new PrefabRegistry(this),this.entities=new EntityRegistry(this),this.queries=new QueryRegistry(this)}return _createClass(Engine,[{key:"generateId",value:function(){return this.idGenerator()}},{key:"createEntity",value:function(id){return this.entities.create(id)}},{key:"createPrefab",value:function(nameOrClass){var initialProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.prefabs.create(nameOrClass,initialProps)}},{key:"destroyEntity",value:function(entity){return this.entities.destroy(entity)}},{key:"registerPrefab",value:function(data){this.prefabs.deserialize(data)}},{key:"registerComponent",value:function(component){this.components.register(component)}},{key:"getEntity",value:function(id){return this.entities.get(id)}},{key:"createComponent",value:function(type,properties){return this.components.create(type,properties)}},{key:"createQuery",value:function(filters){return this.queries.create(filters)}},{key:"serialize",value:function(entities){return{entities:this.entities.serialize(entities)}}},{key:"deserialize",value:function(data){return data.id?this.entities.deserializeEntity(data):this.entities.deserialize(data)}}]),Engine}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IsDestroying:()=>IsDestroying});var obj,key,value,IsDestroying=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(IsDestroying,_Component);var _super=_createSuper(IsDestroying);function IsDestroying(){return _classCallCheck(this,IsDestroying),_super.apply(this,arguments)}return IsDestroying}(__webpack_require__(22).Component);value={pass:0},(key="properties")in(obj=IsDestroying)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LiquidContainer:()=>LiquidContainer});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_data_Spawnables__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25),_data_Spawner__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(26),_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(28),_IsDestroying__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(23);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,LiquidContainer=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(LiquidContainer,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(LiquidContainer);function LiquidContainer(){return _classCallCheck(this,LiquidContainer),_super.apply(this,arguments)}return Constructor=LiquidContainer,(protoProps=[{key:"_checkDestroyOnEmpty",value:function(){this.destroyOnEmpty&&this.isEmpty&&this.entity.add(_IsDestroying__WEBPACK_IMPORTED_MODULE_4__.IsDestroying)}},{key:"pour",value:function(x,y,quantity){return this.isPourable?this.volume<=0?(console.warn("The contianer is empty and cannot be poured."),!1):((isNaN(quantity)||quantity>=this.volume)&&(quantity=this.volume),this.volume-=quantity,(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_2__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_POOL_LIQUID,x,y,{content:this.content,volume:quantity}),this._checkDestroyOnEmpty(),!0):(console.warn("The container connot be poured."),!1)}},{key:"onTryPour",value:function(evt){if(this.isEmpty)console.warn("The container is empty.");else{var pos=evt.data.interactor.position.getPos();this.pour(pos.x,pos.y,evt.data.volume),evt.data.interactor.fireEvent("energy-consumed",400),evt.handle()}}},{key:"onTryDrink",value:function(evt){this.isEmpty?console.warn("The container is empty."):((0,_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_3__.drinkLiquid)(evt.data.interactor,this.content,this.volume),this.volume=0,this._checkDestroyOnEmpty(),evt.data.interactor.fireEvent("energy-consumed",700),evt.handle())}},{key:"onGetInteractions",value:function(evt){this.isEmpty||(evt.data.interactions.push({name:"Drink",evt:"try-drink"}),this.isPourable&&evt.data.interactions.push({name:"Pour",evt:"try-pour"}))}},{key:"liquid",get:function(){return!this.isEmpty&&_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_3__.liquids[this.content]}},{key:"isEmpty",get:function(){return isNaN(this.content)||this.volume<=0}},{key:"display",get:function(){return this.isEmpty?"[empty] ".concat(this.volume,"/").concat(this.maxVolume):"[".concat(_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_3__.liquids[this.content].name,"] ").concat(this.volume,"/").concat(this.maxVolume)}},{key:"primaryColorOverride",get:function(){return this.overridePrimary&&this.liquid?this.liquid.primary:null}},{key:"secondaryColorOverride",get:function(){return this.overrideSecondary&&this.liquid?this.liquid.secondary:null}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),LiquidContainer}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);obj=LiquidContainer,key="properties",value={content:_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_3__.LIQUID_BLOOD,volume:10,maxVolume:10,overridePrimary:!1,overrideSecondary:!1,isPourable:!1,destroyOnEmpty:!1},key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SPWN_VIAL_HONEY:()=>SPWN_VIAL_HONEY,SPWN_VIAL_BLOOD:()=>SPWN_VIAL_BLOOD,SPWN_VIAL_WATER:()=>SPWN_VIAL_WATER,SPWN_STONE:()=>SPWN_STONE,SPWN_GOBLIN_GRUNT:()=>SPWN_GOBLIN_GRUNT,SPWN_HUMAN_WANDERER:()=>SPWN_HUMAN_WANDERER,SPWN_PINE_TREE:()=>SPWN_PINE_TREE,SPWN_WOOD_WALL:()=>SPWN_WOOD_WALL,SPWN_WOOD_DOOR:()=>SPWN_WOOD_DOOR,SPWN_WOOD_CHEST:()=>SPWN_WOOD_CHEST,SPWN_STONE_WALL:()=>SPWN_STONE_WALL,SPWN_DIRT_PATH:()=>SPWN_DIRT_PATH,SPWN_CORPSE:()=>SPWN_CORPSE,SPWN_POOL_LIQUID:()=>SPWN_POOL_LIQUID,SPWN_GLASS_SHARD:()=>SPWN_GLASS_SHARD,SPWN_AMULET:()=>SPWN_AMULET,SPWN_CLOTH_ARMOR:()=>SPWN_CLOTH_ARMOR,SPWN_LEATHER_BOOTS:()=>SPWN_LEATHER_BOOTS,SPWN_SHORTSWORD:()=>SPWN_SHORTSWORD});var SPWN_VIAL_HONEY="SPWN_VIAL_HONEY",SPWN_VIAL_BLOOD="SPWN_VIAL_BLOOD",SPWN_VIAL_WATER="SPWN_VIAL_WATER",SPWN_STONE="SPWN_STONE",SPWN_GOBLIN_GRUNT="SPWN_GOBLIN_GRUNT",SPWN_HUMAN_WANDERER="SPWN_HUMAN_WANDERER",SPWN_PINE_TREE="SPWN_PINE_TREE",SPWN_WOOD_WALL="SPWN_WOOD_WALL",SPWN_WOOD_DOOR="SPWN_WOOD_DOOR",SPWN_WOOD_CHEST="SPWN_WOOD_CHEST",SPWN_STONE_WALL="SPWN_STONE_WALL",SPWN_DIRT_PATH="SPWN_DIRT_PATH",SPWN_CORPSE="SPWN_CORPSE",SPWN_POOL_LIQUID="SPWN_POOL_LIQUID",SPWN_GLASS_SHARD="SPWN_GLASS_SHARD",SPWN_AMULET="SPWN_AMULET",SPWN_CLOTH_ARMOR="SPWN_CLOTH_ARMOR",SPWN_LEATHER_BOOTS="SPWN_LEATHER_BOOTS",SPWN_SHORTSWORD="SPWN_SHORTSWORD"},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{spawn:()=>spawn});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_spawnables_SpawnableVialHoney__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(27),_spawnables_SpawnableVialBlood__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(29),_spawnables_SpawnableVialWater__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(30),_spawnables_SpawnableGoblinGrunt__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(31),_spawnables_SpawnablePineTree__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(43),_spawnables_SpawnableHumanWanderer__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(45),_spawnables_SpawnablePoolLiquid__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(46),simplePrefab=function(prefabName){return function(data){return _core_Game__WEBPACK_IMPORTED_MODULE_0__.game.ecs.createPrefab(prefabName,data)}},spawnables={SPWN_VIAL_HONEY:_spawnables_SpawnableVialHoney__WEBPACK_IMPORTED_MODULE_1__.createSpawnable,SPWN_VIAL_BLOOD:_spawnables_SpawnableVialBlood__WEBPACK_IMPORTED_MODULE_2__.createSpawnable,SPWN_VIAL_WATER:_spawnables_SpawnableVialWater__WEBPACK_IMPORTED_MODULE_3__.createSpawnable,SPWN_STONE:simplePrefab("Stone"),SPWN_WOOD_WALL:simplePrefab("WoodWall"),SPWN_WOOD_DOOR:simplePrefab("Door"),SPWN_WOOD_CHEST:simplePrefab("Chest"),SPWN_STONE_WALL:simplePrefab("Wall"),SPWN_DIRT_PATH:simplePrefab("DirtPathway"),SPWN_CORPSE:simplePrefab("Corpse"),SPWN_GLASS_SHARD:simplePrefab("GlassShard"),SPWN_AMULET:simplePrefab("Amulet"),SPWN_CLOTH_ARMOR:simplePrefab("ClothArmor"),SPWN_LEATHER_BOOTS:simplePrefab("Boots"),SPWN_SHORTSWORD:simplePrefab("Shortsword"),SPWN_GOBLIN_GRUNT:_spawnables_SpawnableGoblinGrunt__WEBPACK_IMPORTED_MODULE_4__.createSpawnable,SPWN_HUMAN_WANDERER:_spawnables_SpawnableHumanWanderer__WEBPACK_IMPORTED_MODULE_6__.createSpawnable,SPWN_PINE_TREE:_spawnables_SpawnablePineTree__WEBPACK_IMPORTED_MODULE_5__.createSpawnable,SPWN_POOL_LIQUID:_spawnables_SpawnablePoolLiquid__WEBPACK_IMPORTED_MODULE_7__.createSpawnable},spawn=function(key,x,y){var data=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},entity=spawnables[key](data,x,y);return isNaN(x)||isNaN(y)||!entity.position||entity.position.setPos(x,y),entity}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createSpawnable:()=>createSpawnable});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(28),createSpawnable=function(){var vial=_core_Game__WEBPACK_IMPORTED_MODULE_0__.game.ecs.createPrefab("Vial");return vial.liquidContainer.content=_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_1__.LIQUID_HONEY,vial}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LIQUID_WATER:()=>LIQUID_WATER,LIQUID_BLOOD:()=>LIQUID_BLOOD,LIQUID_HONEY:()=>LIQUID_HONEY,LIQUID_OIL:()=>LIQUID_OIL,liquids:()=>liquids,drinkLiquid:()=>drinkLiquid});var _liquids,_core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var LIQUID_WATER=0,LIQUID_BLOOD=1,LIQUID_HONEY=3,LIQUID_OIL=4,liquids=(_defineProperty(_liquids={},LIQUID_WATER,{name:"water",colorDesc:"watery",primary:"#66a3dc",secondary:"#8bb9d5",onDrink:function(entity){console.log("Mmm. earth juice. yummy")}}),_defineProperty(_liquids,LIQUID_BLOOD,{name:"blood",colorDesc:"bloody",primary:"#ce2a36",secondary:"#e0c1c2",onDrink:function(entity,volume){console.log("blood. this would make a good syrup"),entity.fireEvent("heal",{value:1*volume})}}),_defineProperty(_liquids,LIQUID_HONEY,{name:"honey",colorDesc:"gooey golden",primary:"#d6aa3a",secondary:"#f4d260",onDrink:function(entity,volume){var pos=entity.position.getPos();_core_Game__WEBPACK_IMPORTED_MODULE_0__.game.particles.createEmitter(pos.x,pos.y-1,{direction:{x:0,y:-1},glyphs:[".","○"],fg1s:["#d6aa3a"],speed:.02,lifetime:500}),entity.fireEvent("heal",{value:2*volume})}}),_liquids),drinkLiquid=function(entity,type,volume){liquids[type].onDrink(entity,volume)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createSpawnable:()=>createSpawnable});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(28),createSpawnable=function(){var vial=_core_Game__WEBPACK_IMPORTED_MODULE_0__.game.ecs.createPrefab("Vial");return vial.liquidContainer.content=_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_1__.LIQUID_BLOOD,vial}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createSpawnable:()=>createSpawnable});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(28),createSpawnable=function(){var vial=_core_Game__WEBPACK_IMPORTED_MODULE_0__.game.ecs.createPrefab("Vial");return vial.liquidContainer.content=_enums_LiquidTypes__WEBPACK_IMPORTED_MODULE_1__.LIQUID_WATER,vial}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createSpawnable:()=>createSpawnable});var _ai_GoalTypes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(32),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_Spawnables__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25),_Spawner__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26),createSpawnable=function(){var goblin=_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.ecs.createPrefab("Goblin");goblin.brain.pushGoal(_ai_GoalTypes__WEBPACK_IMPORTED_MODULE_0__.BoredGoalType.create());var sword=(0,_Spawner__WEBPACK_IMPORTED_MODULE_3__.spawn)(_Spawnables__WEBPACK_IMPORTED_MODULE_2__.SPWN_SHORTSWORD);return goblin.equipmentSlot.handRight.equip(sword),goblin}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BoredGoalType:()=>_BoredGoalType__WEBPACK_IMPORTED_MODULE_0__.BoredGoalType,EatFoodGoalType:()=>_EatFoodGoalType__WEBPACK_IMPORTED_MODULE_1__.EatFoodGoalType,MoveGoalType:()=>_MoveGoalType__WEBPACK_IMPORTED_MODULE_2__.MoveGoalType,KillSomethingGoalType:()=>_KillSomethingGoalType__WEBPACK_IMPORTED_MODULE_3__.KillSomethingGoalType});var _BoredGoalType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(33),_EatFoodGoalType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(42),_MoveGoalType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(41),_KillSomethingGoalType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(36)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BoredGoalType:()=>BoredGoalType});var _GoalType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35),_KillSomethingGoalType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(36);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var BoredGoalType=function(_GoalType){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(BoredGoalType,_GoalType);var _super=_createSuper(BoredGoalType);function BoredGoalType(){return _classCallCheck(this,BoredGoalType),_super.apply(this,arguments)}return BoredGoalType}(_GoalType__WEBPACK_IMPORTED_MODULE_0__.GoalType);_defineProperty(BoredGoalType,"name","Bored"),_defineProperty(BoredGoalType,"isFinished",(function(entity,goal){return!1})),_defineProperty(BoredGoalType,"takeAction",(function(entity,goal){var targets=new Set;if(entity.fireEvent("try-detect-hostiles",{targets}),targets.size>0){var target=_toConsumableArray(targets)[0],killGoal=_KillSomethingGoalType__WEBPACK_IMPORTED_MODULE_2__.KillSomethingGoalType.createAsSubGoal(goal,{target:target.id});return entity.brain.pushGoal(killGoal),entity.fireEvent("take-action"),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.SUCCESS}var boredomGoal=entity.fireEvent("boredom");return boredomGoal.data.goal?(entity.brain.pushGoal(boredomGoal.data.goal),entity.fireEvent("take-action"),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.SUCCESS):(entity.fireEvent("energy-consumed",1e3),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.SUCCESS)}))},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GoalType:()=>GoalType});var _GoalActionResult__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(35),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var GoalType=function(){function GoalType(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GoalType)}var Constructor,protoProps,staticProps;return Constructor=GoalType,staticProps=[{key:"isFinished",value:function(entity,goal){return!1}},{key:"takeAction",value:function(entity,goal){return _GoalActionResult__WEBPACK_IMPORTED_MODULE_0__.FAILURE}},{key:"createAsSubGoal",value:function(originalIntent){var properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.create(_objectSpread(_objectSpread({},properties),{},{originalIntent:originalIntent.entity.id}))}},{key:"create",value:function(){var properties=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _core_Game__WEBPACK_IMPORTED_MODULE_1__.game.ecs.createPrefab("Goal",{goal:_objectSpread({name:this.name},properties)}).goal}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),GoalType}();_defineProperty(GoalType,"name","Unknown")},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SUCCESS:()=>SUCCESS,FAILURE:()=>FAILURE,INVALID:()=>INVALID});var SUCCESS="SUCCESS",FAILURE="FAILURE",INVALID="INVALID"},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{KillSomethingGoalType:()=>KillSomethingGoalType});var _GoalType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35),_utils_AStar__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(37),_core_Game__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3),_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(38),_MoveGoalType__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(41);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var KillSomethingGoalType=function(_GoalType){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(KillSomethingGoalType,_GoalType);var _super=_createSuper(KillSomethingGoalType);function KillSomethingGoalType(){return _classCallCheck(this,KillSomethingGoalType),_super.apply(this,arguments)}return KillSomethingGoalType}(_GoalType__WEBPACK_IMPORTED_MODULE_0__.GoalType);_defineProperty(KillSomethingGoalType,"name","KillSomething"),_defineProperty(KillSomethingGoalType,"isFinished",(function(entity,goal){return!goal.target||goal.target.isDead||goal.target.isDestroyed})),_defineProperty(KillSomethingGoalType,"takeAction",(function(entity,goal){if(entity.fireEvent("try-melee",{target:goal.target}).handled)return _GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.SUCCESS;var start=entity.position.getPos(),targetPos=goal.target.position.getPos(),result=(0,_utils_AStar__WEBPACK_IMPORTED_MODULE_2__.computeAStar)({start,goal:targetPos,cost:function(a,b){var entities=_core_Game__WEBPACK_IMPORTED_MODULE_3__.game.map.getEntitiesAt(b.x,b.y);return _core_Game__WEBPACK_IMPORTED_MODULE_3__.game.map.isOutOfbounds(b.x,b.y)||entities.some((function(e){return e.blocker}))?1/0:(0,_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_4__.diagonalDistance)(a,b)}});if(result.success){var segment=result.path[1],delta={x:segment.x-start.x,y:segment.y-start.y},moveGoal=_MoveGoalType__WEBPACK_IMPORTED_MODULE_5__.MoveGoalType.createAsSubGoal(goal,{data:delta});return entity.brain.pushGoal(moveGoal),entity.fireEvent("take-action"),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.SUCCESS}return entity.fireEvent("energy-consumed",1e3),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.FAILURE}))},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{computeAStar:()=>computeAStar});var _diagonalDistance__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(38),_ManhattanDistance__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39),_PriorityQueue__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var getNeighbors=function(x,y){return[{x,y:y-1},{x:x-1,y},{x:x+1,y},{x,y:y+1},{x:x-1,y:y-1},{x:x+1,y:y-1},{x:x-1,y:y+1},{x:x+1,y:y+1}]},key=function(pos){return"".concat(pos.x,",").concat(pos.y)},defaultSettings={start:{},goal:{},cost:function(){},allowDiagonals:!0},computeAStar=function(){var settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultSettings,heuristic=settings.allowDiagonals?_diagonalDistance__WEBPACK_IMPORTED_MODULE_0__.diagonalDistance:_ManhattanDistance__WEBPACK_IMPORTED_MODULE_1__.manhattanDistance,start=settings.start,goal=settings.goal,cost=settings.cost,open=new _PriorityQueue__WEBPACK_IMPORTED_MODULE_2__.default,cameFrom={},costSoFar={},startKey=key(start),goalKey=key(goal),result={success:!1,path:[],costs:[],cost:1/0,start,goal};if(cost(start,goal)===1/0)return result;for(open.put({key:startKey,pos:start},0),costSoFar[startKey]=0;!open.isEmpty();){var _open$pop=open.pop(),currentKey=_open$pop.key,current=_open$pop.pos;if(currentKey===goalKey){result.success=!0;break}var _step,neighbors=getNeighbors(current.x,current.y),_iterator=_createForOfIteratorHelper(neighbors);try{for(_iterator.s();!(_step=_iterator.n()).done;){var next=_step.value,nextKey=key(next),graphCost=nextKey===goalKey?0:cost(current,next);if(graphCost!==1/0){var newCost=costSoFar[currentKey]+graphCost;if(!(nextKey in costSoFar)||newCost<costSoFar[nextKey]){costSoFar[nextKey]=newCost;var priority=newCost+heuristic(next,goal);open.put({key:nextKey,pos:next},priority),cameFrom[nextKey]=current}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}if(!result.success)return result;result.path=[goal],result.cost=costSoFar[goalKey],result.costs=[costSoFar[goalKey]];for(var previous=cameFrom[key(goal)];previous;){var previousKey=key(previous);result.path.unshift(previous),result.costs.unshift(costSoFar[previousKey]),previous=cameFrom[previousKey]}return result}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{diagonalDistance:()=>diagonalDistance});var diagonalDistance=function(a,b){var dx=Math.abs(a.x-b.x),dy=Math.abs(a.y-b.y);return 1*(dx+dy)+(1.41-2)*Math.min(dx,dy)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{manhattanDistance:()=>manhattanDistance});var manhattanDistance=function(a,b){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>PriorityQueue});var _items=new WeakMap,PriorityQueue=function(){function PriorityQueue(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PriorityQueue),_items.set(this,{writable:!0,value:[]})}var Constructor,protoProps,staticProps;return Constructor=PriorityQueue,(protoProps=[{key:"isEmpty",value:function(){return _classPrivateFieldGet(this,_items).length<=0}},{key:"pop",value:function(){if(!this.isEmpty())return _classPrivateFieldGet(this,_items).shift().value}},{key:"peek",value:function(){if(!this.isEmpty())return _classPrivateFieldGet(this,_items)[0].value}},{key:"put",value:function(value,priority){for(var item=function(value,priority){return{value,priority}}(value,priority),i=0;i<_classPrivateFieldGet(this,_items).length;i++)if(_classPrivateFieldGet(this,_items)[i].priority>item.priority)return void _classPrivateFieldGet(this,_items).splice(i,0,item);_classPrivateFieldGet(this,_items).push(item)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),PriorityQueue}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MoveGoalType:()=>MoveGoalType});var _GoalType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var MoveGoalType=function(_GoalType){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MoveGoalType,_GoalType);var _super=_createSuper(MoveGoalType);function MoveGoalType(){return _classCallCheck(this,MoveGoalType),_super.apply(this,arguments)}return MoveGoalType}(_GoalType__WEBPACK_IMPORTED_MODULE_0__.GoalType);_defineProperty(MoveGoalType,"name","Move"),_defineProperty(MoveGoalType,"isFinished",(function(entity,goal){return goal.complete})),_defineProperty(MoveGoalType,"takeAction",(function(entity,goal){return entity.fireEvent("try-move",{x:goal.data.x,y:goal.data.y}).handled?(goal.complete=!0,_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.SUCCESS):_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.FAILURE}))},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EatFoodGoalType:()=>EatFoodGoalType});var _GoalType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34),_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var EatFoodGoalType=function(_GoalType){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(EatFoodGoalType,_GoalType);var _super=_createSuper(EatFoodGoalType);function EatFoodGoalType(){return _classCallCheck(this,EatFoodGoalType),_super.apply(this,arguments)}return EatFoodGoalType}(_GoalType__WEBPACK_IMPORTED_MODULE_0__.GoalType);_defineProperty(EatFoodGoalType,"name","EatFood"),_defineProperty(EatFoodGoalType,"isFinished",(function(entity,goal){return goal.complete})),_defineProperty(EatFoodGoalType,"takeAction",(function(entity,goal){return entity.fireEvent("try-eat-food",{food:1e4}).handled?(goal.complete=!0,_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.SUCCESS):_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.FAILURE}))},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createSpawnable:()=>createSpawnable});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_utils_rand__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(44),createSpawnable=function(){var type=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_1__.pickRandom)(["PineTree","SmallPineTree"]);return _core_Game__WEBPACK_IMPORTED_MODULE_0__.game.ecs.createPrefab(type)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{pickRandom:()=>pickRandom,randomInt:()=>randomInt});var pickRandom=function(arr){return arr[Math.floor(Math.random()*arr.length)]},randomInt=function(min,max){return Math.floor(Math.random()*(max-min+1)+min)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createSpawnable:()=>createSpawnable});var _ai_GoalTypes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(32),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),createSpawnable=function(){var wanderer=_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.ecs.createPrefab("HumanWanderer");return wanderer.brain.pushGoal(_ai_GoalTypes__WEBPACK_IMPORTED_MODULE_0__.BoredGoalType.create()),wanderer}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{createSpawnable:()=>createSpawnable});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),createSpawnable=function(data){return _core_Game__WEBPACK_IMPORTED_MODULE_0__.game.ecs.createPrefab("Pool",{liquidContainer:{content:data.content,volume:data.volume}})}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Door:()=>Door});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_Blocker__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(48),_Shadowcaster__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(49);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Door=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Door,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Door);function Door(){return _classCallCheck(this,Door),_super.apply(this,arguments)}return Constructor=Door,(protoProps=[{key:"openDoor",value:function(){if(this.isOpen)return!1;this.isOpen=!0;var glyph=this.entity.glyph;return glyph&&(glyph.ch=this.ch),this.entity.blocker.destroy(),this.entity.shadowcaster.destroy(),!0}},{key:"closeDoor",value:function(){if(!this.isOpen)return!1;this.isOpen=!1;var glyph=this.entity.glyph;return glyph&&(glyph.ch=this.ch),this.entity.add(_Blocker__WEBPACK_IMPORTED_MODULE_1__.Blocker),this.entity.add(_Shadowcaster__WEBPACK_IMPORTED_MODULE_2__.Shadowcaster),!0}},{key:"onGetInteractions",value:function(evt){this.isOpen?evt.data.interactions.push({name:"Close door",evt:"try-close-door"}):evt.data.interactions.push({name:"Open door",evt:"try-open-door"})}},{key:"onTryCloseDoor",value:function(evt){this.closeDoor()&&evt.data.interactor.fireEvent("energy-consumed",800),evt.handle()}},{key:"onTryOpenDoor",value:function(evt){this.openDoor()&&evt.data.interactor.fireEvent("energy-consumed",800),evt.handle()}},{key:"onProjectileHit",value:function(evt){this.isOpen||(evt.data.stopProjectile=!0,evt.data.deflectProjectile=!1),this.openDoor()}},{key:"ch",get:function(){return this.isOpen?this.chOpen:this.chClosed}},{key:"display",get:function(){return this.isOpen?"[open]":"[closed]"}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Door}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={isOpen:!1,chOpen:"'",chClosed:"+"},(key="properties")in(obj=Door)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Blocker:()=>Blocker});var Blocker=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Blocker,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Blocker);function Blocker(){return _classCallCheck(this,Blocker),_super.apply(this,arguments)}return Constructor=Blocker,(protoProps=[{key:"onProjectileHit",value:function(evt){this.isAttached&&(evt.data.stopProjectile=!0,evt.data.deflectProjectile=!0)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Blocker}(__webpack_require__(22).Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Shadowcaster:()=>Shadowcaster});var Shadowcaster=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Shadowcaster,_Component);var _super=_createSuper(Shadowcaster);function Shadowcaster(){return _classCallCheck(this,Shadowcaster),_super.apply(this,arguments)}return Shadowcaster}(__webpack_require__(22).Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Armor:()=>Armor});var obj,key,value,Armor=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Armor,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Armor);function Armor(){return _classCallCheck(this,Armor),_super.apply(this,arguments)}return Constructor=Armor,(protoProps=[{key:"onQueryEquippedAbilityModifierArmor",value:function(evt){evt.data.modifiers.push({source:this.entity.moniker.name,mod:this.value})}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Armor}(__webpack_require__(22).Component);value={value:4},(key="properties")in(obj=Armor)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Loot:()=>Loot});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_Inventory__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(52),_IsInventoried__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(54);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Loot=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Loot,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Loot);function Loot(){return _classCallCheck(this,Loot),_super.apply(this,arguments)}return Constructor=Loot,(protoProps=[{key:"onGetInteractions",value:function(evt){var interactor=evt.data.interactor,isInventoried=this.entity.has(_IsInventoried__WEBPACK_IMPORTED_MODULE_2__.IsInventoried);interactor.has(_Inventory__WEBPACK_IMPORTED_MODULE_1__.Inventory)&&(isInventoried?interactor.inventory.hasLoot(this.entity)?evt.data.interactions.push({name:"Drop",evt:"try-drop"}):evt.data.interactions.push({name:"Take",evt:"try-take"}):evt.data.interactions.push({name:"Pickup",evt:"try-pick-up"}))}},{key:"onEquipped",value:function(evt){evt.data.interactor.has(_Inventory__WEBPACK_IMPORTED_MODULE_1__.Inventory)&&(evt.data.interactor.inventory.hasLoot(this.entity)||evt.data.interactor.inventory.addLoot(this.entity))}},{key:"onTryPickUp",value:function(evt){evt.data.interactor.inventory.addLoot(this.entity),evt.data.interactor.fireEvent("energy-consumed",100),evt.handle()}},{key:"onTryTake",value:function(evt){this.entity.isInventoried.owner.inventory.removeLoot(this.entity),evt.data.interactor.inventory.addLoot(this.entity),evt.data.interactor.fireEvent("energy-consumed",100),evt.handle()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Loot}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Inventory:()=>Inventory});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(53),_IsInventoried__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(54),_Stackable__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(55);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Inventory=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Inventory,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Inventory);function Inventory(){return _classCallCheck(this,Inventory),_super.apply(this,arguments)}return Constructor=Inventory,(protoProps=[{key:"onDestroyed",value:function(){this.content.forEach((function(entity){return entity.destroy()}))}},{key:"onQueryOwnership",value:function(evt){this.content.forEach((function(entity){evt.data.result.add(entity),entity.fireEvent("query-ownership",{result:evt.data.result})}))}},{key:"getStackable",value:function(stackableIdentifier){return this.content.find((function(entity){return entity.has(_Stackable__WEBPACK_IMPORTED_MODULE_4__.Stackable)&&entity.stackable.identifier===stackableIdentifier}))}},{key:"addLoot",value:function(loot){if(loot.has(_Stackable__WEBPACK_IMPORTED_MODULE_4__.Stackable)){var existing=this.getStackable(loot.stackable.identifier);if(existing)return void existing.stackable.addOther(loot)}loot.add(_IsInventoried__WEBPACK_IMPORTED_MODULE_3__.IsInventoried,{owner:this.entity}),this.content.push(loot)}},{key:"hasLoot",value:function(loot){return this.content.indexOf(loot)>=0}},{key:"removeLoot",value:function(loot,quantity){if(loot.has(_Stackable__WEBPACK_IMPORTED_MODULE_4__.Stackable)&&!isNaN(quantity))return loot.stackable.split(quantity),this.removeLoot(loot);var idx=this.content.indexOf(loot);return idx>=0&&(this.content.splice(idx,1),loot.isInventoried.destroy()),loot}},{key:"dropLoot",value:function(loot,quantity){var ob=this.removeLoot(loot,quantity),pos=this.entity.position.getPos();return ob.position.setPos(pos.x,pos.y),ob.fireEvent("dropped",{dropper:this.entity}),ob}},{key:"onTryOpen",value:function(evt){_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.screens.replaceScreen(_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_2__.SCREEN_INVENTORY,{accessible:this.entity,accessor:evt.data.interactor}),evt.handle()}},{key:"onGetInteractions",value:function(evt){evt.data.interactions.push({name:"Open",evt:"try-open"})}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Inventory}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={content:"<EntityArray>"},(key="properties")in(obj=Inventory)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SCREEN_MAIN_MENU:()=>SCREEN_MAIN_MENU,SCREEN_ADVENTURE:()=>SCREEN_ADVENTURE,SCREEN_DEATH:()=>SCREEN_DEATH,SCREEN_INVENTORY:()=>SCREEN_INVENTORY,SCREEN_INTERACT_MODAL:()=>SCREEN_INTERACT_MODAL,SCREEN_CURSOR:()=>SCREEN_CURSOR,SCREEN_LOAD_SECTOR:()=>SCREEN_LOAD_SECTOR,SCREEN_EQUIPMENT:()=>SCREEN_EQUIPMENT,SCREEN_LIST_SELECT:()=>SCREEN_LIST_SELECT,SCREEN_CHARACTER:()=>SCREEN_CHARACTER});var SCREEN_MAIN_MENU=0,SCREEN_ADVENTURE=1,SCREEN_DEATH=2,SCREEN_INVENTORY=3,SCREEN_INTERACT_MODAL=4,SCREEN_CURSOR=5,SCREEN_LOAD_SECTOR=6,SCREEN_EQUIPMENT=7,SCREEN_LIST_SELECT=8,SCREEN_CHARACTER=9},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IsInventoried:()=>IsInventoried});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_Stackable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(55);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,IsInventoried=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(IsInventoried,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(IsInventoried);function IsInventoried(){return _classCallCheck(this,IsInventoried),_super.apply(this,arguments)}return Constructor=IsInventoried,(protoProps=[{key:"isOwnedBy",value:function(entity){return this.owner&&this.owner.id===entity.id}},{key:"onQueryOwnership",value:function(evt){evt.data.result.add(this.entity)}},{key:"onTryDrop",value:function(evt){this.owner.inventory.dropLoot(this.entity),evt.data.interactor.fireEvent("energy-consumed",200),evt.handle()}},{key:"onThrown",value:function(evt){var quantity=this.entity.has(_Stackable__WEBPACK_IMPORTED_MODULE_1__.Stackable)?1:null;this.owner.inventory.removeLoot(this.entity,quantity)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),IsInventoried}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={owner:"<Entity>"},(key="properties")in(obj=IsInventoried)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Stackable:()=>Stackable});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_enums_Stackables__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(56),_IsDestroying__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(23),_IsInventoried__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(54);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Stackable=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Stackable,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Stackable);function Stackable(){return _classCallCheck(this,Stackable),_super.apply(this,arguments)}return Constructor=Stackable,(protoProps=[{key:"increment",value:function(amount){this.quantity+=amount}},{key:"addOther",value:function(other){this.increment(other.stackable.quantity),other.stackable.quantity=0,other.add(_IsDestroying__WEBPACK_IMPORTED_MODULE_3__.IsDestroying)}},{key:"split",value:function(quantity){if(quantity>=this.quantity)return quantity=this.quantity,this.entity;var clone=_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.engine.cloneEntity(this.entity);return clone.stackable.quantity-=quantity,this.quantity=quantity,clone.has(_IsInventoried__WEBPACK_IMPORTED_MODULE_4__.IsInventoried)&&clone.isInventoried.owner.inventory.content.push(clone),clone}},{key:"display",get:function(){return"x ".concat(this.quantity)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Stackable}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);obj=Stackable,key="properties",value={identifier:_enums_Stackables__WEBPACK_IMPORTED_MODULE_2__.STACKABLE_DEFAULT,quantity:1},key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{STACKABLE_DEFAULT:()=>STACKABLE_DEFAULT,STACKABLE_STONE:()=>STACKABLE_STONE,STACKABLE_GLASS_SHARD:()=>STACKABLE_GLASS_SHARD});var STACKABLE_DEFAULT="STACKABLE_DEFAULT",STACKABLE_STONE="STACKABLE_STONE",STACKABLE_GLASS_SHARD="STACKABLE_GLASS_SHARD"},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Throwable:()=>Throwable});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(53),_data_Abilities__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(58),_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(67),_utils_BresenhamLine__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(68),_Blocker__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(48),_Body__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(69),_Inventory__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(52),_IsVisible__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(70);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Throwable=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Throwable,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Throwable);function Throwable(){return _classCallCheck(this,Throwable),_super.apply(this,arguments)}return Constructor=Throwable,(protoProps=[{key:"onGetInteractions",value:function(evt){evt.data.interactor.has(_Inventory__WEBPACK_IMPORTED_MODULE_8__.Inventory)&&evt.data.interactor.inventory.hasLoot(this.entity)&&evt.data.interactions.push({name:"Throw",evt:"try-throw"})}},{key:"throw",value:function(trajectory,initiator){var _this=this;this.entity.fireEvent("thrown",{initiator,trajectory});for(var _loop=function(i){if(0==i)return"continue";var position=trajectory[i],entities=position.entities,stopped=!1,deflected=!1,hit=entities.find((function(entity){var evt=entity.fireEvent("projectile-hit",{initiator,trajectory,projectile:_this.entity});return stopped=evt.data.stopProjectile,deflected=evt.data.deflectProjectile,stopped||deflected}));if(hit){if(deflected){var prev=trajectory[i-1];_this.entity.position.setPos(prev.x,prev.y),_this.entity.fireEvent("collide-ground",{initiator,x:prev.x,y:prev.y})}else _this.entity.position.setPos(position.x,position.y),_this.entity.fireEvent("collide",{initiator,hit,x:position.x,y:position.y});return"break"}i===trajectory.length-1&&(_this.entity.position.setPos(position.x,position.y),_this.entity.fireEvent("collide-ground",{initiator,x:position.x,y:position.y}))},i=0;i<trajectory.length;i++){var _ret=_loop(i);if("continue"!==_ret&&"break"===_ret)break}}},{key:"onTryThrow",value:function(evt){var _this2=this,range=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_3__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_3__.ABILITY_THROWING,evt.data.interactor);_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.screens.pushScreen(_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_2__.SCREEN_CURSOR,{start:evt.data.interactor.position.getPos(),drawLine:!0,drawTags:!1,onResult:function(cursor){_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.screens.setScreen(_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_2__.SCREEN_ADVENTURE),_this2.entity.position.setPos(cursor.start.x,cursor.start.y);var trajectory=(0,_utils_BresenhamLine__WEBPACK_IMPORTED_MODULE_5__.bresenhamLine)(cursor.start.x,cursor.start.y,cursor.position.x,cursor.position.y).slice(0,range+1).map((function(pos){return{x:pos.x,y:pos.y,entities:_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.map.getEntitiesAt(pos.x,pos.y)}}));evt.data.interactor.fireEvent("energy-consumed",700),_this2.throw(trajectory,evt.data.interactor)},onCancel:function(){_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.screens.popScreen()},getSegmentTypes:function(line){var lineValid=!0,result=line.map((function(_ref,idx){var x=_ref.x,y=_ref.y;if(0===idx)return _enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_NONE;var entities=_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.map.getEntitiesAt(x,y),blocker=entities.find((function(entity){return entity.has(_IsVisible__WEBPACK_IMPORTED_MODULE_9__.IsVisible)&&entity.has(_Blocker__WEBPACK_IMPORTED_MODULE_6__.Blocker)})),body=entities.find((function(entity){return entity.has(_IsVisible__WEBPACK_IMPORTED_MODULE_9__.IsVisible)&&entity.has(_Body__WEBPACK_IMPORTED_MODULE_7__.Body)}));return blocker&&(lineValid=!1),lineValid&&(body||idx===range)?(lineValid=!1,_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_INTEREST):lineValid?_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_UNKNOWN:_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_INVALID})),interestIdx=result.indexOf(_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_INTEREST),blockerIdx=result.indexOf(_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_INVALID);return interestIdx<blockerIdx&&blockerIdx>=1&&(result[blockerIdx-1]=_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_INTEREST),result}})}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Throwable}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ABILITY_SPEED:()=>ABILITY_SPEED,ABILITY_THROWING:()=>ABILITY_THROWING,ABILITY_ARMOR:()=>ABILITY_ARMOR,ABILITY_DODGE:()=>ABILITY_DODGE,ABILITY_PENETRATION:()=>ABILITY_PENETRATION,ABILITY_ACCURACY:()=>ABILITY_ACCURACY,getAbility:()=>getAbility,getAbilityName:()=>getAbilityName,getAbilityValue:()=>getAbilityValue});var _lookup,_abilities_ArmorAbility__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(59),_abilities_SpeedAbility__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(62),_abilities_ThrowingAbility__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63),_abilities_DodgeAbility__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(64),_abilities_PenetrationAbility__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(65),_abilities_AccuracyAbility__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(66);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ABILITY_SPEED="ABILITY_SPEED",ABILITY_THROWING="ABILITY_THROWING",ABILITY_ARMOR="ABILITY_ARMOR",ABILITY_DODGE="ABILITY_DODGE",ABILITY_PENETRATION="ABILITY_PENETRATION",ABILITY_ACCURACY="ABILITY_ACCURACY",lookup=(_defineProperty(_lookup={},ABILITY_ARMOR,new _abilities_ArmorAbility__WEBPACK_IMPORTED_MODULE_0__.default),_defineProperty(_lookup,ABILITY_SPEED,new _abilities_SpeedAbility__WEBPACK_IMPORTED_MODULE_1__.default),_defineProperty(_lookup,ABILITY_THROWING,new _abilities_ThrowingAbility__WEBPACK_IMPORTED_MODULE_2__.default),_defineProperty(_lookup,ABILITY_DODGE,new _abilities_DodgeAbility__WEBPACK_IMPORTED_MODULE_3__.default),_defineProperty(_lookup,ABILITY_PENETRATION,new _abilities_PenetrationAbility__WEBPACK_IMPORTED_MODULE_4__.default),_defineProperty(_lookup,ABILITY_ACCURACY,new _abilities_AccuracyAbility__WEBPACK_IMPORTED_MODULE_5__.default),_lookup),getAbility=function(key){return lookup[key]},getAbilityName=function(key){return lookup[key].name},getAbilityValue=function(key,entity){return lookup[key].compute(entity)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ArmorAbility});var _Abilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58),_Stats__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(60);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ArmorAbility=function(_Ability){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ArmorAbility,_Ability);var Constructor,protoProps,staticProps,_super=_createSuper(ArmorAbility);function ArmorAbility(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ArmorAbility),_super.call(this,_Abilities__WEBPACK_IMPORTED_MODULE_0__.ABILITY_ARMOR,"armor",_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_STRENGTH)}return Constructor=ArmorAbility,(protoProps=[{key:"compute",value:function(entity){return(0,_Stats__WEBPACK_IMPORTED_MODULE_1__.getStatModifier)(_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_STRENGTH,entity)+this.getModifierSum(entity)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ArmorAbility}(__webpack_require__(61).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{STAT_STRENGTH:()=>STAT_STRENGTH,STAT_FINESSE:()=>STAT_FINESSE,STAT_ATHLETICISM:()=>STAT_ATHLETICISM,STAT_TRICKERY:()=>STAT_TRICKERY,getStatName:()=>getStatName,getStatValue:()=>getStatValue,getStatModifier:()=>getStatModifier,rollStat:()=>rollStat});var _lookup,_utils_rand__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(44);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var STAT_STRENGTH=0,STAT_FINESSE=1,STAT_ATHLETICISM=2,STAT_TRICKERY=3,lookup=(_defineProperty(_lookup={},STAT_STRENGTH,{name:"strength"}),_defineProperty(_lookup,STAT_FINESSE,{name:"finesse"}),_defineProperty(_lookup,STAT_ATHLETICISM,{name:"athleticism"}),_defineProperty(_lookup,STAT_TRICKERY,{name:"trickery"}),_lookup),getStatName=function(stat){return lookup[stat].name},getStatValue=function(stat,entity){var name=lookup[stat].name;return entity.stats[name]()},getStatModifier=function(stat,entity){var value=getStatValue(stat,entity);return Math.floor((value-10)/2)},rollStat=function(stat,entity){return getStatModifier(stat,entity)+(0,_utils_rand__WEBPACK_IMPORTED_MODULE_0__.randomInt)(1,20)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Ability});var Ability=function(){function Ability(key,name,baseStat){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Ability),_defineProperty(this,"key",-1),_defineProperty(this,"name","ability"),_defineProperty(this,"baseStat",null),this.key=key,this.name=name,this.baseStat=baseStat}var Constructor,protoProps,staticProps;return Constructor=Ability,(protoProps=[{key:"getModifiers",value:function(entity){var modifiers=[];return entity.fireEvent("query-ability-modifier-".concat(this.name),{name:this.name,modifiers}),modifiers}},{key:"getModifierSum",value:function(entity){return this.getModifiers(entity).reduce((function(sum,cur){return sum+cur.mod}),0)}},{key:"compute",value:function(entity){return 1}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Ability}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>SpeedAbility});var _Abilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var SpeedAbility=function(_Ability){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(SpeedAbility,_Ability);var Constructor,protoProps,staticProps,_super=_createSuper(SpeedAbility);function SpeedAbility(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SpeedAbility),_super.call(this,_Abilities__WEBPACK_IMPORTED_MODULE_0__.ABILITY_SPEED,"speed")}return Constructor=SpeedAbility,(protoProps=[{key:"compute",value:function(entity){return this.getModifierSum(entity)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),SpeedAbility}(__webpack_require__(61).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ThrowingAbility});var _Abilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58),_Stats__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(60);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ThrowingAbility=function(_Ability){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ThrowingAbility,_Ability);var Constructor,protoProps,staticProps,_super=_createSuper(ThrowingAbility);function ThrowingAbility(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ThrowingAbility),_super.call(this,_Abilities__WEBPACK_IMPORTED_MODULE_0__.ABILITY_THROWING,"throwing",_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_ATHLETICISM)}return Constructor=ThrowingAbility,(protoProps=[{key:"compute",value:function(entity){var base=(0,_Stats__WEBPACK_IMPORTED_MODULE_1__.getStatValue)(_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_ATHLETICISM,entity),modifier=this.getModifierSum(entity);return Math.floor((base+modifier)/2)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ThrowingAbility}(__webpack_require__(61).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>DodgeAbility});var _Abilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58),_Stats__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(60);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var DodgeAbility=function(_Ability){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DodgeAbility,_Ability);var Constructor,protoProps,staticProps,_super=_createSuper(DodgeAbility);function DodgeAbility(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DodgeAbility),_super.call(this,_Abilities__WEBPACK_IMPORTED_MODULE_0__.ABILITY_DODGE,"dodge",_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_FINESSE)}return Constructor=DodgeAbility,(protoProps=[{key:"compute",value:function(entity){return(0,_Stats__WEBPACK_IMPORTED_MODULE_1__.getStatModifier)(_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_FINESSE,entity)+this.getModifierSum(entity)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),DodgeAbility}(__webpack_require__(61).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>PenetrationAbility});var _Abilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58),_Stats__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(60);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var PenetrationAbility=function(_Ability){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(PenetrationAbility,_Ability);var Constructor,protoProps,staticProps,_super=_createSuper(PenetrationAbility);function PenetrationAbility(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PenetrationAbility),_super.call(this,_Abilities__WEBPACK_IMPORTED_MODULE_0__.ABILITY_PENETRATION,"dodge",_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_STRENGTH)}return Constructor=PenetrationAbility,(protoProps=[{key:"compute",value:function(entity){return(0,_Stats__WEBPACK_IMPORTED_MODULE_1__.getStatModifier)(_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_STRENGTH,entity)+this.getModifierSum(entity)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),PenetrationAbility}(__webpack_require__(61).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>AccuracyAbility});var _Abilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58),_Stats__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(60);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var AccuracyAbility=function(_Ability){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(AccuracyAbility,_Ability);var Constructor,protoProps,staticProps,_super=_createSuper(AccuracyAbility);function AccuracyAbility(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AccuracyAbility),_super.call(this,_Abilities__WEBPACK_IMPORTED_MODULE_0__.ABILITY_ACCURACY,"accuracy",_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_FINESSE)}return Constructor=AccuracyAbility,(protoProps=[{key:"compute",value:function(entity){return(0,_Stats__WEBPACK_IMPORTED_MODULE_1__.getStatModifier)(_Stats__WEBPACK_IMPORTED_MODULE_1__.STAT_FINESSE,entity)+this.getModifierSum(entity)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),AccuracyAbility}(__webpack_require__(61).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";var _colorMap,_glyphMap;function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CURSOR_SEGMENT_UNKNOWN:()=>CURSOR_SEGMENT_UNKNOWN,CURSOR_SEGMENT_INVALID:()=>CURSOR_SEGMENT_INVALID,CURSOR_SEGMENT_NONE:()=>CURSOR_SEGMENT_NONE,CURSOR_SEGMENT_INTEREST:()=>CURSOR_SEGMENT_INTEREST,getCursorSegmentTypeColor:()=>getCursorSegmentTypeColor,getCursorSegmentTypeGlyph:()=>getCursorSegmentTypeGlyph});var CURSOR_SEGMENT_UNKNOWN=0,CURSOR_SEGMENT_INVALID=1,CURSOR_SEGMENT_NONE=2,CURSOR_SEGMENT_INTEREST=3,colorMap=(_defineProperty(_colorMap={},CURSOR_SEGMENT_UNKNOWN,"#444"),_defineProperty(_colorMap,CURSOR_SEGMENT_INVALID,"#ce5454"),_defineProperty(_colorMap,CURSOR_SEGMENT_INTEREST,"#66a3dc"),_colorMap),glyphMap=(_defineProperty(_glyphMap={},CURSOR_SEGMENT_UNKNOWN,"·"),_defineProperty(_glyphMap,CURSOR_SEGMENT_INVALID,"·"),_defineProperty(_glyphMap,CURSOR_SEGMENT_INTEREST,"•"),_glyphMap),getCursorSegmentTypeColor=function(type){return colorMap[type]},getCursorSegmentTypeGlyph=function(type){return glyphMap[type]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{bresenhamLine:()=>bresenhamLine,bresenhamLineExclusive:()=>bresenhamLineExclusive});var bresenhamLine=function(x0,y0,x1,y1){for(var dx=Math.abs(x1-x0),dy=Math.abs(y1-y0),sx=x0<x1?1:-1,sy=y0<y1?1:-1,result=[],err=dx-dy;result.push({x:x0,y:y0}),x0!==x1||y0!==y1;){var e2=2*err;e2>-dy&&(err-=dy,x0+=sx),e2<dx&&(err+=dx,y0+=sy)}return result},bresenhamLineExclusive=function(x0,y0,x1,y1){var line=bresenhamLine(x0,y0,x1,y1);return line.shift(),line.pop(),line}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Body:()=>Body});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_data_Spawnables__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25),_data_Spawner__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(26);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Body=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Body,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Body);function Body(){return _classCallCheck(this,Body),_super.apply(this,arguments)}return Constructor=Body,(protoProps=[{key:"onDeath",value:function(evt){if(this.entity.has("Position")){var pos=this.entity.position.getPos(),corpse=(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_2__.spawn)(this.corpseSpawnable,pos.x,pos.y);this.entity.has("Moniker")&&(corpse.moniker.name="".concat(this.entity.moniker.name," corpse"))}}},{key:"onProjectileHit",value:function(evt){evt.data.stopProjectile=!0}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Body}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);obj=Body,key="properties",value={corpseSpawnable:_data_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_CORPSE},key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IsVisible:()=>IsVisible});var obj,key,value,IsVisible=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(IsVisible,_Component);var _super=_createSuper(IsVisible);function IsVisible(){return _classCallCheck(this,IsVisible),_super.apply(this,arguments)}return IsVisible}(__webpack_require__(22).Component);value={amount:0,range:0},(key="properties")in(obj=IsVisible)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FragileGlass:()=>FragileGlass});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_data_Spawnables__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25),_data_Spawner__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26),_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(72),_IsDestroying__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(23),_LiquidContainer__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(24);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var FragileGlass=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(FragileGlass,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(FragileGlass);function FragileGlass(){return _classCallCheck(this,FragileGlass),_super.apply(this,arguments)}return Constructor=FragileGlass,(protoProps=[{key:"shatter",value:function(x,y){(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_3__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_2__.SPWN_GLASS_SHARD,x,y,{stackable:{quantity:3}}),this.entity.has(_LiquidContainer__WEBPACK_IMPORTED_MODULE_6__.LiquidContainer)?this.entity.liquidContainer.pour(x,y)&&_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_4__.CONSOLE_EVENT_SHATTER,{target:this.entity,liquid:this.entity.liquidContainer.content}):_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_4__.CONSOLE_EVENT_SHATTER,{target:this.entity}),this.entity.add(_IsDestroying__WEBPACK_IMPORTED_MODULE_5__.IsDestroying)}},{key:"onCollideGround",value:function(evt){this.shatter(evt.data.x,evt.data.y)}},{key:"onCollide",value:function(evt){this.shatter(evt.data.x,evt.data.y)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),FragileGlass}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CONSOLE_EVENT_DAMAGE:()=>CONSOLE_EVENT_DAMAGE,CONSOLE_EVENT_DEAD:()=>CONSOLE_EVENT_DEAD,CONSOLE_EVENT_SHATTER:()=>CONSOLE_EVENT_SHATTER,CONSOLE_EVENT_MISS:()=>CONSOLE_EVENT_MISS,CONSOLE_EVENT_BLOCK:()=>CONSOLE_EVENT_BLOCK,getMessage:()=>getMessage,shouldAppear:()=>shouldAppear});var _mapping,_data_DamageTypes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(73),_ecs_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_LiquidTypes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(28);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var CONSOLE_EVENT_DAMAGE=0,CONSOLE_EVENT_DEAD=1,CONSOLE_EVENT_SHATTER=2,CONSOLE_EVENT_MISS=3,CONSOLE_EVENT_BLOCK=4,getMonikerSubject=function(entity){return entity.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Moniker)?"The ".concat(entity.moniker.simpleDisplay.toLowerCase()):"The thing"},getMonikerIndirectObject=function(entity){return entity.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsPlayer)?"you":entity.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Moniker)?"the ".concat(entity.moniker.simpleDisplay.toLowerCase()):void 0},mapping=(_defineProperty(_mapping={},CONSOLE_EVENT_MISS,{message:function(data){var attacker=getMonikerIndirectObject(data.attacker),defender=getMonikerSubject(data.defender);return"".concat(defender," dodges an attack from ").concat(attacker," (").concat(data.dodge," > ").concat(data.accuracy,")")},shouldAppear:function(data){return data.defender.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsPlayer)||data.attacker.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsVisible)}}),_defineProperty(_mapping,CONSOLE_EVENT_BLOCK,{message:function(data){var attacker=getMonikerSubject(data.attacker),defender=getMonikerIndirectObject(data.defender);return"".concat(attacker," fails to penetrate ").concat(defender,"'s armor (").concat(data.armor," > ").concat(data.penetration,")")},shouldAppear:function(data){return data.defender.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsPlayer)||data.attacker.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsVisible)}}),_defineProperty(_mapping,CONSOLE_EVENT_DAMAGE,{message:function(data){var source=getMonikerSubject(data.source),dmgVerb=(0,_data_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.getDmgTypeVerb)(data.damageType),target=getMonikerIndirectObject(data.target),dmg=data.damage,item=data.sourceItem.toLowerCase();return"".concat(source," ").concat(dmgVerb," ").concat(target," with a ").concat(item," for ").concat(dmg," hp")},shouldAppear:function(data){return data.target.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsPlayer)||data.target.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsVisible)}}),_defineProperty(_mapping,CONSOLE_EVENT_DEAD,{message:function(data){var source=getMonikerSubject(data.source),dmgVerb=(0,_data_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.getDmgTypeVerb)(data.damageType),target=getMonikerIndirectObject(data.target);return"".concat(source," ").concat(dmgVerb," ").concat(target," to death")},shouldAppear:function(data){return data.target.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsPlayer)||data.target.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsVisible)}}),_defineProperty(_mapping,CONSOLE_EVENT_SHATTER,{message:function(data){return isNaN(data.liquid)?"".concat(getMonikerSubject(data.target)," shatters!"):"".concat(getMonikerSubject(data.target)," shatters and spills its ").concat(_LiquidTypes__WEBPACK_IMPORTED_MODULE_2__.liquids[data.liquid].colorDesc," content!")},shouldAppear:function(data){return data.target.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsVisible)}}),_mapping),getMessage=function(evt,data){return mapping[evt].message(data)},shouldAppear=function(evt,data){return mapping[evt].shouldAppear(data)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";var _lookup;function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DMG_TYPE_BLUDGEONING:()=>DMG_TYPE_BLUDGEONING,DMG_TYPE_PIERCING:()=>DMG_TYPE_PIERCING,DMG_TYPE_SLASHING:()=>DMG_TYPE_SLASHING,getDmgTypeName:()=>getDmgTypeName,getDmgTypeVerb:()=>getDmgTypeVerb});var DMG_TYPE_BLUDGEONING=0,DMG_TYPE_PIERCING=1,DMG_TYPE_SLASHING=2,lookup=(_defineProperty(_lookup={},DMG_TYPE_BLUDGEONING,{name:"Bludgeoning",verb:"bludgeons"}),_defineProperty(_lookup,DMG_TYPE_PIERCING,{name:"Piercing",verb:"pierces"}),_defineProperty(_lookup,DMG_TYPE_SLASHING,{name:"Slashing",verb:"slashes"}),_lookup),getDmgTypeName=function(type){return lookup[type].name},getDmgTypeVerb=function(type){return lookup[type].verb}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Brain:()=>Brain});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_ai_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Brain=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Brain,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Brain);function Brain(){return _classCallCheck(this,Brain),_super.apply(this,arguments)}return Constructor=Brain,(protoProps=[{key:"onDestroyed",value:function(){this.goals.forEach((function(entity){entity.destroy()}))}},{key:"onTakeAction",value:function(evt){for(;this.peekGoal()&&this.peekGoal().isFinished();)this.popGoal().entity.destroy();var currentGoal=this.peekGoal(),result=currentGoal.takeAction();result===_ai_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.FAILURE?this.removeGoal(currentGoal):result===_ai_GoalActionResult__WEBPACK_IMPORTED_MODULE_1__.INVALID&&(this.removeGoal(currentGoal),this.entity.fireEvent("take-action")),evt.handle()}},{key:"removeGoal",value:function(goal){var goalsToDestroy=[];this.goals=this.goals.filter((function(g){var isSelf=Boolean(g.id===goal.entity.id),isSiblingGoal=Boolean(g.goal.originalIntent&&g.goal.originalIntent.id===goal.originalIntent.id);return!isSelf&&!isSiblingGoal||(goalsToDestroy.push(g.goal),!1)})),goalsToDestroy.forEach((function(g){return g.entity.destroy()}))}},{key:"pushGoal",value:function(goal){if(!(goal instanceof geotic__WEBPACK_IMPORTED_MODULE_0__.Component))throw new Error("Pushing non-component goal!",goal);return goal.parent=this.entity,this.goals.push(goal.entity)}},{key:"popGoal",value:function(){return this.goals.pop().goal}},{key:"peekGoal",value:function(){return this.goals[this.goals.length-1].goal}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Brain}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={goals:"<EntityArray>"},(key="properties")in(obj=Brain)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Goal:()=>Goal});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_ai_GoalEvaluator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(76);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Goal=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Goal,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Goal);function Goal(){return _classCallCheck(this,Goal),_super.apply(this,arguments)}return Constructor=Goal,(protoProps=[{key:"isFinished",value:function(){return _ai_GoalEvaluator__WEBPACK_IMPORTED_MODULE_1__.isFinished(this.parent,this)}},{key:"takeAction",value:function(){return _ai_GoalEvaluator__WEBPACK_IMPORTED_MODULE_1__.takeAction(this.parent,this)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Goal}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={name:"Bored",originalIntent:"<Entity>",parent:"<Entity>",target:"<Entity>",complete:!1,data:{}},(key="properties")in(obj=Goal)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{isFinished:()=>isFinished,takeAction:()=>takeAction});var _GoalTypes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(32),goalTypeMap={};Object.values(_GoalTypes__WEBPACK_IMPORTED_MODULE_0__).forEach((function(goalType){goalTypeMap[goalType.name]=goalType}));var getGoalType=function(name){var type=goalTypeMap[name];return type||console.warn("GoalType (".concat(name,") not found!")),type},isFinished=function(entity,goal){return getGoalType(goal.name).isFinished(entity,goal)},takeAction=function(entity,goal){return getGoalType(goal.name).takeAction(entity,goal)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Moniker:()=>Moniker});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_Door__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(47),_LiquidContainer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24),_Stackable__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(55);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Moniker=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Moniker,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Moniker);function Moniker(){return _classCallCheck(this,Moniker),_super.apply(this,arguments)}return Constructor=Moniker,(protoProps=[{key:"simpleDisplay",get:function(){return this.name}},{key:"display",get:function(){if(this.entity.has(_LiquidContainer__WEBPACK_IMPORTED_MODULE_2__.LiquidContainer)){var disp=this.entity.liquidContainer.display;return"".concat(this.name," ").concat(disp)}if(this.entity.has(_Stackable__WEBPACK_IMPORTED_MODULE_3__.Stackable)){var _disp=this.entity.stackable.display;return"".concat(this.name," ").concat(_disp)}if(this.entity.has(_Door__WEBPACK_IMPORTED_MODULE_1__.Door)){var _disp2=this.entity.door.display;return"".concat(this.name," ").concat(_disp2)}return this.name}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Moniker}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={name:"Unknown"},(key="properties")in(obj=Moniker)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Logger:()=>Logger});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_Moniker__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(77);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Logger=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Logger,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Logger);function Logger(){return _classCallCheck(this,Logger),_super.apply(this,arguments)}return Constructor=Logger,(protoProps=[{key:"onLog",value:function(evt){console.log("[".concat(this.moniker,"]"),evt.data),evt.handle()}},{key:"moniker",get:function(){return this.entity.has(_Moniker__WEBPACK_IMPORTED_MODULE_1__.Moniker)?this.entity.moniker.display:"Unknown"}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Logger}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Position:()=>Position});var Position=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Position,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Position);function Position(){return _classCallCheck(this,Position),_super.apply(this,arguments)}return Constructor=Position,(protoProps=[{key:"getPos",value:function(){return window.game.map.getPosition(this.entity.id)}},{key:"setPos",value:function(x,y){return window.game.map.setPosition(x,y,this.entity.id)}},{key:"equals",value:function(x,y){var pos=this.getPos();return pos.x===x&&pos.y===y}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Position}(__webpack_require__(22).Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Glyph:()=>Glyph});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_LiquidContainer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(24);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Glyph=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Glyph,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Glyph);function Glyph(){return _classCallCheck(this,Glyph),_super.apply(this,arguments)}return Constructor=Glyph,(protoProps=[{key:"primary",get:function(){if(this.entity.has(_LiquidContainer__WEBPACK_IMPORTED_MODULE_1__.LiquidContainer)){var col=this.entity.liquidContainer.primaryColorOverride;if(col)return col}return this.fg1}},{key:"secondary",get:function(){if(this.entity.has(_LiquidContainer__WEBPACK_IMPORTED_MODULE_1__.LiquidContainer)){var col=this.entity.liquidContainer.secondaryColorOverride;if(col)return col}return this.fg2}},{key:"background",get:function(){return this.bg}},{key:"char",get:function(){return this.ch}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Glyph}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={fg1:"#ddd",fg2:"#666",bg:null,ch:"?"},(key="properties")in(obj=Glyph)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Legs:()=>Legs});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_data_Abilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(58),_Blocker__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(48);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Legs=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Legs,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Legs);function Legs(){return _classCallCheck(this,Legs),_super.apply(this,arguments)}return Constructor=Legs,(protoProps=[{key:"onTryMove",value:function(evt){var _this=this,position=this.entity.position.getPos(),targetX=position.x+evt.data.x,targetY=position.y+evt.data.y,targetTileEntities=_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.map.getEntitiesAt(targetX,targetY);if(!targetTileEntities.some((function(entity){return entity.has(_Blocker__WEBPACK_IMPORTED_MODULE_3__.Blocker)}))){var nonHostile=targetTileEntities.find((function(entity){return entity.factionMember&&!_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.factions.areEntitiesHostile(entity,_this.entity)}));nonHostile&&nonHostile.position.setPos(position.x,position.y);var cost=1/(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_2__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_2__.ABILITY_SPEED,this.entity)*1e3;this.entity.fireEvent("energy-consumed",cost),this.entity.position.setPos(targetX,targetY),evt.handle()}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Legs}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MoveCommand:()=>MoveCommand});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_enums_Directions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,MoveCommand=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MoveCommand,_Component);var _super=_createSuper(MoveCommand);function MoveCommand(){return _classCallCheck(this,MoveCommand),_super.apply(this,arguments)}return MoveCommand}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);obj=MoveCommand,key="properties",value={direction:_enums_Directions__WEBPACK_IMPORTED_MODULE_1__.DIR_Z},key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DIR_NW:()=>DIR_NW,DIR_N:()=>DIR_N,DIR_NE:()=>DIR_NE,DIR_W:()=>DIR_W,DIR_Z:()=>DIR_Z,DIR_E:()=>DIR_E,DIR_SW:()=>DIR_SW,DIR_S:()=>DIR_S,DIR_SE:()=>DIR_SE,shortName:()=>shortName,fullName:()=>fullName,delta:()=>delta});var directions=[{key:0,shortName:"NW",fullName:"Northwest",delta:{x:-1,y:-1}},{key:1,shortName:"N",fullName:"North",delta:{x:0,y:-1}},{key:2,shortName:"NE",fullName:"Northeast",delta:{x:1,y:-1}},{key:3,shortName:"W",fullName:"West",delta:{x:-1,y:0}},{key:4,shortName:"Z",fullName:"Here",delta:{x:0,y:0}},{key:5,shortName:"E",fullName:"East",delta:{x:1,y:0}},{key:6,shortName:"SW",fullName:"Southwest",delta:{x:-1,y:1}},{key:7,shortName:"S",fullName:"South",delta:{x:0,y:1}},{key:8,shortName:"SE",fullName:"Southeast",delta:{x:1,y:1}}],DIR_NW=0,DIR_N=1,DIR_NE=2,DIR_W=3,DIR_Z=4,DIR_E=5,DIR_SW=6,DIR_S=7,DIR_SE=8,shortName=function(direction){return directions[direction].shortName},fullName=function(direction){return directions[direction].fullName},delta=function(direction){return directions[direction].delta}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MeleeCommand:()=>MeleeCommand});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22);__webpack_require__(83);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,MeleeCommand=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MeleeCommand,_Component);var _super=_createSuper(MeleeCommand);function MeleeCommand(){return _classCallCheck(this,MeleeCommand),_super.apply(this,arguments)}return MeleeCommand}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={target:"<Entity>"},(key="properties")in(obj=MeleeCommand)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IsPlayer:()=>IsPlayer});var IsPlayer=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(IsPlayer,_Component);var _super=_createSuper(IsPlayer);function IsPlayer(){return _classCallCheck(this,IsPlayer),_super.apply(this,arguments)}return IsPlayer}(__webpack_require__(22).Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Wandering:()=>Wandering});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_ai_GoalTypes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(32),_enums_Directions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(83);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Wandering=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Wandering,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Wandering);function Wandering(){return _classCallCheck(this,Wandering),_super.apply(this,arguments)}return Constructor=Wandering,(protoProps=[{key:"onBoredom",value:function(evt){if(!(Math.random()>.5)){var direction=Math.floor(9*Math.random()),delta=_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.delta(direction);evt.data.goal=_ai_GoalTypes__WEBPACK_IMPORTED_MODULE_1__.MoveGoalType.create({data:delta}),evt.handle()}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Wandering}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Explorable:()=>Explorable});var Explorable=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Explorable,_Component);var _super=_createSuper(Explorable);function Explorable(){return _classCallCheck(this,Explorable),_super.apply(this,arguments)}return Explorable}(__webpack_require__(22).Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Explored:()=>Explored});var Explored=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Explored,_Component);var _super=_createSuper(Explored);function Explored(){return _classCallCheck(this,Explored),_super.apply(this,arguments)}return Explored}(__webpack_require__(22).Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Health:()=>Health});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_data_Abilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(58),_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(72),_utils_rand__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(44),_IsDead__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(90);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Health=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Health,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Health);function Health(){return _classCallCheck(this,Health),_super.apply(this,arguments)}return Constructor=Health,(protoProps=[{key:"onAttacked",value:function(evt){var attacker=evt.data.attacker,defender=this.entity;console.log("Begin Attack (".concat(attacker.moniker.display," → ").concat(defender.moniker.display,")"));var accuracy=evt.data.accuracy,penetration=evt.data.penetration,damage=evt.data.damage,armor=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_2__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_2__.ABILITY_ARMOR,defender)+(0,_utils_rand__WEBPACK_IMPORTED_MODULE_4__.randomInt)(1,20),dodge=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_2__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_2__.ABILITY_DODGE,defender)+(0,_utils_rand__WEBPACK_IMPORTED_MODULE_4__.randomInt)(1,20),health=this.value;if(console.log("- Accuracy (".concat(accuracy,") vs Dodge (").concat(dodge,")")),console.log("- Penetration (".concat(penetration,") vs Armor (").concat(armor,")")),console.log("- Damage (".concat(damage,") vs Health (").concat(health,")")),dodge>accuracy)return console.log("- ".concat(defender.moniker.display," DODGE!")),void _core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_3__.CONSOLE_EVENT_MISS,{defender,attacker,dodge,accuracy});if(armor>penetration)return console.log("- ".concat(defender.moniker.display," BLOCKS!")),void _core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_3__.CONSOLE_EVENT_BLOCK,{defender,attacker,armor,penetration});if(console.log("- HIT! ".concat(damage)),console.log("End Attack"),this.value-=damage,this.value<=0)_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_3__.CONSOLE_EVENT_DEAD,{target:defender,source:attacker,sourceItem:evt.data.weaponName,damage,damageType:evt.data.damageType}),this.value=0,this.entity.add(_IsDead__WEBPACK_IMPORTED_MODULE_5__.IsDead);else{_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_3__.CONSOLE_EVENT_DAMAGE,{target:defender,source:attacker,sourceItem:evt.data.weaponName,damage,damageType:evt.data.damageType});var pos=this.entity.position.getPos();_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.particles.createParticle(pos.x,pos.y,{lifetime:140,fg1s:["#8d4c4f","#730d14"],glyphs:["*"]})}evt.handle()}},{key:"onDamage",value:function(evt){if(this.value-=evt.data.damage.value,this.value<=0)_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_3__.CONSOLE_EVENT_DEAD,{target:this.entity,source:evt.data.source,sourceItem:evt.data.sourceItem,damage:evt.data.damage}),this.value=0,this.entity.add(_IsDead__WEBPACK_IMPORTED_MODULE_5__.IsDead);else{_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.console.event(_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_3__.CONSOLE_EVENT_DAMAGE,{target:this.entity,source:evt.data.source,sourceItem:evt.data.sourceItem,damage:evt.data.damage});var pos=this.entity.position.getPos();_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.particles.createParticle(pos.x,pos.y,{lifetime:140,fg1s:["#8d4c4f","#730d14"],glyphs:["*"]})}evt.handle()}},{key:"onHeal",value:function(evt){this.value+=evt.data.value,this.value>this.max&&(this.value=this.max),evt.handle()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Health}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={value:10,max:10},(key="properties")in(obj=Health)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IsDead:()=>IsDead});var IsDead=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(IsDead,_Component);var _super=_createSuper(IsDead);function IsDead(){return _classCallCheck(this,IsDead),_super.apply(this,arguments)}return IsDead}(__webpack_require__(22).Component)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FactionMember:()=>FactionMember});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_enums_Factions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(92);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,FactionMember=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(FactionMember,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(FactionMember);function FactionMember(){return _classCallCheck(this,FactionMember),_super.apply(this,arguments)}return Constructor=FactionMember,(protoProps=[{key:"faction",get:function(){return(0,_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.getFactionByName)(this.name)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),FactionMember}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={name:"Neutral"},(key="properties")in(obj=FactionMember)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FACTION_PLAYER:()=>FACTION_PLAYER,FACTION_VILLAGER:()=>FACTION_VILLAGER,FACTION_GOBLIN:()=>FACTION_GOBLIN,FACTION_NATURE:()=>FACTION_NATURE,factions:()=>factions,getFactionByName:()=>getFactionByName});var _data_Faction__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(93),FACTION_PLAYER=0,FACTION_VILLAGER=1,FACTION_GOBLIN=2,FACTION_NATURE=3,factions={player:new _data_Faction__WEBPACK_IMPORTED_MODULE_0__.default({id:FACTION_PLAYER,name:"player",display:"Player"}),villager:new _data_Faction__WEBPACK_IMPORTED_MODULE_0__.default({id:FACTION_VILLAGER,name:"villager",display:"Villager"}),goblin:new _data_Faction__WEBPACK_IMPORTED_MODULE_0__.default({id:FACTION_GOBLIN,name:"goblin",display:"Goblin"}),nature:new _data_Faction__WEBPACK_IMPORTED_MODULE_0__.default({id:FACTION_NATURE,name:"nature",display:"Nature"})},getFactionByName=function(name){return factions[name]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Faction});var Faction=function Faction(properties){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Faction),_defineProperty(this,"id",0),_defineProperty(this,"name","faction"),_defineProperty(this,"display","Faction"),this.id=properties.id,this.name=properties.name,this.display=properties.display}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Eyes:()=>Eyes});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_utils_BresenhamLine__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(68),_Shadowcaster__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(49);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Eyes=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Eyes,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Eyes);function Eyes(){return _classCallCheck(this,Eyes),_super.apply(this,arguments)}return Constructor=Eyes,(protoProps=[{key:"canSee",value:function(entity){var start=this.entity.position.getPos(),end=entity.position.getPos(),line=(0,_utils_BresenhamLine__WEBPACK_IMPORTED_MODULE_2__.bresenhamLine)(start.x,start.y,end.x,end.y);return!(line.length>this.range||line.some((function(segment){return _core_Game__WEBPACK_IMPORTED_MODULE_1__.game.map.getEntitiesAt(segment.x,segment.y).some((function(entity){return entity.has(_Shadowcaster__WEBPACK_IMPORTED_MODULE_3__.Shadowcaster)}))})))}},{key:"onTryDetectHostiles",value:function(evt){var _this=this,position=_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.map.getPosition(this.entity.id);if(position){var targets=_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.map.getEntitiesInRange(position.x,position.y,this.range).filter((function(e){return!!e.actor&&!!_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.factions.areEntitiesHostile(_this.entity,e)&&_this.canSee(e)}));targets.length>0&&(targets.forEach((function(e){evt.data.targets.add(e)})),evt.handle())}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Eyes}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={range:5},(key="properties")in(obj=Eyes)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Particle:()=>Particle});var obj,key,value,Particle=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Particle,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Particle);function Particle(){return _classCallCheck(this,Particle),_super.apply(this,arguments)}return Constructor=Particle,(protoProps=[{key:"frame",value:function(){var arr=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],len=arr.length,chunks=1/len;return Math.trunc(this.percent/chunks)}},{key:"isExpired",get:function(){return this.age>=this.lifetime}},{key:"percent",get:function(){return this.age/this.lifetime}},{key:"glyph",get:function(){var frame=this.frame(this.glyphs);return this.glyphs[frame]}},{key:"fg1",get:function(){var frame=this.frame(this.fg1s);return this.fg1s[frame]}},{key:"fg2",get:function(){var frame=this.frame(this.fg2s);return this.fg2s[frame]}},{key:"bg",get:function(){var frame=this.frame(this.bgs);return this.bgs[frame]}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Particle}(__webpack_require__(22).Component);value={lifetime:200,fg1s:["#8d4c4f","#730d14"],fg2s:[],bgs:[],glyphs:["·"],speed:.05,age:0,x:0,y:0,startX:0,startY:0,direction:{x:0,y:0}},(key="properties")in(obj=Particle)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ParticleEmitter:()=>ParticleEmitter});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_Particle__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(95);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ParticleEmitter=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ParticleEmitter,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(ParticleEmitter);function ParticleEmitter(){return _classCallCheck(this,ParticleEmitter),_super.apply(this,arguments)}return Constructor=ParticleEmitter,(protoProps=[{key:"createParticle",value:function(){var particle=this.ecs.createEntity();return particle.add(_Particle__WEBPACK_IMPORTED_MODULE_1__.Particle,_objectSpread(_objectSpread({},this.particleData),{},{x:this.x,y:this.y})),this.count+=1,particle}},{key:"frame",value:function(){var arr=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],len=arr.length,chunks=1/len;return Math.trunc(this.percent/chunks)}},{key:"isExpired",get:function(){return this.age>=this.duration}},{key:"percent",get:function(){return this.age/this.duration}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ParticleEmitter}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);_defineProperty(ParticleEmitter,"properties",{particleData:{},duration:800,rate:3,age:0,x:0,y:0,count:0})},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LootDropper:()=>LootDropper});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_data_tables_LootSpawn__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(98);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,LootDropper=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(LootDropper,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(LootDropper);function LootDropper(){return _classCallCheck(this,LootDropper),_super.apply(this,arguments)}return Constructor=LootDropper,(protoProps=[{key:"onDeath",value:function(evt){var pos=this.entity.position.getPos();(0,_data_tables_LootSpawn__WEBPACK_IMPORTED_MODULE_1__.spawnLoot)(this.tables,pos.x,pos.y)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),LootDropper}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={tables:[]},(key="properties")in(obj=LootDropper)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{getTable:()=>getTable,pickLoot:()=>pickLoot,spawnLoot:()=>spawnLoot});var _utils_WeightedTable__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(99),_Spawner__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(26),_loot_LootTableGoblin__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(100),_loot_LootTableForest__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(101),tables={TBL_LOOT_GOBLIN:_loot_LootTableGoblin__WEBPACK_IMPORTED_MODULE_2__.default,TBL_LOOT_FOREST:_loot_LootTableForest__WEBPACK_IMPORTED_MODULE_3__.default},getTable=function(tableKey){return tables[tableKey]},pickLoot=function(){var tableKeys=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],tables=tableKeys.map(getTable),table=_utils_WeightedTable__WEBPACK_IMPORTED_MODULE_0__.default.combine(tables);return table.pick()},spawnLoot=function(){var tableKeys=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],x=arguments.length>1?arguments[1]:void 0,y=arguments.length>2?arguments[2]:void 0,spawnable=pickLoot(tableKeys);return(0,_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(spawnable,x,y)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>WeightedTable});var _rand__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(44);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var WeightedTable=function(){function WeightedTable(){var obj,key,value;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,WeightedTable),value=[],(key="rows")in(obj=this)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}var Constructor,protoProps,staticProps;return Constructor=WeightedTable,staticProps=[{key:"combine",value:function(){var tables=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],table=new WeightedTable;return tables.forEach((function(other){other.rows.forEach((function(row){return table.add(row.weight,row.value)}))})),table}}],(protoProps=[{key:"pick",value:function(){var r=(0,_rand__WEBPACK_IMPORTED_MODULE_0__.randomInt)(0,this.sum),currentW=0,row=this.rows.find((function(row){return(currentW+=row.weight)>=r}));if(row)return row.value}},{key:"chance",value:function(value){var row=this.get(value);return row?row.weight/this.sum:0}},{key:"get",value:function(value){return this.rows.find((function(row){return row.value===value}))}},{key:"add",value:function(weight,value){var existing=this.get(value);if(existing){var maxWeight=Math.max(existing.weight,weight);existing.weight=maxWeight}else this.rows.push({weight,value});this.rows.sort((function(a,b){return a.weight-b.weight}))}},{key:"sum",get:function(){return this.rows.reduce((function(sum,cur){return sum+cur.weight}),0)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),WeightedTable}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _utils_WeightedTable__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(99),_Spawnables__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25),goblins=new _utils_WeightedTable__WEBPACK_IMPORTED_MODULE_0__.default;goblins.add(3,_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_STONE),goblins.add(2,_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_VIAL_BLOOD),goblins.add(5,_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_AMULET),goblins.add(4,_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_CLOTH_ARMOR),goblins.add(15,_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_SHORTSWORD);const __WEBPACK_DEFAULT_EXPORT__=goblins},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _utils_WeightedTable__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(99),_Spawnables__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25),forest=new _utils_WeightedTable__WEBPACK_IMPORTED_MODULE_0__.default;forest.add(3,_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_STONE),forest.add(2,_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_VIAL_HONEY);const __WEBPACK_DEFAULT_EXPORT__=forest},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IsEquipped:()=>IsEquipped});var obj,key,value,IsEquipped=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(IsEquipped,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(IsEquipped);function IsEquipped(){return _classCallCheck(this,IsEquipped),_super.apply(this,arguments)}return Constructor=IsEquipped,(protoProps=[{key:"onDropped",value:function(evt){this.slot.unequip()}},{key:"onThrown",value:function(evt){this.slot.unequip()}},{key:"slot",get:function(){return this.owner.equipmentSlot[this.slotKey]}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),IsEquipped}(__webpack_require__(22).Component);value={slotKey:"",owner:"<Entity>"},(key="properties")in(obj=IsEquipped)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Equipment:()=>Equipment});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_core_Game__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(53),_data_EquipmentSlotType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(104),_IsEquipped__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(102);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Equipment=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Equipment,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Equipment);function Equipment(){return _classCallCheck(this,Equipment),_super.apply(this,arguments)}return Constructor=Equipment,(protoProps=[{key:"onTryEquip",value:function(evt){var _this=this,slots=Object.values(evt.data.interactor.equipmentSlot).filter((function(slot){return _this.slotTypes.includes(slot.slotType)}));_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.screens.pushScreen(_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_2__.SCREEN_LIST_SELECT,{header:"Equip ".concat(this.entity.moniker.display),list:slots,onRenderRow:function(slot,x,y,isSelected){var text=slot.name;slot.isEmpty||(text+=" [".concat(slot.content.moniker.display,"]")),isSelected?_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.renderer.drawText(x,y,"→ ".concat(text),"yellow"):_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.renderer.drawText(x,y,"- ".concat(text))},onSelect:function(slot){slot.unequip(),slot.equip(_this.entity),evt.data.interactor.fireEvent("energy-consumed",200),evt.handle(),_core_Game__WEBPACK_IMPORTED_MODULE_1__.game.screens.popScreen()}})}},{key:"onTryUnequip",value:function(evt){var slotKey=this.entity.isEquipped.slotKey,slot=evt.data.interactor.equipmentSlot[slotKey];slot&&(slot.content=null),evt.data.interactor.fireEvent("energy-consumed",200),this.entity.isEquipped.destroy(),evt.handle()}},{key:"onGetInteractions",value:function(evt){this.entity.isInventoried&&!this.entity.isInventoried.isOwnedBy(evt.data.interactor)||(this.entity.has(_IsEquipped__WEBPACK_IMPORTED_MODULE_4__.IsEquipped)?evt.data.interactions.push({name:"Unequip [".concat(this.entity.isEquipped.slot.name,"]"),evt:"try-unequip"}):evt.data.interactions.push({name:"Equip",evt:"try-equip"}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Equipment}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);obj=Equipment,key="properties",value={slotTypes:[_data_EquipmentSlotType__WEBPACK_IMPORTED_MODULE_3__.EQ_SLOT_BODY]},key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EQ_SLOT_NECK:()=>EQ_SLOT_NECK,EQ_SLOT_BODY:()=>EQ_SLOT_BODY,EQ_SLOT_FEET:()=>EQ_SLOT_FEET,EQ_SLOT_ARM:()=>EQ_SLOT_ARM,EQ_SLOT_HAND:()=>EQ_SLOT_HAND});var EQ_SLOT_NECK="EQ_SLOT_NECK",EQ_SLOT_BODY="EQ_SLOT_BODY",EQ_SLOT_FEET="EQ_SLOT_FEET",EQ_SLOT_ARM="EQ_SLOT_ARM",EQ_SLOT_HAND="EQ_SLOT_HAND"},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EquipmentSlot:()=>EquipmentSlot});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_data_Abilities__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(58),_data_DamageTypes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(73),_data_EquipmentSlotType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(104),_data_Stats__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(60),_utils_rand__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(44),_IsEquipped__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(102);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var EquipmentSlot=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(EquipmentSlot,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(EquipmentSlot);function EquipmentSlot(){return _classCallCheck(this,EquipmentSlot),_super.apply(this,arguments)}return Constructor=EquipmentSlot,(protoProps=[{key:"onDestroyed",value:function(){this.isEmpty||this.content.destroy()}},{key:"unequip",value:function(){if(this.isEmpty)return!1;var content=this.content;this.content=null,content.isEquipped.destroy(),content.fireEvent("unequipped",{interactor:this.entity})}},{key:"equip",value:function(equipment){equipment.add(_IsEquipped__WEBPACK_IMPORTED_MODULE_6__.IsEquipped,{slotKey:this.key,owner:this.entity}),this.content=equipment,equipment.fireEvent("equipped",{interactor:this.entity})}},{key:"onTryMelee",value:function(evt){if(this.isPrimary){var map=window.game.map,targetPos=evt.data.target.position.getPos(),selfPos=this.entity.position.getPos();if(map.isAdjacent(selfPos.x,selfPos.y,targetPos.x,targetPos.y)){if(this.isEmpty)return evt.data.target.fireEvent("attacked",{attacker:this.entity,weaponName:(0,_utils_rand__WEBPACK_IMPORTED_MODULE_5__.pickRandom)(["punch","kick"]),type:this.damageType,damage:(0,_data_Stats__WEBPACK_IMPORTED_MODULE_4__.getStatModifier)(_data_Stats__WEBPACK_IMPORTED_MODULE_4__.STAT_ATHLETICISM,this.entity),penetration:4+(0,_data_Stats__WEBPACK_IMPORTED_MODULE_4__.rollStat)(_data_Stats__WEBPACK_IMPORTED_MODULE_4__.STAT_STRENGTH,this.entity),accuracy:(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_1__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_1__.ABILITY_ACCURACY,this.entity),damageType:_data_DamageTypes__WEBPACK_IMPORTED_MODULE_2__.DMG_TYPE_BLUDGEONING}),this.entity.fireEvent("energy-consumed",800),void evt.handle();this.content.fireEvent("try-use-melee",{interactor:this.entity,target:evt.data.target}),evt.handle()}}}},{key:"onQueryAbilityModifierArmor",value:function(evt){this.isEmpty||this.content.fireEvent("query-equipped-ability-modifier-".concat(evt.data.name),{name:evt.data.name,modifiers:evt.data.modifiers})}},{key:"isEmpty",get:function(){return!this.content}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),EquipmentSlot}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);_defineProperty(EquipmentSlot,"allowMultiple",!0),_defineProperty(EquipmentSlot,"keyProperty","key"),_defineProperty(EquipmentSlot,"properties",{name:"Body",key:"body",slotType:_data_EquipmentSlotType__WEBPACK_IMPORTED_MODULE_3__.EQ_SLOT_BODY,content:"<Entity>",isPrimary:!1,isOffhand:!1})},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Stats:()=>Stats});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),rot_js_lib_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(107),_data_Stats__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(60);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Stats=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Stats,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Stats);function Stats(){return _classCallCheck(this,Stats),_super.apply(this,arguments)}return Constructor=Stats,(protoProps=[{key:"_sumMods",value:function(modifiers){return modifiers.reduce((function(sum,cur){return sum+cur.mod}),0)}},{key:"getStatModifiers",value:function(stat){var name=(0,_data_Stats__WEBPACK_IMPORTED_MODULE_2__.getStatName)(stat),modifiers=[];return this.entity.fireEvent("query-stat-modifier-".concat(name),{modifiers}),modifiers}},{key:"getStatModifierSum",value:function(stat){var mods=this.getStatModifiers(stat);return this._sumMods(mods)}},{key:"data",value:function(stat){var name=(0,_data_Stats__WEBPACK_IMPORTED_MODULE_2__.getStatName)(stat),modifiers=this.getStatModifiers(stat),base=this["base".concat((0,rot_js_lib_util__WEBPACK_IMPORTED_MODULE_1__.capitalize)(name))],modSum=this._sumMods(modifiers);return{stat,name,modifiers,base,sum:base+modSum,modSum}}},{key:"all",value:function(){return{strength:this.data(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_STRENGTH),finesse:this.data(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_FINESSE),athleticism:this.data(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_ATHLETICISM),trickery:this.data(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_TRICKERY)}}},{key:"strength",value:function(){var mod=this.getStatModifierSum(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_STRENGTH);return this.baseStrength+mod}},{key:"finesse",value:function(){var mod=this.getStatModifierSum(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_FINESSE);return this.baseFinesse+mod}},{key:"athleticism",value:function(){var mod=this.getStatModifierSum(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_ATHLETICISM);return this.baseAthleticism+mod}},{key:"trickery",value:function(){var mod=this.getStatModifierSum(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_TRICKERY);return this.baseTrickery+mod}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Stats}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={baseStrength:10,baseFinesse:10,baseAthleticism:10,baseTrickery:10},(key="properties")in(obj=Stats)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function mod(x,n){return(x%n+n)%n}function clamp(val){var min=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,max=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return val<min?min:val>max?max:val}function capitalize(string){return string.charAt(0).toUpperCase()+string.substring(1)}function format(template){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];var map=format.map,replacer=function(match,group1,group2,index){if("%"==template.charAt(index-1))return match.substring(1);if(!args.length)return match;var obj=args[0],parts=(group1||group2).split(","),name=parts.shift()||"",method=map[name.toLowerCase()];if(!method)return match;var replaced=(obj=args.shift())[method].apply(obj,parts),first=name.charAt(0);return first!=first.toLowerCase()&&(replaced=capitalize(replaced)),replaced};return template.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,replacer)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{mod:()=>mod,clamp:()=>clamp,capitalize:()=>capitalize,format:()=>format}),format.map={s:"toString"}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Race:()=>Race});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_data_Races__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(109);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Race=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Race,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Race);function Race(){return _classCallCheck(this,Race),_super.apply(this,arguments)}return Constructor=Race,(protoProps=[{key:"data",value:function(){return(0,_data_Races__WEBPACK_IMPORTED_MODULE_1__.getRaceData)(this.key)}},{key:"onQueryStatModifierStrength",value:function(evt){var mod=this.strengthMod;0!==mod&&evt.data.modifiers.push({source:this.name,mod})}},{key:"onQueryStatModifierFinesse",value:function(evt){var mod=this.finesseMod;0!==mod&&evt.data.modifiers.push({source:this.name,mod})}},{key:"onQueryStatModifierAthleticism",value:function(evt){var mod=this.athleticismMod;0!==mod&&evt.data.modifiers.push({source:this.name,mod})}},{key:"onQueryStatModifierTrickery",value:function(evt){var mod=this.trickeryMod;0!==mod&&evt.data.modifiers.push({source:this.name,mod})}},{key:"onQueryAbilityModifierSpeed",value:function(evt){evt.data.modifiers.push({source:this.name,mod:this.speed})}},{key:"name",get:function(){return this.data().name}},{key:"speed",get:function(){return this.data().speed}},{key:"strengthMod",get:function(){return this.data().modStrength}},{key:"finesseMod",get:function(){return this.data().modFinesse}},{key:"athleticismMod",get:function(){return this.data().modAthleticism}},{key:"trickeryMod",get:function(){return this.data().modTrickery}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Race}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);obj=Race,key="properties",value={key:_data_Races__WEBPACK_IMPORTED_MODULE_1__.RACE_HUMAN},key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RACE_HUMAN:()=>RACE_HUMAN,RACE_GOBLIN:()=>RACE_GOBLIN,getRaceData:()=>getRaceData});var _lookup,_RaceData__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(110);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var RACE_HUMAN="RACE_HUMAN",RACE_GOBLIN="RACE_GOBLIN",lookup=(_defineProperty(_lookup={},RACE_HUMAN,new _RaceData__WEBPACK_IMPORTED_MODULE_0__.default({name:"Human",key:RACE_HUMAN,speed:1.2,modStrength:1,modFinesse:1,modAthleticism:1,modTrickery:1})),_defineProperty(_lookup,RACE_GOBLIN,new _RaceData__WEBPACK_IMPORTED_MODULE_0__.default({name:"Goblin",key:RACE_GOBLIN,speed:1,modStrength:-1,modFinesse:2,modAthleticism:1,modTrickery:2})),_lookup),getRaceData=function(name){return lookup[name]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>RaceData});var RaceData=function RaceData(data){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RaceData),_defineProperty(this,"name",""),_defineProperty(this,"speed",1),_defineProperty(this,"key",1),_defineProperty(this,"modStrength",0),_defineProperty(this,"modFinesse",0),_defineProperty(this,"modAthleticism",0),_defineProperty(this,"modTrickery",0),this.name=data.name||"",this.speed=data.speed||1,this.key=data.key,this.modStrength=data.modStrength||0,this.modFinesse=data.modFinesse||0,this.modAthleticism=data.modAthleticism||0,this.modTrickery=data.modTrickery||0}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Weapon:()=>Weapon});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_data_Abilities__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(58),_data_Stats__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(60),_data_WeaponTypes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(112),_utils_rand__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(44);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var obj,key,value,Weapon=function(_Component){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Weapon,_Component);var Constructor,protoProps,staticProps,_super=_createSuper(Weapon);function Weapon(){return _classCallCheck(this,Weapon),_super.apply(this,arguments)}return Constructor=Weapon,(protoProps=[{key:"onTryUseMelee",value:function(evt){evt.data.target.fireEvent("attacked",{attacker:evt.data.interactor,weaponName:this.name,damageType:this.damageType,damage:(0,_utils_rand__WEBPACK_IMPORTED_MODULE_4__.randomInt)(1,5)+3,penetration:(0,_data_Stats__WEBPACK_IMPORTED_MODULE_2__.rollStat)(_data_Stats__WEBPACK_IMPORTED_MODULE_2__.STAT_STRENGTH,evt.data.interactor)+this.penetration,accuracy:(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_1__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_1__.ABILITY_ACCURACY,evt.data.interactor)+(0,_utils_rand__WEBPACK_IMPORTED_MODULE_4__.randomInt)(1,20)}),evt.data.interactor.fireEvent("energy-consumed",800),evt.handle()}},{key:"name",get:function(){return(0,_data_WeaponTypes__WEBPACK_IMPORTED_MODULE_3__.getWeaponTypeName)(this.weaponType)}},{key:"family",get:function(){return(0,_data_WeaponTypes__WEBPACK_IMPORTED_MODULE_3__.getWeaponTypeFamily)(this.weaponType)}},{key:"damageType",get:function(){return(0,_data_WeaponTypes__WEBPACK_IMPORTED_MODULE_3__.getWeaponTypeDmgType)(this.weaponType)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Weapon}(geotic__WEBPACK_IMPORTED_MODULE_0__.Component);value={weaponType:"WPN_TYPE_DAGGER",dmgRoll:"",penetration:4},(key="properties")in(obj=Weapon)?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WPN_TYPE_WAR_HAMMER:()=>WPN_TYPE_WAR_HAMMER,WPN_TYPE_SLEDGE_HAMMER:()=>WPN_TYPE_SLEDGE_HAMMER,WPN_TYPE_CLUB:()=>WPN_TYPE_CLUB,WPN_TYPE_MACE:()=>WPN_TYPE_MACE,WPN_TYPE_HEAVY_AXE:()=>WPN_TYPE_HEAVY_AXE,WPN_TYPE_HATCHET:()=>WPN_TYPE_HATCHET,WPN_TYPE_LONGSWORD:()=>WPN_TYPE_LONGSWORD,WPN_TYPE_SHORTSWORD:()=>WPN_TYPE_SHORTSWORD,WPN_TYPE_DAGGER:()=>WPN_TYPE_DAGGER,WPN_TYPE_STAFF:()=>WPN_TYPE_STAFF,WPN_TYPE_HALBERD:()=>WPN_TYPE_HALBERD,WPN_TYPE_JAVELIN:()=>WPN_TYPE_JAVELIN,getWeaponType:()=>getWeaponType,getWeaponTypeName:()=>getWeaponTypeName,getWeaponTypeFamily:()=>getWeaponTypeFamily,getWeaponTypeDmgType:()=>getWeaponTypeDmgType});var _lookup,_DamageTypes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(73),_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(113);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var WPN_TYPE_WAR_HAMMER="WPN_TYPE_WAR_HAMMER",WPN_TYPE_SLEDGE_HAMMER="WPN_TYPE_SLEDGE_HAMMER",WPN_TYPE_CLUB="WPN_TYPE_CLUB",WPN_TYPE_MACE="WPN_TYPE_MACE",WPN_TYPE_HEAVY_AXE="WPN_TYPE_HEAVY_AXE",WPN_TYPE_HATCHET="WPN_TYPE_HATCHET",WPN_TYPE_LONGSWORD="WPN_TYPE_LONGSWORD",WPN_TYPE_SHORTSWORD="WPN_TYPE_SHORTSWORD",WPN_TYPE_DAGGER="WPN_TYPE_DAGGER",WPN_TYPE_STAFF="WPN_TYPE_STAFF",WPN_TYPE_HALBERD="WPN_TYPE_HALBERD",WPN_TYPE_JAVELIN="WPN_TYPE_JAVELIN",lookup=(_defineProperty(_lookup={},WPN_TYPE_WAR_HAMMER,{name:"War hammer",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_HAMMER,key:WPN_TYPE_WAR_HAMMER,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_BLUDGEONING}),_defineProperty(_lookup,WPN_TYPE_SLEDGE_HAMMER,{name:"Sledge hammer",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_HAMMER,key:WPN_TYPE_SLEDGE_HAMMER,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_BLUDGEONING}),_defineProperty(_lookup,WPN_TYPE_CLUB,{name:"Club",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_HAMMER,key:WPN_TYPE_CLUB,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_BLUDGEONING}),_defineProperty(_lookup,WPN_TYPE_MACE,{name:"Mace",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_HAMMER,key:WPN_TYPE_MACE,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_BLUDGEONING}),_defineProperty(_lookup,WPN_TYPE_HEAVY_AXE,{name:"Heavy axe",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_AXE,key:WPN_TYPE_HEAVY_AXE,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_SLASHING}),_defineProperty(_lookup,WPN_TYPE_HATCHET,{name:"Hatchet",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_AXE,key:WPN_TYPE_HATCHET,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_SLASHING}),_defineProperty(_lookup,WPN_TYPE_LONGSWORD,{name:"Longsword",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_BLADE,key:WPN_TYPE_LONGSWORD,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_SLASHING}),_defineProperty(_lookup,WPN_TYPE_SHORTSWORD,{name:"Shortsword",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_BLADE,key:WPN_TYPE_SHORTSWORD,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_SLASHING}),_defineProperty(_lookup,WPN_TYPE_DAGGER,{name:"Dagger",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_BLADE,key:WPN_TYPE_DAGGER,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_SLASHING}),_defineProperty(_lookup,WPN_TYPE_STAFF,{name:"Staff",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_POLEARM,key:WPN_TYPE_STAFF,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_BLUDGEONING}),_defineProperty(_lookup,WPN_TYPE_HALBERD,{name:"Halberd",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_POLEARM,key:WPN_TYPE_HALBERD,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_PIERCING}),_defineProperty(_lookup,WPN_TYPE_JAVELIN,{name:"Javelin",family:_WeaponFamilies__WEBPACK_IMPORTED_MODULE_1__.WPN_FAMILY_POLEARM,key:WPN_TYPE_JAVELIN,damageType:_DamageTypes__WEBPACK_IMPORTED_MODULE_0__.DMG_TYPE_PIERCING}),_lookup),getWeaponType=function(type){return lookup[type]},getWeaponTypeName=function(type){return lookup[type].name},getWeaponTypeFamily=function(type){return lookup[type].family},getWeaponTypeDmgType=function(type){return lookup[type].damageType}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";var _lookup;function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WPN_FAMILY_HAMMER:()=>WPN_FAMILY_HAMMER,WPN_FAMILY_AXE:()=>WPN_FAMILY_AXE,WPN_FAMILY_BLADE:()=>WPN_FAMILY_BLADE,WPN_FAMILY_ARCHERY:()=>WPN_FAMILY_ARCHERY,WPN_FAMILY_POLEARM:()=>WPN_FAMILY_POLEARM,getWeaponFamilyName:()=>getWeaponFamilyName});var WPN_FAMILY_HAMMER="WPN_FAMILY_HAMMER",WPN_FAMILY_AXE="WPN_FAMILY_AXE",WPN_FAMILY_BLADE="WPN_FAMILY_BLADE",WPN_FAMILY_ARCHERY="WPN_FAMILY_ARCHERY",WPN_FAMILY_POLEARM="WPN_FAMILY_POLEARM",lookup=(_defineProperty(_lookup={},WPN_FAMILY_HAMMER,{name:"Hammer"}),_defineProperty(_lookup,WPN_FAMILY_AXE,{name:"Axe"}),_defineProperty(_lookup,WPN_FAMILY_BLADE,{name:"Blade"}),_defineProperty(_lookup,WPN_FAMILY_ARCHERY,{name:"Archery"}),_defineProperty(_lookup,WPN_FAMILY_POLEARM,{name:"Polearm"}),_lookup),getWeaponFamilyName=function(family){return lookup[family].name}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>System});var _game=new WeakMap,System=function(){function System(game){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,System),_game.set(this,{writable:!0,value:null}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_game,game)}return _createClass(System,[{key:"game",get:function(){return function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}(this,_game)}}]),_createClass(System,[{key:"update",value:function(dt){}}]),System}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>RenderSystem});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_System__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}var _query=new WeakMap,_explored=new WeakMap,RenderSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(RenderSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(RenderSystem);function RenderSystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RenderSystem),_this=_super.call(this,game),_query.set(_assertThisInitialized(_this),{writable:!0,value:null}),_explored.set(_assertThisInitialized(_this),{writable:!0,value:null}),_classPrivateFieldSet(_assertThisInitialized(_this),_query,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Glyph,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Position,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsVisible],none:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsInventoried,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsDestroying]})),_classPrivateFieldSet(_assertThisInitialized(_this),_explored,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Glyph,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Position,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Explored],none:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsInventoried,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsVisible,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsDestroying]})),_this}return Constructor=RenderSystem,(protoProps=[{key:"render",value:function(dt){this.game.renderer.clear();for(var explored=Array.from(_classPrivateFieldGet(this,_explored).get()),i=0;i<explored.length;i++){var renderable=explored[i],pos=renderable.position.getPos();if(this.game.camera.isInView(pos.x,pos.y)){var screen=this.game.camera.worldToScreen(pos.x,pos.y);this.game.renderer.draw(screen.x,screen.y,renderable.glyph.char,"#2c3538","#2c3538")}}for(var renderables=Array.from(_classPrivateFieldGet(this,_query).get()),_i=0;_i<renderables.length;_i++){var _renderable=renderables[_i],_pos=_renderable.position.getPos();if(this.game.camera.isInView(_pos.x,_pos.y)){var _screen=this.game.camera.worldToScreen(_pos.x,_pos.y);this.game.renderer.draw(_screen.x,_screen.y,_renderable.glyph.char,_renderable.glyph.primary,_renderable.glyph.secondary,_renderable.glyph.background)}}}},{key:"update",value:function(dt){this.render()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),RenderSystem}(_System__WEBPACK_IMPORTED_MODULE_1__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>MovementSystem});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_enums_Directions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83),_System__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var _query=new WeakMap,MovementSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MovementSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(MovementSystem);function MovementSystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MovementSystem),_this=_super.call(this,game),_query.set(_assertThisInitialized(_this),{writable:!0,value:null}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_query,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.MoveCommand,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Position],none:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsDestroying]})),_this}return Constructor=MovementSystem,(protoProps=[{key:"update",value:function(dt){(function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value})(this,_query).get().forEach((function(entity){var delta=_enums_Directions__WEBPACK_IMPORTED_MODULE_1__.delta(entity.moveCommand.direction);entity.fireEvent("try-move",delta),entity.moveCommand.destroy()}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),MovementSystem}(_System__WEBPACK_IMPORTED_MODULE_2__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>UISystem});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_System__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var _query=new WeakMap,UISystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(UISystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(UISystem);function UISystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UISystem),_this=_super.call(this,game),_query.set(_assertThisInitialized(_this),{writable:!0,value:null}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_query,_this.game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Moniker,_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Actor]})),_this}return Constructor=UISystem,(protoProps=[{key:"update",value:function(dt){var turn=this.game.clock.turn,subTurn="".concat(this.game.clock.subTurn.toFixed(0)).padEnd(3,"0"),str="".concat(turn,".").concat(subTurn),len=Math.ceil(this.game.renderer.computeTextWidth(str));this.game.renderer.drawText(this.game.camera.width-1-len,1,str);var hp=this.game.player.entity.health;this.game.renderer.drawText(1,1,"".concat(hp.value,"/").concat(hp.max),"#ce5454")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),UISystem}(_System__WEBPACK_IMPORTED_MODULE_1__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>MouseManager});var _Manager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _x=new WeakMap,_y=new WeakMap,_hasMouse=new WeakMap,MouseManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MouseManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(MouseManager);function MouseManager(){var _this;_classCallCheck(this,MouseManager);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_x.set(_assertThisInitialized(_this),{writable:!0,value:0}),_y.set(_assertThisInitialized(_this),{writable:!0,value:0}),_hasMouse.set(_assertThisInitialized(_this),{writable:!0,value:!1}),_this}return Constructor=MouseManager,(protoProps=[{key:"updatePosition",value:function(x,y){_classPrivateFieldSet(this,_x,Math.max(0,x)),_classPrivateFieldSet(this,_y,Math.max(0,y))}},{key:"updateMouseEnter",value:function(){_classPrivateFieldSet(this,_hasMouse,!0)}},{key:"updateMouseLeave",value:function(){_classPrivateFieldSet(this,_hasMouse,!1)}},{key:"x",get:function(){return _classPrivateFieldGet(this,_x)}},{key:"y",get:function(){return _classPrivateFieldGet(this,_y)}},{key:"hasMouse",get:function(){return _classPrivateFieldGet(this,_hasMouse)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),MouseManager}(_Manager__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CommandManager});var _InputDomainType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(120),_commands__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(121),_Manager__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}var _commands=new WeakMap,_domainStack=new WeakMap,_isEnabled=new WeakMap,CommandManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CommandManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(CommandManager);function CommandManager(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CommandManager),_this=_super.call(this,game),_commands.set(_assertThisInitialized(_this),{writable:!0,value:{}}),_domainStack.set(_assertThisInitialized(_this),{writable:!0,value:[_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT]}),_isEnabled.set(_assertThisInitialized(_this),{writable:!0,value:!0}),_commands__WEBPACK_IMPORTED_MODULE_1__.default.forEach((function(cmd){return _this.registerCommand(cmd)})),_this}return Constructor=CommandManager,(protoProps=[{key:"disable",value:function(){_classPrivateFieldSet(this,_isEnabled,!1)}},{key:"enable",value:function(){_classPrivateFieldSet(this,_isEnabled,!0)}},{key:"onInputEvent",value:function(evt){var cmd=this.getCommandForInputEvent(evt);cmd&&this.game.screens.onInputCommand(cmd)}},{key:"pushDomain",value:function(domain){_classPrivateFieldGet(this,_domainStack).push(domain)}},{key:"popDomain",value:function(domain){var index=_classPrivateFieldGet(this,_domainStack).lastIndexOf(domain);index>-1&&_classPrivateFieldGet(this,_domainStack).splice(index,1)}},{key:"getDomainCommands",value:function(domain){return _classPrivateFieldGet(this,_commands)[domain]||[]}},{key:"getCommandForInputEvent",value:function(evt){for(var i=_classPrivateFieldGet(this,_domainStack).length-1;i>=0;i--){var domain=_classPrivateFieldGet(this,_domainStack)[i],cmd=this.getDomainCommands(domain).find((function(cmd){return cmd.matches(evt)}));if(cmd)return cmd}}},{key:"registerCommand",value:function(command){_classPrivateFieldGet(this,_commands)[command.domain]||(_classPrivateFieldGet(this,_commands)[command.domain]=[]),_classPrivateFieldGet(this,_commands)[command.domain].push(command)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CommandManager}(_Manager__WEBPACK_IMPORTED_MODULE_2__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{INPUT_DOMAIN_DEFAULT:()=>INPUT_DOMAIN_DEFAULT,INPUT_DOMAIN_MAIN_MENU:()=>INPUT_DOMAIN_MAIN_MENU,INPUT_DOMAIN_ADVENTURE:()=>INPUT_DOMAIN_ADVENTURE,INPUT_DOMAIN_LOOK:()=>INPUT_DOMAIN_LOOK,INPUT_DOMAIN_LIST:()=>INPUT_DOMAIN_LIST});var INPUT_DOMAIN_DEFAULT=0,INPUT_DOMAIN_MAIN_MENU=1,INPUT_DOMAIN_ADVENTURE=2,INPUT_DOMAIN_LOOK=3,INPUT_DOMAIN_LIST=4},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _InputDomainType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(120),_InputCommand__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(122),_InputCommandType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(123),_KeyCodes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(124),cmd=function(domain,type,name,isKeyboard,key,shift,ctrl,alt,meta){return new _InputCommand__WEBPACK_IMPORTED_MODULE_1__.default({domain,type,name,isKeyboard,key,shift,ctrl,alt,meta})};const __WEBPACK_DEFAULT_EXPORT__=[cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_CONFIRM,"confirm",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_ENTER,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_CONFIRM,"confirm2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_SPACE,!1,!0,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_CANCEL,"cancel",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_ESCAPE,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_MAIN_MENU,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SAVE,"save",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_S,!1,!0,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_MAIN_MENU,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_LOAD,"load",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_L,!1,!0,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_MAIN_MENU,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_NEW_GAME,"new game",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_N,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_ADVENTURE,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_WAIT,"wait",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_S,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_NW,"move nw",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_Q,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_N,"move n",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_W,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_N,"move n2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_UP,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_NE,"move ne",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_E,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_W,"move w",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_A,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_W,"move w2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_LEFT,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_E,"move e",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_D,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_E,"move e2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_RIGHT,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_SW,"move sw",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_Z,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_S,"move s",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_X,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_S,"move s2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_DOWN,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_MOVE_SE,"move se",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_C,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_NW,"select nw",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_Q,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_N,"select n",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_W,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_N,"select n2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_UP,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_NE,"select ne",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_E,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_W,"select w",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_A,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_W,"select w2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_LEFT,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_E,"select e",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_D,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_E,"select e2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_RIGHT,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_SW,"select sw",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_Z,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_S,"select s",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_X,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_S,"select s2",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_DOWN,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_SELECT_SE,"select se",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_C,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_DEFAULT,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_INTERACT,"select",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_S,!0,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_ADVENTURE,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_LOOK,"look",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_L,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_ADVENTURE,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_PICK_UP,"pick up",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_G,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_ADVENTURE,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_INTERACT,"interact",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_J,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_ADVENTURE,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_INVENTORY,"inventory",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_I,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_ADVENTURE,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_EQUIPMENT,"equipment",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_P,!1,!1,!1,!1),cmd(_InputDomainType__WEBPACK_IMPORTED_MODULE_0__.INPUT_DOMAIN_ADVENTURE,_InputCommandType__WEBPACK_IMPORTED_MODULE_2__.INPUT_CMD_CHARACTER,"character",!0,_KeyCodes__WEBPACK_IMPORTED_MODULE_3__.KEY_Y,!1,!1,!1,!1)]},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>InputCommand});var _events_InputEvent__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var InputCommand=function(){function InputCommand(data){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,InputCommand),this.domain=data.domain,this.type=data.type,this.name=data.name,this.isKeyboard=data.isKeyboard,this.key=data.key,this.shift=data.shift,this.ctrl=data.ctrl,this.alt=data.alt,this.meta=data.meta}var Constructor,protoProps,staticProps;return Constructor=InputCommand,(protoProps=[{key:"matches",value:function(inputEvent){var isKeyboard=inputEvent instanceof _events_InputEvent__WEBPACK_IMPORTED_MODULE_0__.default;return this.isKeyboard==isKeyboard&&this.key==inputEvent.key&&this.shift==inputEvent.shift&&this.ctrl==inputEvent.ctrl&&this.alt==inputEvent.alt&&this.meta==inputEvent.meta}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),InputCommand}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{INPUT_CMD_MOVE_NW:()=>INPUT_CMD_MOVE_NW,INPUT_CMD_MOVE_N:()=>INPUT_CMD_MOVE_N,INPUT_CMD_MOVE_NE:()=>INPUT_CMD_MOVE_NE,INPUT_CMD_MOVE_W:()=>INPUT_CMD_MOVE_W,INPUT_CMD_MOVE_E:()=>INPUT_CMD_MOVE_E,INPUT_CMD_MOVE_SW:()=>INPUT_CMD_MOVE_SW,INPUT_CMD_MOVE_S:()=>INPUT_CMD_MOVE_S,INPUT_CMD_MOVE_SE:()=>INPUT_CMD_MOVE_SE,INPUT_CMD_WAIT:()=>INPUT_CMD_WAIT,INPUT_CMD_CONFIRM:()=>INPUT_CMD_CONFIRM,INPUT_CMD_CANCEL:()=>INPUT_CMD_CANCEL,INPUT_CMD_SAVE:()=>INPUT_CMD_SAVE,INPUT_CMD_LOAD:()=>INPUT_CMD_LOAD,INPUT_CMD_LOOK:()=>INPUT_CMD_LOOK,INPUT_CMD_PICK_UP:()=>INPUT_CMD_PICK_UP,INPUT_CMD_INTERACT:()=>INPUT_CMD_INTERACT,INPUT_CMD_INVENTORY:()=>INPUT_CMD_INVENTORY,INPUT_CMD_SELECT_NW:()=>INPUT_CMD_SELECT_NW,INPUT_CMD_SELECT_N:()=>INPUT_CMD_SELECT_N,INPUT_CMD_SELECT_NE:()=>INPUT_CMD_SELECT_NE,INPUT_CMD_SELECT_W:()=>INPUT_CMD_SELECT_W,INPUT_CMD_SELECT_E:()=>INPUT_CMD_SELECT_E,INPUT_CMD_SELECT_SW:()=>INPUT_CMD_SELECT_SW,INPUT_CMD_SELECT_S:()=>INPUT_CMD_SELECT_S,INPUT_CMD_SELECT_SE:()=>INPUT_CMD_SELECT_SE,INPUT_CMD_NEW_GAME:()=>INPUT_CMD_NEW_GAME,INPUT_CMD_EQUIPMENT:()=>INPUT_CMD_EQUIPMENT,INPUT_CMD_CHARACTER:()=>INPUT_CMD_CHARACTER});var INPUT_CMD_MOVE_NW=0,INPUT_CMD_MOVE_N=1,INPUT_CMD_MOVE_NE=2,INPUT_CMD_MOVE_W=3,INPUT_CMD_MOVE_E=4,INPUT_CMD_MOVE_SW=5,INPUT_CMD_MOVE_S=6,INPUT_CMD_MOVE_SE=7,INPUT_CMD_WAIT=8,INPUT_CMD_CONFIRM=9,INPUT_CMD_CANCEL=10,INPUT_CMD_SAVE=11,INPUT_CMD_LOAD=12,INPUT_CMD_LOOK=13,INPUT_CMD_PICK_UP=16,INPUT_CMD_INTERACT=17,INPUT_CMD_INVENTORY=19,INPUT_CMD_SELECT_NW=20,INPUT_CMD_SELECT_N=21,INPUT_CMD_SELECT_NE=22,INPUT_CMD_SELECT_W=23,INPUT_CMD_SELECT_E=24,INPUT_CMD_SELECT_SW=25,INPUT_CMD_SELECT_S=26,INPUT_CMD_SELECT_SE=27,INPUT_CMD_NEW_GAME=28,INPUT_CMD_EQUIPMENT=29,INPUT_CMD_CHARACTER=30},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{KEY_CANCEL:()=>KEY_CANCEL,KEY_HELP:()=>KEY_HELP,KEY_BACK_SPACE:()=>KEY_BACK_SPACE,KEY_TAB:()=>KEY_TAB,KEY_CLEAR:()=>KEY_CLEAR,KEY_ENTER:()=>KEY_ENTER,KEY_ENTER_SPECIAL:()=>KEY_ENTER_SPECIAL,KEY_SHIFT:()=>KEY_SHIFT,KEY_CONTROL:()=>KEY_CONTROL,KEY_ALT:()=>KEY_ALT,KEY_PAUSE:()=>KEY_PAUSE,KEY_CAPS_LOCK:()=>KEY_CAPS_LOCK,KEY_KANA:()=>KEY_KANA,KEY_EISU:()=>KEY_EISU,KEY_JUNJA:()=>KEY_JUNJA,KEY_FINAL:()=>KEY_FINAL,KEY_HANJA:()=>KEY_HANJA,KEY_ESCAPE:()=>KEY_ESCAPE,KEY_CONVERT:()=>KEY_CONVERT,KEY_NONCONVERT:()=>KEY_NONCONVERT,KEY_ACCEPT:()=>KEY_ACCEPT,KEY_MODECHANGE:()=>KEY_MODECHANGE,KEY_SPACE:()=>KEY_SPACE,KEY_PAGE_UP:()=>KEY_PAGE_UP,KEY_PAGE_DOWN:()=>KEY_PAGE_DOWN,KEY_END:()=>KEY_END,KEY_HOME:()=>KEY_HOME,KEY_LEFT:()=>KEY_LEFT,KEY_UP:()=>KEY_UP,KEY_RIGHT:()=>KEY_RIGHT,KEY_DOWN:()=>KEY_DOWN,KEY_SELECT:()=>KEY_SELECT,KEY_PRINT:()=>KEY_PRINT,KEY_EXECUTE:()=>KEY_EXECUTE,KEY_PRINTSCREEN:()=>KEY_PRINTSCREEN,KEY_INSERT:()=>KEY_INSERT,KEY_DELETE:()=>KEY_DELETE,KEY_NUM_0:()=>KEY_NUM_0,KEY_NUM_1:()=>KEY_NUM_1,KEY_NUM_2:()=>KEY_NUM_2,KEY_NUM_3:()=>KEY_NUM_3,KEY_NUM_4:()=>KEY_NUM_4,KEY_NUM_5:()=>KEY_NUM_5,KEY_NUM_6:()=>KEY_NUM_6,KEY_NUM_7:()=>KEY_NUM_7,KEY_NUM_8:()=>KEY_NUM_8,KEY_NUM_9:()=>KEY_NUM_9,KEY_COLON:()=>KEY_COLON,KEY_SEMICOLON:()=>KEY_SEMICOLON,KEY_LESS_THAN:()=>KEY_LESS_THAN,KEY_EQUALS:()=>KEY_EQUALS,KEY_GREATER_THAN:()=>KEY_GREATER_THAN,KEY_QUESTION_MARK:()=>KEY_QUESTION_MARK,KEY_AT:()=>KEY_AT,KEY_A:()=>KEY_A,KEY_B:()=>KEY_B,KEY_C:()=>KEY_C,KEY_D:()=>KEY_D,KEY_E:()=>KEY_E,KEY_F:()=>KEY_F,KEY_G:()=>KEY_G,KEY_H:()=>KEY_H,KEY_I:()=>KEY_I,KEY_J:()=>KEY_J,KEY_K:()=>KEY_K,KEY_L:()=>KEY_L,KEY_M:()=>KEY_M,KEY_N:()=>KEY_N,KEY_O:()=>KEY_O,KEY_P:()=>KEY_P,KEY_Q:()=>KEY_Q,KEY_R:()=>KEY_R,KEY_S:()=>KEY_S,KEY_T:()=>KEY_T,KEY_U:()=>KEY_U,KEY_V:()=>KEY_V,KEY_W:()=>KEY_W,KEY_X:()=>KEY_X,KEY_Y:()=>KEY_Y,KEY_Z:()=>KEY_Z,KEY_META:()=>KEY_META,KEY_CONTEXT_MENU:()=>KEY_CONTEXT_MENU,KEY_SLEEP:()=>KEY_SLEEP,KEY_NUMPAD_0:()=>KEY_NUMPAD_0,KEY_NUMPAD_1:()=>KEY_NUMPAD_1,KEY_NUMPAD_2:()=>KEY_NUMPAD_2,KEY_NUMPAD_3:()=>KEY_NUMPAD_3,KEY_NUMPAD_4:()=>KEY_NUMPAD_4,KEY_NUMPAD_5:()=>KEY_NUMPAD_5,KEY_NUMPAD_6:()=>KEY_NUMPAD_6,KEY_NUMPAD_7:()=>KEY_NUMPAD_7,KEY_NUMPAD_8:()=>KEY_NUMPAD_8,KEY_NUMPAD_9:()=>KEY_NUMPAD_9,KEY_MULTIPLY:()=>KEY_MULTIPLY,KEY_ADD:()=>KEY_ADD,KEY_SEPARATOR:()=>KEY_SEPARATOR,KEY_SUBTRACT:()=>KEY_SUBTRACT,KEY_DECIMAL:()=>KEY_DECIMAL,KEY_DIVIDE:()=>KEY_DIVIDE,KEY_F1:()=>KEY_F1,KEY_F2:()=>KEY_F2,KEY_F3:()=>KEY_F3,KEY_F4:()=>KEY_F4,KEY_F5:()=>KEY_F5,KEY_F6:()=>KEY_F6,KEY_F7:()=>KEY_F7,KEY_F8:()=>KEY_F8,KEY_F9:()=>KEY_F9,KEY_F10:()=>KEY_F10,KEY_F11:()=>KEY_F11,KEY_F12:()=>KEY_F12,KEY_F13:()=>KEY_F13,KEY_F14:()=>KEY_F14,KEY_F15:()=>KEY_F15,KEY_F16:()=>KEY_F16,KEY_F17:()=>KEY_F17,KEY_F18:()=>KEY_F18,KEY_F19:()=>KEY_F19,KEY_F20:()=>KEY_F20,KEY_F21:()=>KEY_F21,KEY_F22:()=>KEY_F22,KEY_F23:()=>KEY_F23,KEY_F24:()=>KEY_F24,KEY_NUM_LOCK:()=>KEY_NUM_LOCK,KEY_SCROLL_LOCK:()=>KEY_SCROLL_LOCK,KEY_WIN_OEM_FJ_JISHO:()=>KEY_WIN_OEM_FJ_JISHO,KEY_WIN_OEM_FJ_MASSHOU:()=>KEY_WIN_OEM_FJ_MASSHOU,KEY_WIN_OEM_FJ_TOUROKU:()=>KEY_WIN_OEM_FJ_TOUROKU,KEY_WIN_OEM_FJ_LOYA:()=>KEY_WIN_OEM_FJ_LOYA,KEY_WIN_OEM_FJ_ROYA:()=>KEY_WIN_OEM_FJ_ROYA,KEY_CIRCUMFLEX:()=>KEY_CIRCUMFLEX,KEY_EXCLAMATION:()=>KEY_EXCLAMATION,KEY_DOUBLE_QUOTE:()=>KEY_DOUBLE_QUOTE,KEY_HASH:()=>KEY_HASH,KEY_DOLLAR:()=>KEY_DOLLAR,KEY_PERCENT:()=>KEY_PERCENT,KEY_AMPERSAND:()=>KEY_AMPERSAND,KEY_UNDERSCORE:()=>KEY_UNDERSCORE,KEY_OPEN_PAREN:()=>KEY_OPEN_PAREN,KEY_CLOSE_PAREN:()=>KEY_CLOSE_PAREN,KEY_ASTERISK:()=>KEY_ASTERISK,KEY_PLUS:()=>KEY_PLUS,KEY_PIPE:()=>KEY_PIPE,KEY_HYPHEN_MINUS:()=>KEY_HYPHEN_MINUS,KEY_OPEN_CURLY_BRACKET:()=>KEY_OPEN_CURLY_BRACKET,KEY_CLOSE_CURLY_BRACKET:()=>KEY_CLOSE_CURLY_BRACKET,KEY_TILDE:()=>KEY_TILDE,KEY_VOLUME_MUTE:()=>KEY_VOLUME_MUTE,KEY_VOLUME_DOWN:()=>KEY_VOLUME_DOWN,KEY_VOLUME_UP:()=>KEY_VOLUME_UP,KEY_SEMICOLON_2:()=>KEY_SEMICOLON_2,KEY_EQUALS_2:()=>KEY_EQUALS_2,KEY_COMMA:()=>KEY_COMMA,KEY_MINUS:()=>KEY_MINUS,KEY_PERIOD:()=>KEY_PERIOD,KEY_SLASH:()=>KEY_SLASH,KEY_BACK_QUOTE:()=>KEY_BACK_QUOTE,KEY_OPEN_BRACKET:()=>KEY_OPEN_BRACKET,KEY_BACK_SLASH:()=>KEY_BACK_SLASH,KEY_CLOSE_BRACKET:()=>KEY_CLOSE_BRACKET,KEY_QUOTE:()=>KEY_QUOTE,KEY_META_2:()=>KEY_META_2,KEY_ALTGR:()=>KEY_ALTGR,KEY_WIN_ICO_HELP:()=>KEY_WIN_ICO_HELP,KEY_WIN_ICO_00:()=>KEY_WIN_ICO_00,KEY_WIN_ICO_CLEAR:()=>KEY_WIN_ICO_CLEAR,KEY_WIN_OEM_RESET:()=>KEY_WIN_OEM_RESET,KEY_WIN_OEM_JUMP:()=>KEY_WIN_OEM_JUMP,KEY_WIN_OEM_PA1:()=>KEY_WIN_OEM_PA1,KEY_WIN_OEM_PA2:()=>KEY_WIN_OEM_PA2,KEY_WIN_OEM_PA3:()=>KEY_WIN_OEM_PA3,KEY_WIN_OEM_WSCTRL:()=>KEY_WIN_OEM_WSCTRL,KEY_WIN_OEM_CUSEL:()=>KEY_WIN_OEM_CUSEL,KEY_WIN_OEM_ATTN:()=>KEY_WIN_OEM_ATTN,KEY_WIN_OEM_FINISH:()=>KEY_WIN_OEM_FINISH,KEY_WIN_OEM_COPY:()=>KEY_WIN_OEM_COPY,KEY_WIN_OEM_AUTO:()=>KEY_WIN_OEM_AUTO,KEY_WIN_OEM_ENLW:()=>KEY_WIN_OEM_ENLW,KEY_WIN_OEM_BACKTAB:()=>KEY_WIN_OEM_BACKTAB,KEY_ATTN:()=>KEY_ATTN,KEY_CRSEL:()=>KEY_CRSEL,KEY_EXSEL:()=>KEY_EXSEL,KEY_EREOF:()=>KEY_EREOF,KEY_PLAY:()=>KEY_PLAY,KEY_ZOOM:()=>KEY_ZOOM,KEY_PA1:()=>KEY_PA1,KEY_WIN_OEM_CLEAR:()=>KEY_WIN_OEM_CLEAR});var KEY_CANCEL=3,KEY_HELP=6,KEY_BACK_SPACE=8,KEY_TAB=9,KEY_CLEAR=12,KEY_ENTER=13,KEY_ENTER_SPECIAL=14,KEY_SHIFT=16,KEY_CONTROL=17,KEY_ALT=18,KEY_PAUSE=19,KEY_CAPS_LOCK=20,KEY_KANA=21,KEY_EISU=22,KEY_JUNJA=23,KEY_FINAL=24,KEY_HANJA=25,KEY_ESCAPE=27,KEY_CONVERT=28,KEY_NONCONVERT=29,KEY_ACCEPT=30,KEY_MODECHANGE=31,KEY_SPACE=32,KEY_PAGE_UP=33,KEY_PAGE_DOWN=34,KEY_END=35,KEY_HOME=36,KEY_LEFT=37,KEY_UP=38,KEY_RIGHT=39,KEY_DOWN=40,KEY_SELECT=41,KEY_PRINT=42,KEY_EXECUTE=43,KEY_PRINTSCREEN=44,KEY_INSERT=45,KEY_DELETE=46,KEY_NUM_0=48,KEY_NUM_1=49,KEY_NUM_2=50,KEY_NUM_3=51,KEY_NUM_4=52,KEY_NUM_5=53,KEY_NUM_6=54,KEY_NUM_7=55,KEY_NUM_8=56,KEY_NUM_9=57,KEY_COLON=58,KEY_SEMICOLON=59,KEY_LESS_THAN=60,KEY_EQUALS=61,KEY_GREATER_THAN=62,KEY_QUESTION_MARK=63,KEY_AT=64,KEY_A=65,KEY_B=66,KEY_C=67,KEY_D=68,KEY_E=69,KEY_F=70,KEY_G=71,KEY_H=72,KEY_I=73,KEY_J=74,KEY_K=75,KEY_L=76,KEY_M=77,KEY_N=78,KEY_O=79,KEY_P=80,KEY_Q=81,KEY_R=82,KEY_S=83,KEY_T=84,KEY_U=85,KEY_V=86,KEY_W=87,KEY_X=88,KEY_Y=89,KEY_Z=90,KEY_META=91,KEY_CONTEXT_MENU=93,KEY_SLEEP=95,KEY_NUMPAD_0=96,KEY_NUMPAD_1=97,KEY_NUMPAD_2=98,KEY_NUMPAD_3=99,KEY_NUMPAD_4=100,KEY_NUMPAD_5=101,KEY_NUMPAD_6=102,KEY_NUMPAD_7=103,KEY_NUMPAD_8=104,KEY_NUMPAD_9=105,KEY_MULTIPLY=106,KEY_ADD=107,KEY_SEPARATOR=108,KEY_SUBTRACT=109,KEY_DECIMAL=110,KEY_DIVIDE=111,KEY_F1=112,KEY_F2=113,KEY_F3=114,KEY_F4=115,KEY_F5=116,KEY_F6=117,KEY_F7=118,KEY_F8=119,KEY_F9=120,KEY_F10=121,KEY_F11=122,KEY_F12=123,KEY_F13=124,KEY_F14=125,KEY_F15=126,KEY_F16=127,KEY_F17=128,KEY_F18=129,KEY_F19=130,KEY_F20=131,KEY_F21=132,KEY_F22=133,KEY_F23=134,KEY_F24=135,KEY_NUM_LOCK=144,KEY_SCROLL_LOCK=145,KEY_WIN_OEM_FJ_JISHO=146,KEY_WIN_OEM_FJ_MASSHOU=147,KEY_WIN_OEM_FJ_TOUROKU=148,KEY_WIN_OEM_FJ_LOYA=149,KEY_WIN_OEM_FJ_ROYA=150,KEY_CIRCUMFLEX=160,KEY_EXCLAMATION=161,KEY_DOUBLE_QUOTE=162,KEY_HASH=163,KEY_DOLLAR=164,KEY_PERCENT=165,KEY_AMPERSAND=166,KEY_UNDERSCORE=167,KEY_OPEN_PAREN=168,KEY_CLOSE_PAREN=169,KEY_ASTERISK=170,KEY_PLUS=171,KEY_PIPE=172,KEY_HYPHEN_MINUS=173,KEY_OPEN_CURLY_BRACKET=174,KEY_CLOSE_CURLY_BRACKET=175,KEY_TILDE=176,KEY_VOLUME_MUTE=181,KEY_VOLUME_DOWN=182,KEY_VOLUME_UP=183,KEY_SEMICOLON_2=186,KEY_EQUALS_2=187,KEY_COMMA=188,KEY_MINUS=189,KEY_PERIOD=190,KEY_SLASH=191,KEY_BACK_QUOTE=192,KEY_OPEN_BRACKET=219,KEY_BACK_SLASH=220,KEY_CLOSE_BRACKET=221,KEY_QUOTE=222,KEY_META_2=224,KEY_ALTGR=225,KEY_WIN_ICO_HELP=227,KEY_WIN_ICO_00=228,KEY_WIN_ICO_CLEAR=230,KEY_WIN_OEM_RESET=233,KEY_WIN_OEM_JUMP=234,KEY_WIN_OEM_PA1=235,KEY_WIN_OEM_PA2=236,KEY_WIN_OEM_PA3=237,KEY_WIN_OEM_WSCTRL=238,KEY_WIN_OEM_CUSEL=239,KEY_WIN_OEM_ATTN=240,KEY_WIN_OEM_FINISH=241,KEY_WIN_OEM_COPY=242,KEY_WIN_OEM_AUTO=243,KEY_WIN_OEM_ENLW=244,KEY_WIN_OEM_BACKTAB=245,KEY_ATTN=246,KEY_CRSEL=247,KEY_EXSEL=248,KEY_EREOF=249,KEY_PLAY=250,KEY_ZOOM=251,KEY_PA1=253,KEY_WIN_OEM_CLEAR=254},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ScreenManager});var _ScreenType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(53),_screens_AdventureScreen__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(126),_screens_MainMenuScreen__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(128),_screens_DeathScreen__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(129),_Manager__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),_screens_InventoryScreen__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(130),_screens_InteractModalScreen__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(132),_screens_CursorScreen__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(133),_screens_LoadSectorScreen__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(134),_screens_EquipmentScreen__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(135),_screens_ListSelectionScreen__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(136),_screens_CharacterScreen__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(141);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _screens=new WeakMap,_screenStack=new WeakMap,ScreenManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ScreenManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(ScreenManager);function ScreenManager(game){var _classPrivateFieldSet2,_this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ScreenManager),_this=_super.call(this,game),_screens.set(_assertThisInitialized(_this),{writable:!0,value:{}}),_screenStack.set(_assertThisInitialized(_this),{writable:!0,value:[]}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_screens,(_defineProperty(_classPrivateFieldSet2={},_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_MAIN_MENU,new _screens_MainMenuScreen__WEBPACK_IMPORTED_MODULE_2__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_ADVENTURE,new _screens_AdventureScreen__WEBPACK_IMPORTED_MODULE_1__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_DEATH,new _screens_DeathScreen__WEBPACK_IMPORTED_MODULE_3__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_INVENTORY,new _screens_InventoryScreen__WEBPACK_IMPORTED_MODULE_5__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_INTERACT_MODAL,new _screens_InteractModalScreen__WEBPACK_IMPORTED_MODULE_6__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_CURSOR,new _screens_CursorScreen__WEBPACK_IMPORTED_MODULE_7__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_LOAD_SECTOR,new _screens_LoadSectorScreen__WEBPACK_IMPORTED_MODULE_8__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_EQUIPMENT,new _screens_EquipmentScreen__WEBPACK_IMPORTED_MODULE_9__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_LIST_SELECT,new _screens_ListSelectionScreen__WEBPACK_IMPORTED_MODULE_10__.default(game)),_defineProperty(_classPrivateFieldSet2,_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_CHARACTER,new _screens_CharacterScreen__WEBPACK_IMPORTED_MODULE_11__.default(game)),_classPrivateFieldSet2)),_this.setScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_MAIN_MENU),_this}return Constructor=ScreenManager,(protoProps=[{key:"setScreen",value:function(screenType){for(var ctx=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classPrivateFieldGet(this,_screenStack).length>0;)this.screen.onLeave(ctx),_classPrivateFieldGet(this,_screenStack).pop();_classPrivateFieldGet(this,_screenStack).push({type:screenType,ctx}),this.screen.onEnter(this.screenCtx)}},{key:"replaceScreen",value:function(screenType){var ctx=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.screen.onLeave(ctx),_classPrivateFieldGet(this,_screenStack).pop(),_classPrivateFieldGet(this,_screenStack).push({type:screenType,ctx}),this.screen.onEnter(this.screenCtx)}},{key:"pushScreen",value:function(screenType){var ctx=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.screen.onLeave(ctx),_classPrivateFieldGet(this,_screenStack).push({type:screenType,ctx}),this.screen.onEnter(this.screenCtx)}},{key:"popScreen",value:function(){var ctx=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.screen.onLeave(ctx),_classPrivateFieldGet(this,_screenStack).pop(),this.screen.onEnter(this.screenCtx)}},{key:"onInputCommand",value:function(cmd){this.screen.onInputCommand(cmd)}},{key:"update",value:function(dt){this.screen.onUpdate(dt)}},{key:"screenType",get:function(){return _classPrivateFieldGet(this,_screenStack)[_classPrivateFieldGet(this,_screenStack).length-1].type}},{key:"screenCtx",get:function(){return _classPrivateFieldGet(this,_screenStack)[_classPrivateFieldGet(this,_screenStack).length-1].ctx}},{key:"screen",get:function(){return _classPrivateFieldGet(this,_screens)[this.screenType]}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ScreenManager}(_Manager__WEBPACK_IMPORTED_MODULE_4__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>AdventureScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_enums_Directions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(83),_ScreenType__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(53),_ecs_components__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(20);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var AdventureScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(AdventureScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(AdventureScreen);function AdventureScreen(){return _classCallCheck(this,AdventureScreen),_super.apply(this,arguments)}return Constructor=AdventureScreen,(protoProps=[{key:"onEnter",value:function(){this.game.renderer.clear(),this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_ADVENTURE),this.game.FOVSystem.computeFOV();var position=this.game.player.position;this.game.camera.setFocus(position.x,position.y)}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_ADVENTURE)}},{key:"onDirectionInput",value:function(dir){var _this=this,delta=(0,_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.delta)(dir),playerPosition=this.game.player.position,targetPosition={x:playerPosition.x+delta.x,y:playerPosition.y+delta.y},entities=this.game.map.getEntitiesAt(targetPosition.x,targetPosition.y),hostileEntities=entities.filter((function(e){return _this.game.factions.areEntitiesHostile(e,_this.game.player.entity)}));if(hostileEntities.length>0)this.game.player.melee(hostileEntities[0]);else{var doorEntity=entities.find((function(e){return e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_5__.Door)}));doorEntity&&!doorEntity.door.isOpen?doorEntity.fireEvent("try-open-door",{interactor:this.game.player.entity}):this.game.player.move(dir)}}},{key:"onPickUpCommand",value:function(){var position=this.game.player.position,lootable=this.game.map.getEntitiesAt(position.x,position.y).find((function(entity){return entity.has(_ecs_components__WEBPACK_IMPORTED_MODULE_5__.Loot)}));lootable?lootable.fireEvent("try-pick-up",{interactor:this.game.player.entity}):console.log("there is nothing here to pick up.")}},{key:"onInteract",value:function(x,y){var _this2=this,items=this.game.map.getEntitiesAt(x,y).filter((function(e){return!e.isPlayer})).filter((function(entity){return entity.fireEvent("get-interactions",{interactor:_this2.game.player.entity,interactions:[]}).data.interactions.length>0}));items.length<=0||(1!=items.length?game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_LIST_SELECT,{header:"Choose",list:items,onGetRowName:function(item){return item.moniker.display},onSelect:function(item){_this2.game.screens.replaceScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_INTERACT_MODAL,{interactor:_this2.game.player.entity,interactable:item})}}):this.game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_INTERACT_MODAL,{interactor:this.game.player.entity,interactable:items[0]}))}},{key:"onInteractDirection",value:function(dir){var delta=(0,_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.delta)(dir),playerPosition=this.game.player.position,targetPosition={x:playerPosition.x+delta.x,y:playerPosition.y+delta.y};this.onInteract(targetPosition.x,targetPosition.y)}},{key:"onInputCommand",value:function(cmd){if(cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SAVE&&this.game.state.saveGame(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_LOAD&&this.game.state.loadGame(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_LOOK&&game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_CURSOR,{drawTags:!0,onResult:function(){return game.screens.popScreen()},onCancel:function(){return game.screens.popScreen()}}),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_PICK_UP&&this.onPickUpCommand(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_INTERACT){var pos=this.game.player.position;this.onInteract(pos.x,pos.y)}cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_INVENTORY&&this.game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_INVENTORY,{accessible:this.game.player.entity,accessor:this.game.player.entity}),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_EQUIPMENT&&this.game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_EQUIPMENT,{accessor:this.game.player.entity}),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CHARACTER&&this.game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_CHARACTER,{character:this.game.player.entity}),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CANCEL&&this.game.screens.setScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_4__.SCREEN_MAIN_MENU),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_WAIT&&this.game.player.wait(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_NW&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_NW),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_N&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_N),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_NE&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_NE),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_W&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_W),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_E&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_E),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_SW&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_SW),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_S&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_S),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_SE&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_SE),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_NW&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_NW),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_N&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_N),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_NE&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_NE),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_W&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_W),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_E&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_E),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_SW&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_SW),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_S&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_S),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SELECT_SE&&this.onInteractDirection(_enums_Directions__WEBPACK_IMPORTED_MODULE_3__.DIR_SE)}},{key:"onUpdate",value:function(dt){this.game.updateAdventureSystems(dt)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),AdventureScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Screen});var _game=new WeakMap,Screen=function(){function Screen(game){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Screen),_game.set(this,{writable:!0,value:void 0}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_game,game)}return _createClass(Screen,[{key:"game",get:function(){return function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}(this,_game)}}]),_createClass(Screen,[{key:"onEnter",value:function(){}},{key:"onLeave",value:function(){}},{key:"onInputCommand",value:function(cmd){}},{key:"onUpdate",value:function(dt){}}]),Screen}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>MainMenuScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_ScreenType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(53);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var MainMenuScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MainMenuScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(MainMenuScreen);function MainMenuScreen(){return _classCallCheck(this,MainMenuScreen),_super.apply(this,arguments)}return Constructor=MainMenuScreen,(protoProps=[{key:"onEnter",value:function(){this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU),this.game.state.isStarted||this.game.music.play("BARDS_TALE")}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"onConfirm",value:function(){this.game.state.isStarted?this.game.screens.setScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_3__.SCREEN_ADVENTURE):this.game.state.newGame()}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CONFIRM&&this.onConfirm(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_SAVE&&this.game.state.saveGame(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_LOAD&&this.game.state.loadGame(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_NEW_GAME&&this.game.state.newGame()}},{key:"onUpdate",value:function(dt){this.game.renderer.clear(),this.game.renderer.drawText(1,1,"Knossonia","cyan"),this.game.renderer.drawText(1,4,"move       [q, w, e, a, d, z, x, c]"),this.game.renderer.drawText(1,5,"look       [l]"),this.game.renderer.drawText(1,6,"interact   [shift+direction]"),this.game.renderer.drawText(1,7,"interact   [j]"),this.game.renderer.drawText(1,8,"pick up    [g]"),this.game.renderer.drawText(1,9,"save       [ctrl+s]"),this.game.renderer.drawText(1,10,"load       [ctrl+l]"),this.game.renderer.drawText(1,11,"confirm    [enter]"),this.game.renderer.drawText(1,12,"cancel     [esc]"),this.game.renderer.drawTextCenter(14,"set out into the forest..."),this.game.renderer.drawTextCenter(16,"press [enter]")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),MainMenuScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>DeathScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_ScreenType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(53);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var DeathScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DeathScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(DeathScreen);function DeathScreen(){return _classCallCheck(this,DeathScreen),_super.apply(this,arguments)}return Constructor=DeathScreen,(protoProps=[{key:"onEnter",value:function(){this.game.state.gameOver(),this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CONFIRM&&this.game.screens.setScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_3__.SCREEN_MAIN_MENU)}},{key:"onUpdate",value:function(dt){this.game.renderer.drawTextCenter(10,"you have succumbed to the forest","#ce5454")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),DeathScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>InventoryScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_ScreenType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(53),_utils_SelectableList__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(131);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}var _accessible=new WeakMap,_accessor=new WeakMap,InventoryScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(InventoryScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(InventoryScreen);function InventoryScreen(){var _this;_classCallCheck(this,InventoryScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_accessible.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_accessor.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_defineProperty(_assertThisInitialized(_this),"list",new _utils_SelectableList__WEBPACK_IMPORTED_MODULE_4__.default),_this}return Constructor=InventoryScreen,(protoProps=[{key:"onEnter",value:function(ctx){this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU),_classPrivateFieldSet(this,_accessible,ctx.accessible),_classPrivateFieldSet(this,_accessor,ctx.accessor),this.list.setItems(_classPrivateFieldGet(this,_accessible).inventory.content)}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"selectItem",value:function(){var interactable=this.list.selected;interactable&&this.game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_3__.SCREEN_INTERACT_MODAL,{interactable,interactor:_classPrivateFieldGet(this,_accessor)})}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CANCEL&&this.game.screens.popScreen(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_N&&this.list.up(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_S&&this.list.down(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CONFIRM&&this.selectItem()}},{key:"onUpdate",value:function(dt){var _this2=this;this.game.renderer.clear(),this.game.renderer.drawTextCenter(3,"~ ".concat(_classPrivateFieldGet(this,_accessible).moniker.display," Inventory ~"),"yellow"),0===this.list.items.length&&this.game.renderer.drawTextCenter(6,"There is nothing here."),this.list.data.forEach((function(_ref){var item=_ref.item,ypos=_ref.idx+5;_ref.isSelected?_this2.game.renderer.drawText(1,ypos,"→","yellow"):_this2.game.renderer.drawText(1,ypos,"-"),_this2.game.renderer.draw(2,ypos,item.glyph.char,item.glyph.primary,item.glyph.secondary,item.glyph.background);var textLen=_this2.game.renderer.computeTextWidth(item.moniker.display);if(_this2.game.renderer.drawText(4,ypos,item.moniker.display),item.isEquipped){var slot=item.isEquipped.slot.name;_this2.game.renderer.drawText(4+textLen+.5,ypos,"[".concat(slot,"]"),"#2c3538")}})),this.game.renderer.drawText(1,1,"← back [esc]")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),InventoryScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>SelectableList});var SelectableList=function(){function SelectableList(){var items=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],idx=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,SelectableList),_defineProperty(this,"_items",[]),_defineProperty(this,"_idx",0),this._idx=idx,this.setItems(items)}return _createClass(SelectableList,[{key:"selected",get:function(){return this._items[this._idx]}},{key:"items",get:function(){return this._items}},{key:"data",get:function(){var _this=this;return this._items.map((function(item,idx){return{item,idx,isSelected:idx===_this._idx}}))}},{key:"isEmpty",get:function(){return this._items.length<=0}},{key:"length",get:function(){return this._items.length}}]),_createClass(SelectableList,[{key:"setItems",value:function(){var items=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._items=items,this._idx=Math.min(Math.max(this._idx,0),this._items.length-1)}},{key:"up",value:function(){this._idx--,this._idx<0&&(this._idx=this._items.length-1)}},{key:"down",value:function(){this._idx++,this._idx>=this._items.length&&(this._idx=0)}}]),SelectableList}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>InteractModalScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_utils_SelectableList__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(131);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _width=new WeakMap,_height=new WeakMap,_interactable=new WeakMap,_interactor=new WeakMap,InteractModalScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(InteractModalScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(InteractModalScreen);function InteractModalScreen(){var _this;_classCallCheck(this,InteractModalScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_width.set(_assertThisInitialized(_this),{writable:!0,value:16}),_height.set(_assertThisInitialized(_this),{writable:!0,value:12}),_interactable.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_interactor.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_defineProperty(_assertThisInitialized(_this),"list",new _utils_SelectableList__WEBPACK_IMPORTED_MODULE_3__.default),_this}return Constructor=InteractModalScreen,(protoProps=[{key:"onEnter",value:function(ctx){this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU),_classPrivateFieldSet(this,_interactable,ctx.interactable),_classPrivateFieldSet(this,_interactor,ctx.interactor),this.refreshList()}},{key:"refreshList",value:function(){var evt=_classPrivateFieldGet(this,_interactable).fireEvent("get-interactions",{interactor:_classPrivateFieldGet(this,_interactor),interactions:[]});this.list.setItems([].concat(_toConsumableArray(evt.data.interactions),[{name:"Back",isBack:!0}]))}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"selectItem",value:function(){var interaction=this.list.selected;interaction.isBack?this.game.screens.popScreen():(_classPrivateFieldGet(this,_interactable).fireEvent(interaction.evt,{interactor:_classPrivateFieldGet(this,_interactor)}),_classPrivateFieldGet(this,_interactable).isDestroyed?this.game.screens.popScreen():this.refreshList())}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CANCEL&&this.game.screens.popScreen(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_N&&this.list.up(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_S&&this.list.down(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CONFIRM&&this.selectItem()}},{key:"onUpdate",value:function(dt){var _this2=this;this.game.renderer.clearArea(this.left,this.top,_classPrivateFieldGet(this,_width)+1,_classPrivateFieldGet(this,_height)+1),this.game.renderer.draw(this.left+2,this.top+2,_classPrivateFieldGet(this,_interactable).glyph.char,_classPrivateFieldGet(this,_interactable).glyph.primary,_classPrivateFieldGet(this,_interactable).glyph.secondary,_classPrivateFieldGet(this,_interactable).glyph.background),this.game.renderer.drawTextCenter(this.top+2,"".concat(_classPrivateFieldGet(this,_interactable).moniker.display));for(var i=this.left;i<this.left+_classPrivateFieldGet(this,_width);i++)this.game.renderer.draw(i,this.top,"─"),this.game.renderer.draw(i,this.top+_classPrivateFieldGet(this,_height),"─");for(var _i=this.top;_i<this.top+_classPrivateFieldGet(this,_height);_i++)this.game.renderer.draw(this.left,_i,"│"),this.game.renderer.draw(this.left+_classPrivateFieldGet(this,_width),_i,"│");this.game.renderer.draw(this.left,this.top,"┌"),this.game.renderer.draw(this.left+_classPrivateFieldGet(this,_width),this.top,"┐"),this.game.renderer.draw(this.left,this.top+_classPrivateFieldGet(this,_height),"└"),this.game.renderer.draw(this.left+_classPrivateFieldGet(this,_width),this.top+_classPrivateFieldGet(this,_height),"┘");var xpos=this.left+2;this.list.data.forEach((function(_ref){var item=_ref.item,idx=_ref.idx,isSelected=_ref.isSelected,ypos=idx+_this2.top+4;isSelected?_this2.game.renderer.drawText(xpos,ypos,"→ ".concat(item.name),"yellow"):_this2.game.renderer.drawText(xpos,ypos,"- ".concat(item.name))}))}},{key:"left",get:function(){return Math.floor((this.game.camera.width-_classPrivateFieldGet(this,_width))/2)}},{key:"top",get:function(){return Math.floor((this.game.camera.height-_classPrivateFieldGet(this,_height))/2)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),InteractModalScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CursorScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_enums_Directions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(83),_utils_BresenhamLine__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(67),_ecs_components__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(20);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}var NOOP=function(){},_start=new WeakMap,_onResult=new WeakMap,_onCancel=new WeakMap,_getSegmentTypes=new WeakMap,_drawLine=new WeakMap,_drawTags=new WeakMap,CursorScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CursorScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(CursorScreen);function CursorScreen(){var _this;_classCallCheck(this,CursorScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_start.set(_assertThisInitialized(_this),{writable:!0,value:{}}),_onResult.set(_assertThisInitialized(_this),{writable:!0,value:NOOP}),_onCancel.set(_assertThisInitialized(_this),{writable:!0,value:NOOP}),_getSegmentTypes.set(_assertThisInitialized(_this),{writable:!0,value:NOOP}),_drawLine.set(_assertThisInitialized(_this),{writable:!0,value:!1}),_drawTags.set(_assertThisInitialized(_this),{writable:!0,value:!1}),_this}return Constructor=CursorScreen,(protoProps=[{key:"onEnter",value:function(ctx){this.game.renderer.clear(),this.game.FOVSystem.computeFOV(),this.game.cursor.enable(),_classPrivateFieldSet(this,_start,ctx.start||this.game.player.position),_classPrivateFieldSet(this,_onResult,ctx.onResult||NOOP),_classPrivateFieldSet(this,_onCancel,ctx.onCancel||NOOP),_classPrivateFieldSet(this,_getSegmentTypes,ctx.getSegmentTypes||NOOP),_classPrivateFieldSet(this,_drawLine,Boolean(ctx.drawLine)),_classPrivateFieldSet(this,_drawTags,Boolean(ctx.drawTags))}},{key:"onLeave",value:function(){this.game.cursor.disable()}},{key:"onDirectionInput",value:function(dir){this.game.cursor.move(dir)}},{key:"onConfirm",value:function(){_classPrivateFieldGet(this,_onResult).call(this,{start:_classPrivateFieldGet(this,_start),position:{x:this.game.cursor.x,y:this.game.cursor.y}})}},{key:"onCancel",value:function(){_classPrivateFieldGet(this,_onCancel).call(this)}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CONFIRM&&this.onConfirm(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CANCEL&&this.onCancel(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_NW&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_NW),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_N&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_N),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_NE&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_NE),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_W&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_W),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_E&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_E),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_SW&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_SW),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_S&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_S),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_SE&&this.onDirectionInput(_enums_Directions__WEBPACK_IMPORTED_MODULE_2__.DIR_SE)}},{key:"onUpdate",value:function(dt){var _this2=this;this.game.updateAdventureSystems(dt);var line=(0,_utils_BresenhamLine__WEBPACK_IMPORTED_MODULE_3__.bresenhamLine)(_classPrivateFieldGet(this,_start).x,_classPrivateFieldGet(this,_start).y,this.game.cursor.x,this.game.cursor.y),cursorColor=(0,_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.getCursorSegmentTypeColor)(_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_INTEREST);if(_classPrivateFieldGet(this,_drawLine)){var types=_classPrivateFieldGet(this,_getSegmentTypes).call(this,line);line.forEach((function(segment,idx){var type=types[idx];if(type!==_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.CURSOR_SEGMENT_NONE&&!isNaN(type)){var color=(0,_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.getCursorSegmentTypeColor)(type),glyph=(0,_enums_CursorSegments__WEBPACK_IMPORTED_MODULE_4__.getCursorSegmentTypeGlyph)(type),screen=_this2.game.camera.worldToScreen(segment.x,segment.y);_this2.game.renderer.draw(screen.x,screen.y,glyph,color),idx===line.length-1&&(cursorColor=color)}}))}_classPrivateFieldGet(this,_drawTags)&&this.game.cursor.drawTags();var target=this.game.cursor.getEntities().filter((function(e){return e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_5__.FactionMember)})).pop(),player=this.game.player.entity;if(target){var faction=target.factionMember.faction,relation=this.game.factions.getEntityRelation(player,target),disp=this.game.factions.getDisplay(relation);this.game.renderer.drawTextCenter(1,"".concat(faction.display," Faction [").concat(disp,"]"))}this.game.cursor.drawCursor(cursorColor)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CursorScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>LoadSectorScreen});var _ScreenType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(53),_Screen__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(127);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}var _prevousSector=new WeakMap,_nextSector=new WeakMap,LoadSectorScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(LoadSectorScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(LoadSectorScreen);function LoadSectorScreen(){var _this;_classCallCheck(this,LoadSectorScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_prevousSector.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_nextSector.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_this}return Constructor=LoadSectorScreen,(protoProps=[{key:"onEnter",value:function(ctx){if(this.game.commands.disable(),_classPrivateFieldSet(this,_prevousSector,ctx.prevousSector),_classPrivateFieldSet(this,_nextSector,ctx.nextSector),this.renderLoadingText(),ctx.prevousSector){var data=this.game.state.saveGame();return data.world.sectorId=ctx.nextSector.id,data.map.playerPosition=ctx.entry,void this.game.state.loadGameData(data)}this.game.world.onSectorLoaded(ctx.nextSector,ctx.entry),this.game.map.onSectorLoaded(ctx.nextSector,ctx.entry),this.game.music.onSectorLoaded(ctx.nextSector,ctx.entry),this.game.screens.setScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_ADVENTURE)}},{key:"onLeave",value:function(){this.game.commands.enable()}},{key:"renderLoadingText",value:function(){if(this.game.renderer.clear(),_classPrivateFieldGet(this,_prevousSector)){var prevText="You are leaving sector ".concat(_classPrivateFieldGet(this,_prevousSector).id);this.game.renderer.drawTextCenter(11,prevText,"#ce5454")}else{var nextText="You are entering sector ".concat(_classPrivateFieldGet(this,_nextSector).id);this.game.renderer.drawTextCenter(11,nextText,"#ce5454")}}},{key:"onUpdate",value:function(dt){this.renderLoadingText()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),LoadSectorScreen}(_Screen__WEBPACK_IMPORTED_MODULE_1__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>EquipmentScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_ScreenType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(53),_utils_SelectableList__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(131);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _accessor=new WeakMap,EquipmentScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(EquipmentScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(EquipmentScreen);function EquipmentScreen(){var _this;_classCallCheck(this,EquipmentScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_accessor.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_defineProperty(_assertThisInitialized(_this),"list",new _utils_SelectableList__WEBPACK_IMPORTED_MODULE_4__.default),_this}return Constructor=EquipmentScreen,(protoProps=[{key:"onEnter",value:function(ctx){this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_accessor,ctx.accessor),this.list.setItems(Object.values(_classPrivateFieldGet(this,_accessor).equipmentSlot))}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"selectSlot",value:function(){var interactable=this.list.selected.content;interactable&&this.game.screens.pushScreen(_ScreenType__WEBPACK_IMPORTED_MODULE_3__.SCREEN_INTERACT_MODAL,{interactable,interactor:_classPrivateFieldGet(this,_accessor)})}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CANCEL&&this.game.screens.popScreen(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_N&&this.list.up(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_S&&this.list.down(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CONFIRM&&this.selectSlot()}},{key:"onUpdate",value:function(dt){var _this2=this;this.game.renderer.clear(),this.game.renderer.drawTextCenter(3,"~ ".concat(_classPrivateFieldGet(this,_accessor).moniker.display," Equipment ~"),"purple"),this.list.isEmpty&&this.game.renderer.drawTextCenter(6,"There is nothing here."),this.list.data.forEach((function(_ref){var slot=_ref.item,ypos=_ref.idx+5;if(_ref.isSelected?(_this2.game.renderer.drawText(1,ypos,"→ ".concat(slot.name),"yellow"),_this2.game.renderer.drawText(14,ypos,"→","yellow")):(_this2.game.renderer.drawText(1,ypos,"- ".concat(slot.name)),_this2.game.renderer.drawText(14,ypos,"-","#2c3538")),slot.isEmpty)_this2.game.renderer.drawText(15,ypos,"[empty]","#2c3538");else{var content=slot.content;_this2.game.renderer.draw(15,ypos,content.glyph.char,content.glyph.primary,content.glyph.secondary,content.glyph.background),_this2.game.renderer.drawText(16,ypos," ".concat(content.moniker.display))}})),this.game.renderer.drawText(1,1,"← back [esc]")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),EquipmentScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ListSelectionScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_utils_SelectableList__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(131);__webpack_require__(137);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var NOOP=function(){},ListSelectionScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ListSelectionScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(ListSelectionScreen);function ListSelectionScreen(){var _this;_classCallCheck(this,ListSelectionScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _defineProperty(_assertThisInitialized(_this=_super.call.apply(_super,[this].concat(args))),"width",16),_defineProperty(_assertThisInitialized(_this),"height",12),_defineProperty(_assertThisInitialized(_this),"list",new _utils_SelectableList__WEBPACK_IMPORTED_MODULE_3__.default),_defineProperty(_assertThisInitialized(_this),"header",""),_this}return Constructor=ListSelectionScreen,(protoProps=[{key:"onEnter",value:function(ctx){this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU),this.list.setItems(ctx.list||[]),this.header=ctx.header||"Select",this.onSelect=ctx.onSelect||NOOP,this.onCancel=ctx.onCancel||NOOP,this.onGetRowName=ctx.onGetRowName||NOOP,this.onRenderRow=ctx.onRenderRow||this.defaultRowRender.bind(this)}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"selectItem",value:function(){this.onSelect(this.list.selected)}},{key:"cancel",value:function(){this.onCancel(),this.game.screens.popScreen()}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CANCEL&&this.cancel(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_N&&this.list.up(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_S&&this.list.down(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CONFIRM&&this.selectItem()}},{key:"defaultRowRender",value:function(row,x,y,isSelected){var text=this.onGetRowName(row,x,y,isSelected);isSelected?this.game.renderer.drawText(x,y,"→ ".concat(text),"yellow"):this.game.renderer.drawText(x,y,"- ".concat(text))}},{key:"onUpdate",value:function(dt){var _this2=this;this.game.renderer.clearArea(this.left,this.top,this.width+1,this.height+1),this.game.renderer.drawTextCenter(this.top+2,this.header);for(var i=this.left;i<this.left+this.width;i++)this.game.renderer.draw(i,this.top,"─"),this.game.renderer.draw(i,this.top+this.height,"─");for(var _i=this.top;_i<this.top+this.height;_i++)this.game.renderer.draw(this.left,_i,"│"),this.game.renderer.draw(this.left+this.width,_i,"│");this.game.renderer.draw(this.left,this.top,"┌"),this.game.renderer.draw(this.left+this.width,this.top,"┐"),this.game.renderer.draw(this.left,this.top+this.height,"└"),this.game.renderer.draw(this.left+this.width,this.top+this.height,"┘");var xpos=this.left+2;this.list.data.forEach((function(_ref){var item=_ref.item,idx=_ref.idx,isSelected=_ref.isSelected,ypos=idx+_this2.top+4;_this2.onRenderRow(item,xpos,ypos,isSelected,idx)}))}},{key:"left",get:function(){return Math.floor((this.game.camera.width-this.width)/2)}},{key:"top",get:function(){return Math.floor((this.game.camera.height-this.height)/2)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ListSelectionScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Simple});var Simple=function(_Scheduler){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Simple,_Scheduler);var Constructor,protoProps,staticProps,_super=_createSuper(Simple);function Simple(){return _classCallCheck(this,Simple),_super.apply(this,arguments)}return Constructor=Simple,(protoProps=[{key:"add",value:function(item,repeat){return this._queue.add(item,0),_get(_getPrototypeOf(Simple.prototype),"add",this).call(this,item,repeat)}},{key:"next",value:function(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,0),_get(_getPrototypeOf(Simple.prototype),"next",this).call(this)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Simple}(__webpack_require__(138).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Scheduler});var _eventqueue_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(139);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Scheduler=function(){function Scheduler(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Scheduler),this._queue=new _eventqueue_js__WEBPACK_IMPORTED_MODULE_0__.default,this._repeat=[],this._current=null}var Constructor,protoProps,staticProps;return Constructor=Scheduler,(protoProps=[{key:"getTime",value:function(){return this._queue.getTime()}},{key:"add",value:function(item,repeat){return repeat&&this._repeat.push(item),this}},{key:"getTimeOf",value:function(item){return this._queue.getEventTime(item)}},{key:"clear",value:function(){return this._queue.clear(),this._repeat=[],this._current=null,this}},{key:"remove",value:function(item){var result=this._queue.remove(item),index=this._repeat.indexOf(item);return-1!=index&&this._repeat.splice(index,1),this._current==item&&(this._current=null),result}},{key:"next",value:function(){return this._current=this._queue.get(),this._current}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Scheduler}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>EventQueue});var _MinHeap__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(140);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var EventQueue=function(){function EventQueue(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EventQueue),this._time=0,this._events=new _MinHeap__WEBPACK_IMPORTED_MODULE_0__.MinHeap}var Constructor,protoProps,staticProps;return Constructor=EventQueue,(protoProps=[{key:"getTime",value:function(){return this._time}},{key:"clear",value:function(){return this._events=new _MinHeap__WEBPACK_IMPORTED_MODULE_0__.MinHeap,this}},{key:"add",value:function(event,time){this._events.push(event,time)}},{key:"get",value:function(){if(!this._events.len())return null;var _this$_events$pop=this._events.pop(),time=_this$_events$pop.key,event=_this$_events$pop.value;return time>0&&(this._time+=time,this._events.shift(-time)),event}},{key:"getEventTime",value:function(event){var r=this._events.find(event);if(r)return r.key}},{key:"remove",value:function(event){return this._events.remove(event)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),EventQueue}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MinHeap:()=>MinHeap});var MinHeap=function(){function MinHeap(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MinHeap),this.heap=[],this.timestamp=0}var Constructor,protoProps,staticProps;return Constructor=MinHeap,(protoProps=[{key:"lessThan",value:function(a,b){return a.key==b.key?a.timestamp<b.timestamp:a.key<b.key}},{key:"shift",value:function(v){this.heap=this.heap.map((function(_ref){var key=_ref.key,value=_ref.value,timestamp=_ref.timestamp;return{key:key+v,value,timestamp}}))}},{key:"len",value:function(){return this.heap.length}},{key:"push",value:function(value,key){this.timestamp+=1;var loc=this.len();this.heap.push({value,timestamp:this.timestamp,key}),this.updateUp(loc)}},{key:"pop",value:function(){if(0==this.len())throw new Error("no element to pop");var top=this.heap[0];return this.len()>1?(this.heap[0]=this.heap.pop(),this.updateDown(0)):this.heap.pop(),top}},{key:"find",value:function(v){for(var i=0;i<this.len();i++)if(v==this.heap[i].value)return this.heap[i];return null}},{key:"remove",value:function(v){for(var index=null,i=0;i<this.len();i++)v==this.heap[i].value&&(index=i);if(null===index)return!1;if(this.len()>1){var last=this.heap.pop();return last.value!=v&&(this.heap[index]=last,this.updateDown(index)),!0}return this.heap.pop(),!0}},{key:"parentNode",value:function(x){return Math.floor((x-1)/2)}},{key:"leftChildNode",value:function(x){return 2*x+1}},{key:"rightChildNode",value:function(x){return 2*x+2}},{key:"existNode",value:function(x){return x>=0&&x<this.heap.length}},{key:"swap",value:function(x,y){var t=this.heap[x];this.heap[x]=this.heap[y],this.heap[y]=t}},{key:"minNode",value:function(numbers){var _step,validnumbers=numbers.filter(this.existNode.bind(this)),minimal=validnumbers[0],_iterator=_createForOfIteratorHelper(validnumbers);try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;this.lessThan(this.heap[i],this.heap[minimal])&&(minimal=i)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return minimal}},{key:"updateUp",value:function(x){if(0!=x){var parent=this.parentNode(x);this.existNode(parent)&&this.lessThan(this.heap[x],this.heap[parent])&&(this.swap(x,parent),this.updateUp(parent))}}},{key:"updateDown",value:function(x){var leftChild=this.leftChildNode(x),rightChild=this.rightChildNode(x);if(this.existNode(leftChild)){var m=this.minNode([x,leftChild,rightChild]);m!=x&&(this.swap(x,m),this.updateDown(m))}}},{key:"debugPrint",value:function(){console.log(this.heap)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),MinHeap}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CharacterScreen});var _Screen__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(127),_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(123),_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(120),_utils_SelectableList__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(131),_data_Abilities__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(60),__webpack_require__(58));function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var CharacterScreen=function(_Screen){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CharacterScreen,_Screen);var Constructor,protoProps,staticProps,_super=_createSuper(CharacterScreen);function CharacterScreen(){var _this;_classCallCheck(this,CharacterScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _defineProperty(_assertThisInitialized(_this=_super.call.apply(_super,[this].concat(args))),"character",void 0),_this}return Constructor=CharacterScreen,(protoProps=[{key:"onEnter",value:function(ctx){this.game.commands.pushDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU),this.character=ctx.character;var stats=this.character.stats.all();this.list=new _utils_SelectableList__WEBPACK_IMPORTED_MODULE_3__.default(Object.values(stats))}},{key:"onLeave",value:function(){this.game.commands.popDomain(_input_InputDomainType__WEBPACK_IMPORTED_MODULE_2__.INPUT_DOMAIN_MAIN_MENU)}},{key:"onInputCommand",value:function(cmd){cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_CANCEL&&this.game.screens.popScreen(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_N&&this.list.up(),cmd.type===_input_InputCommandType__WEBPACK_IMPORTED_MODULE_1__.INPUT_CMD_MOVE_S&&this.list.down()}},{key:"onUpdate",value:function(dt){var _this2=this;this.game.renderer.clear(),this.game.renderer.drawTextCenter(3,"~ ".concat(this.character.moniker.display," Character ~"),"orange");var health=this.character.health.value,healthMax=this.character.health.max;this.game.renderer.drawText(2,5,"health"),this.game.renderer.drawText(10,5,"".concat(health,"/").concat(healthMax));var speed=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.ABILITY_SPEED,this.character);this.game.renderer.drawText(2,6,"speed"),this.game.renderer.drawText(10,6,"".concat(speed));var armor=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.ABILITY_ARMOR,this.character);this.game.renderer.drawText(2,7,"armor"),this.game.renderer.drawText(10,7,"".concat(armor));var dodge=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.ABILITY_DODGE,this.character);this.game.renderer.drawText(2,8,"dodge"),this.game.renderer.drawText(10,8,"".concat(dodge));var penetration=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.ABILITY_PENETRATION,this.character);this.game.renderer.drawText(2,9,"penetration"),this.game.renderer.drawText(10,9,"".concat(penetration));var accuracy=(0,_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.getAbilityValue)(_data_Abilities__WEBPACK_IMPORTED_MODULE_5__.ABILITY_ACCURACY,this.character);this.game.renderer.drawText(2,10,"accuracy"),this.game.renderer.drawText(10,10,"".concat(accuracy));var pad=0;this.list.data.forEach((function(_ref){var item=_ref.item,idx=_ref.idx,isSelected=_ref.isSelected,stat=item,ypos=idx+13+pad;if(isSelected){_this2.game.renderer.drawText(1,ypos,"→ ".concat(stat.name),"yellow");var modDir=stat.modSum>0?"+":"-";_this2.game.renderer.drawText(10,ypos,"".concat(stat.sum," (").concat(stat.base).concat(modDir).concat(Math.abs(stat.modSum),")"),"yellow"),stat.modifiers.forEach((function(mod,i){mod.mod>0?_this2.game.renderer.drawText(3,ypos+i+1,"+".concat(mod.mod," (").concat(mod.source,")"),"green"):_this2.game.renderer.drawText(3,ypos+i+1,"-".concat(Math.abs(mod.mod)," (").concat(mod.source,")"),"red")})),pad+=stat.modifiers.length}else _this2.game.renderer.drawText(1,ypos,"- ".concat(stat.name)),_this2.game.renderer.drawText(10,ypos,"".concat(stat.sum))})),this.game.renderer.drawText(1,1,"← back [esc]")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CharacterScreen}(_Screen__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>PlayerManager});var _Manager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_ecs_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _entityId=new WeakMap,PlayerManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(PlayerManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(PlayerManager);function PlayerManager(){var _this;_classCallCheck(this,PlayerManager);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_entityId.set(_assertThisInitialized(_this),{writable:!0,value:null}),_this}return Constructor=PlayerManager,(protoProps=[{key:"getSetupData",value:function(){var entity=this.game.ecs.createPrefab("Player"),entityId=entity.id,serialized=entity.serialize();return entity.destroy(),{entityId,entity:serialized}}},{key:"setup",value:function(data){_classPrivateFieldSet(this,_entityId,data.entityId),this.game.ecs.deserialize(data.entity)}},{key:"getSaveGameData",value:function(){var entityId=this.entity.id,evt=this.entity.fireEvent("query-ownership",{result:new Set([this.entity])}),serialized=this.game.ecs.serialize(Array.from(evt.data.result));return console.log(serialized),{entityId,entity:serialized}}},{key:"teardown",value:function(){this.entity&&this.entity.destroy(),_classPrivateFieldSet(this,_entityId,null)}},{key:"move",value:function(direction){this.isTurn&&(this.entity.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.MoveCommand)&&this.entity.moveCommand.destroy(),this.entity.add(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.MoveCommand,{direction}))}},{key:"melee",value:function(target){this.isTurn&&(this.entity.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.MeleeCommand)&&this.entity.meleeCommand.destroy(),this.entity.add(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.MeleeCommand,{target}))}},{key:"wait",value:function(){var turns=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isTurn&&this.entity.fireEvent("energy-consumed",1e3*turns)}},{key:"entity",get:function(){return this.game.ecs.getEntity(_classPrivateFieldGet(this,_entityId))}},{key:"id",get:function(){return _classPrivateFieldGet(this,_entityId)}},{key:"isTurn",get:function(){return this.entity.actor.hasEnergy}},{key:"position",get:function(){return this.entity.position.getPos()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),PlayerManager}(_Manager__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ECS});var geotic__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22),_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_prefabs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(144),_core_Manager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _engine=new WeakMap,ECS=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ECS,_Manager);var _super=_createSuper(ECS);function ECS(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ECS),_this=_super.call(this,game),_engine.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_engine,new geotic__WEBPACK_IMPORTED_MODULE_0__.Engine),Object.values(_components__WEBPACK_IMPORTED_MODULE_1__).forEach((function(component){_classPrivateFieldGet(_assertThisInitialized(_this),_engine).registerComponent(component)})),Object.values(_prefabs__WEBPACK_IMPORTED_MODULE_2__).forEach((function(prefab){_classPrivateFieldGet(_assertThisInitialized(_this),_engine).registerPrefab(prefab)})),_this}return _createClass(ECS,[{key:"engine",get:function(){return _classPrivateFieldGet(this,_engine)}}]),_createClass(ECS,[{key:"teardown",value:function(){this.destroyEntities()}},{key:"destroyEntities",value:function(){var _step,_iterator=_createForOfIteratorHelper(_classPrivateFieldGet(this,_engine).entities.all);try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.destroy()}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"cloneEntity",value:function(entity){var data=entity.serialize();return data.id=this.engine.generateId(),this.engine.deserialize(data),this.engine.getEntity(data.id)}}]),ECS}(_core_Manager__WEBPACK_IMPORTED_MODULE_3__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";var _GameObjectPrefab_json__WEBPACK_IMPORTED_MODULE_0___namespace_cache,_CorpsePrefab_json__WEBPACK_IMPORTED_MODULE_1___namespace_cache,_VialPrefab_json__WEBPACK_IMPORTED_MODULE_2___namespace_cache,_BeingPrefab_json__WEBPACK_IMPORTED_MODULE_3___namespace_cache,_HumanoidPrefab_json__WEBPACK_IMPORTED_MODULE_4___namespace_cache,_HumanPrefab_json__WEBPACK_IMPORTED_MODULE_5___namespace_cache,_WandererPrefab_json__WEBPACK_IMPORTED_MODULE_6___namespace_cache,_HumanWandererPrefab_json__WEBPACK_IMPORTED_MODULE_7___namespace_cache,_PlayerPrefab_json__WEBPACK_IMPORTED_MODULE_8___namespace_cache,_GoalPrefab_json__WEBPACK_IMPORTED_MODULE_9___namespace_cache,_TilePrefab_json__WEBPACK_IMPORTED_MODULE_10___namespace_cache,_PineTreePrefab_json__WEBPACK_IMPORTED_MODULE_11___namespace_cache,_SmallPineTreePrefab_json__WEBPACK_IMPORTED_MODULE_12___namespace_cache,_WallPrefab_json__WEBPACK_IMPORTED_MODULE_13___namespace_cache,_WoodWallPrefab_json__WEBPACK_IMPORTED_MODULE_14___namespace_cache,_GoblinPrefab_json__WEBPACK_IMPORTED_MODULE_15___namespace_cache,_ChestPrefab_json__WEBPACK_IMPORTED_MODULE_16___namespace_cache,_DoorPrefab_json__WEBPACK_IMPORTED_MODULE_17___namespace_cache,_StonePrefab_json__WEBPACK_IMPORTED_MODULE_18___namespace_cache,_GlassShardPrefab_json__WEBPACK_IMPORTED_MODULE_19___namespace_cache,_PoolPrefab_json__WEBPACK_IMPORTED_MODULE_20___namespace_cache,_DirtPathwayPrefab_json__WEBPACK_IMPORTED_MODULE_21___namespace_cache,_AmuletPrefab_json__WEBPACK_IMPORTED_MODULE_22___namespace_cache,_ClothArmorPrefab_json__WEBPACK_IMPORTED_MODULE_23___namespace_cache,_BootsPrefab_json__WEBPACK_IMPORTED_MODULE_24___namespace_cache,_WeaponPrefab_json__WEBPACK_IMPORTED_MODULE_25___namespace_cache,_ShortswordPrefab_json__WEBPACK_IMPORTED_MODULE_26___namespace_cache;__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GameObjectPrefab:()=>_GameObjectPrefab_json__WEBPACK_IMPORTED_MODULE_0___namespace_cache||(_GameObjectPrefab_json__WEBPACK_IMPORTED_MODULE_0___namespace_cache=__webpack_require__.t(_GameObjectPrefab_json__WEBPACK_IMPORTED_MODULE_0__,2)),CorpsePrefab:()=>_CorpsePrefab_json__WEBPACK_IMPORTED_MODULE_1___namespace_cache||(_CorpsePrefab_json__WEBPACK_IMPORTED_MODULE_1___namespace_cache=__webpack_require__.t(_CorpsePrefab_json__WEBPACK_IMPORTED_MODULE_1__,2)),VialPrefab:()=>_VialPrefab_json__WEBPACK_IMPORTED_MODULE_2___namespace_cache||(_VialPrefab_json__WEBPACK_IMPORTED_MODULE_2___namespace_cache=__webpack_require__.t(_VialPrefab_json__WEBPACK_IMPORTED_MODULE_2__,2)),BeingPrefab:()=>_BeingPrefab_json__WEBPACK_IMPORTED_MODULE_3___namespace_cache||(_BeingPrefab_json__WEBPACK_IMPORTED_MODULE_3___namespace_cache=__webpack_require__.t(_BeingPrefab_json__WEBPACK_IMPORTED_MODULE_3__,2)),HumanoidPrefab:()=>_HumanoidPrefab_json__WEBPACK_IMPORTED_MODULE_4___namespace_cache||(_HumanoidPrefab_json__WEBPACK_IMPORTED_MODULE_4___namespace_cache=__webpack_require__.t(_HumanoidPrefab_json__WEBPACK_IMPORTED_MODULE_4__,2)),HumanPrefab:()=>_HumanPrefab_json__WEBPACK_IMPORTED_MODULE_5___namespace_cache||(_HumanPrefab_json__WEBPACK_IMPORTED_MODULE_5___namespace_cache=__webpack_require__.t(_HumanPrefab_json__WEBPACK_IMPORTED_MODULE_5__,2)),WandererPrefab:()=>_WandererPrefab_json__WEBPACK_IMPORTED_MODULE_6___namespace_cache||(_WandererPrefab_json__WEBPACK_IMPORTED_MODULE_6___namespace_cache=__webpack_require__.t(_WandererPrefab_json__WEBPACK_IMPORTED_MODULE_6__,2)),HumanWanderer:()=>_HumanWandererPrefab_json__WEBPACK_IMPORTED_MODULE_7___namespace_cache||(_HumanWandererPrefab_json__WEBPACK_IMPORTED_MODULE_7___namespace_cache=__webpack_require__.t(_HumanWandererPrefab_json__WEBPACK_IMPORTED_MODULE_7__,2)),PlayerPrefab:()=>_PlayerPrefab_json__WEBPACK_IMPORTED_MODULE_8___namespace_cache||(_PlayerPrefab_json__WEBPACK_IMPORTED_MODULE_8___namespace_cache=__webpack_require__.t(_PlayerPrefab_json__WEBPACK_IMPORTED_MODULE_8__,2)),GoalPrefab:()=>_GoalPrefab_json__WEBPACK_IMPORTED_MODULE_9___namespace_cache||(_GoalPrefab_json__WEBPACK_IMPORTED_MODULE_9___namespace_cache=__webpack_require__.t(_GoalPrefab_json__WEBPACK_IMPORTED_MODULE_9__,2)),TilePrefab:()=>_TilePrefab_json__WEBPACK_IMPORTED_MODULE_10___namespace_cache||(_TilePrefab_json__WEBPACK_IMPORTED_MODULE_10___namespace_cache=__webpack_require__.t(_TilePrefab_json__WEBPACK_IMPORTED_MODULE_10__,2)),PineTreePrefab:()=>_PineTreePrefab_json__WEBPACK_IMPORTED_MODULE_11___namespace_cache||(_PineTreePrefab_json__WEBPACK_IMPORTED_MODULE_11___namespace_cache=__webpack_require__.t(_PineTreePrefab_json__WEBPACK_IMPORTED_MODULE_11__,2)),SmallPineTreePrefab:()=>_SmallPineTreePrefab_json__WEBPACK_IMPORTED_MODULE_12___namespace_cache||(_SmallPineTreePrefab_json__WEBPACK_IMPORTED_MODULE_12___namespace_cache=__webpack_require__.t(_SmallPineTreePrefab_json__WEBPACK_IMPORTED_MODULE_12__,2)),WallPrefab:()=>_WallPrefab_json__WEBPACK_IMPORTED_MODULE_13___namespace_cache||(_WallPrefab_json__WEBPACK_IMPORTED_MODULE_13___namespace_cache=__webpack_require__.t(_WallPrefab_json__WEBPACK_IMPORTED_MODULE_13__,2)),WoodWallPrefab:()=>_WoodWallPrefab_json__WEBPACK_IMPORTED_MODULE_14___namespace_cache||(_WoodWallPrefab_json__WEBPACK_IMPORTED_MODULE_14___namespace_cache=__webpack_require__.t(_WoodWallPrefab_json__WEBPACK_IMPORTED_MODULE_14__,2)),GoblinPrefab:()=>_GoblinPrefab_json__WEBPACK_IMPORTED_MODULE_15___namespace_cache||(_GoblinPrefab_json__WEBPACK_IMPORTED_MODULE_15___namespace_cache=__webpack_require__.t(_GoblinPrefab_json__WEBPACK_IMPORTED_MODULE_15__,2)),ChestPrefab:()=>_ChestPrefab_json__WEBPACK_IMPORTED_MODULE_16___namespace_cache||(_ChestPrefab_json__WEBPACK_IMPORTED_MODULE_16___namespace_cache=__webpack_require__.t(_ChestPrefab_json__WEBPACK_IMPORTED_MODULE_16__,2)),DoorPrefab:()=>_DoorPrefab_json__WEBPACK_IMPORTED_MODULE_17___namespace_cache||(_DoorPrefab_json__WEBPACK_IMPORTED_MODULE_17___namespace_cache=__webpack_require__.t(_DoorPrefab_json__WEBPACK_IMPORTED_MODULE_17__,2)),StonePrefab:()=>_StonePrefab_json__WEBPACK_IMPORTED_MODULE_18___namespace_cache||(_StonePrefab_json__WEBPACK_IMPORTED_MODULE_18___namespace_cache=__webpack_require__.t(_StonePrefab_json__WEBPACK_IMPORTED_MODULE_18__,2)),GlassShardPrefab:()=>_GlassShardPrefab_json__WEBPACK_IMPORTED_MODULE_19___namespace_cache||(_GlassShardPrefab_json__WEBPACK_IMPORTED_MODULE_19___namespace_cache=__webpack_require__.t(_GlassShardPrefab_json__WEBPACK_IMPORTED_MODULE_19__,2)),PoolPrefab:()=>_PoolPrefab_json__WEBPACK_IMPORTED_MODULE_20___namespace_cache||(_PoolPrefab_json__WEBPACK_IMPORTED_MODULE_20___namespace_cache=__webpack_require__.t(_PoolPrefab_json__WEBPACK_IMPORTED_MODULE_20__,2)),DirtPathwayPrefab:()=>_DirtPathwayPrefab_json__WEBPACK_IMPORTED_MODULE_21___namespace_cache||(_DirtPathwayPrefab_json__WEBPACK_IMPORTED_MODULE_21___namespace_cache=__webpack_require__.t(_DirtPathwayPrefab_json__WEBPACK_IMPORTED_MODULE_21__,2)),AmuletPrefab:()=>_AmuletPrefab_json__WEBPACK_IMPORTED_MODULE_22___namespace_cache||(_AmuletPrefab_json__WEBPACK_IMPORTED_MODULE_22___namespace_cache=__webpack_require__.t(_AmuletPrefab_json__WEBPACK_IMPORTED_MODULE_22__,2)),ClothArmorPrefab:()=>_ClothArmorPrefab_json__WEBPACK_IMPORTED_MODULE_23___namespace_cache||(_ClothArmorPrefab_json__WEBPACK_IMPORTED_MODULE_23___namespace_cache=__webpack_require__.t(_ClothArmorPrefab_json__WEBPACK_IMPORTED_MODULE_23__,2)),BootsPrefab:()=>_BootsPrefab_json__WEBPACK_IMPORTED_MODULE_24___namespace_cache||(_BootsPrefab_json__WEBPACK_IMPORTED_MODULE_24___namespace_cache=__webpack_require__.t(_BootsPrefab_json__WEBPACK_IMPORTED_MODULE_24__,2)),WeaponPrefab:()=>_WeaponPrefab_json__WEBPACK_IMPORTED_MODULE_25___namespace_cache||(_WeaponPrefab_json__WEBPACK_IMPORTED_MODULE_25___namespace_cache=__webpack_require__.t(_WeaponPrefab_json__WEBPACK_IMPORTED_MODULE_25__,2)),ShortswordPrefab:()=>_ShortswordPrefab_json__WEBPACK_IMPORTED_MODULE_26___namespace_cache||(_ShortswordPrefab_json__WEBPACK_IMPORTED_MODULE_26___namespace_cache=__webpack_require__.t(_ShortswordPrefab_json__WEBPACK_IMPORTED_MODULE_26__,2))});var _GameObjectPrefab_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(145),_CorpsePrefab_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(146),_VialPrefab_json__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(147),_BeingPrefab_json__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(148),_HumanoidPrefab_json__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(149),_HumanPrefab_json__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(150),_WandererPrefab_json__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(151),_HumanWandererPrefab_json__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(152),_PlayerPrefab_json__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(153),_GoalPrefab_json__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(154),_TilePrefab_json__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(155),_PineTreePrefab_json__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(156),_SmallPineTreePrefab_json__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(157),_WallPrefab_json__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(158),_WoodWallPrefab_json__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(159),_GoblinPrefab_json__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(160),_ChestPrefab_json__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(161),_DoorPrefab_json__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(162),_StonePrefab_json__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(163),_GlassShardPrefab_json__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(164),_PoolPrefab_json__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(165),_DirtPathwayPrefab_json__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(166),_AmuletPrefab_json__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(167),_ClothArmorPrefab_json__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(168),_BootsPrefab_json__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(169),_WeaponPrefab_json__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(170),_ShortswordPrefab_json__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(171)},module=>{"use strict";module.exports=JSON.parse('{"name":"GameObject","components":[{"type":"Position"},{"type":"Glyph","properties":{"char":"?"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Corpse","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Corpse"}},{"type":"Glyph","properties":{"ch":"%","fg1":"#730d14"}},{"type":"Loot"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Vial","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Vial"}},{"type":"Glyph","properties":{"ch":"!","fg2":"#66a3dc","fg1":"transparent"}},{"type":"Loot"},{"type":"Throwable"},{"type":"FragileGlass"},{"type":"LiquidContainer","properties":{"content":1,"volume":5,"maxVolume":10,"overridePrimary":true,"overrideSecondary":true,"isPourable":true}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Being","inherit":["GameObject"],"components":[{"type":"Position"},{"type":"Actor","properties":{"energy":-500}},{"type":"Health"},{"type":"Glyph","properties":{"char":"?"}},{"type":"Stats"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Humanoid","inherit":["Being"],"components":[{"type":"Glyph","properties":{"ch":"h","fg1":"#ccc"}},{"type":"EquipmentSlot","properties":{"name":"Neck","key":"neck","slotType":"EQ_SLOT_NECK"}},{"type":"EquipmentSlot","properties":{"name":"Body","key":"body","slotType":"EQ_SLOT_BODY"}},{"type":"EquipmentSlot","properties":{"name":"Left arm","key":"armLeft","slotType":"EQ_SLOT_ARM"}},{"type":"EquipmentSlot","properties":{"name":"Right hand","key":"handRight","slotType":"EQ_SLOT_HAND","isPrimary":true}},{"type":"EquipmentSlot","properties":{"name":"Right arm","key":"armRight","slotType":"EQ_SLOT_ARM"}},{"type":"EquipmentSlot","properties":{"name":"Left hand","key":"handLeft","slotType":"EQ_SLOT_HAND","isOffhand":true}},{"type":"EquipmentSlot","properties":{"name":"Feet","key":"feet","slotType":"EQ_SLOT_FEET"}},{"type":"Body"},{"type":"Legs"},{"type":"Eyes","properties":{"range":10}},{"type":"FactionMember","properties":{"name":"neutral"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Human","inherit":["Humanoid"],"components":[{"type":"Race","properties":{"key":"RACE_HUMAN"}},{"type":"Glyph","properties":{"ch":"h","fg1":"pink"}},{"type":"FactionMember","properties":{"name":"villager"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Wanderer","components":[{"type":"Moniker","properties":{"name":"Wanderer"}},{"type":"Wandering"},{"type":"Brain"},{"type":"Logger"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"HumanWanderer","inherit":["Human","Wanderer"],"components":[{"type":"LootDropper","properties":{"tables":["TBL_LOOT_GOBLIN","TBL_LOOT_FOREST"]}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Player","inherit":["Human"],"components":[{"type":"Actor","properties":{"energy":0}},{"type":"Health","properties":{"value":24,"max":24}},{"type":"Moniker","properties":{"name":"Player"}},{"type":"Glyph","properties":{"ch":"@","fg1":"#d0d6d8","fg2":"#66a3dc"}},{"type":"IsPlayer"},{"type":"FactionMember","properties":{"name":"player"}},{"type":"Inventory"},{"type":"Logger"},{"type":"Stats","properties":{"baseStrength":15,"baseFinesse":15,"baseAthleticism":15,"baseTrickery":12}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Goal","components":[{"type":"Goal"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Tile","components":[{"type":"Position"},{"type":"Explorable"},{"type":"Glyph","properties":{"ch":".","fg1":"#444"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"PineTree","inherit":["Tile"],"components":[{"type":"Moniker","properties":{"name":"Pine Tree"}},{"type":"Glyph","properties":{"ch":"♣","fg1":"#467548","fg2":"#744931"}},{"type":"Blocker"},{"type":"Shadowcaster"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"SmallPineTree","inherit":["PineTree"],"components":[{"type":"Glyph","properties":{"ch":"♠","fg1":"#467548","fg2":"#744931"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Wall","inherit":["Tile"],"components":[{"type":"Moniker","properties":{"name":"Wall"}},{"type":"Glyph","properties":{"ch":"#","fg1":"#556267","fg2":"#556267"}},{"type":"Blocker"},{"type":"Shadowcaster"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"WoodWall","inherit":["Wall"],"components":[{"type":"Moniker","properties":{"name":"Wooden wall"}},{"type":"Glyph","properties":{"ch":"H","fg1":"#923e2b"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Goblin","inherit":["Humanoid","Wanderer"],"components":[{"type":"Race","properties":{"key":"RACE_GOBLIN"}},{"type":"Moniker","properties":{"name":"Goblin"}},{"type":"Glyph","properties":{"ch":"g","fg1":"#5d8250"}},{"type":"FactionMember","properties":{"name":"goblin"}},{"type":"LootDropper","properties":{"tables":["TBL_LOOT_GOBLIN","TBL_LOOT_FOREST"]}},{"type":"Stats","properties":{"baseStrength":12,"baseFinesse":8,"baseAthleticism":15,"baseTrickery":16}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Chest","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Chest"}},{"type":"Glyph","properties":{"ch":"⌂","fg1":"#a66b44"}},{"type":"Inventory"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Door","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Door"}},{"type":"Glyph","properties":{"ch":"+","fg1":"#923e2b"}},{"type":"Door","properties":{"chOpen":"\'","chClosed":"+"}},{"type":"Blocker"},{"type":"Explorable"},{"type":"Shadowcaster"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Stone","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Stone"}},{"type":"Glyph","properties":{"ch":":","fg1":"#c8b5b7"}},{"type":"Loot"},{"type":"Throwable"},{"type":"Stackable","properties":{"identifier":"STACKABLE_STONE"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"GlassShard","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Glass shard"}},{"type":"Glyph","properties":{"ch":"«","fg1":"#c8b5b7"}},{"type":"Loot"},{"type":"Stackable","properties":{"identifier":"STACKABLE_GLASS_SHARD"}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Pool","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Pool"}},{"type":"Glyph","properties":{"ch":"≈","fg2":"#66a3dc","fg1":"transparent"}},{"type":"LiquidContainer","properties":{"content":1,"volume":10,"maxVolume":100,"overridePrimary":true,"overrideSecondary":true,"destroyOnEmpty":true}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"DirtPathway","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Dirt path"}},{"type":"Glyph","properties":{"ch":"░","fg1":"#a66b44"}},{"type":"Explorable"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Amulet","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Amulet"}},{"type":"Glyph","properties":{"ch":"ü","fg1":"#44c081","fg2":"#9eafb3"}},{"type":"Loot"},{"type":"Equipment","properties":{"slotTypes":["EQ_SLOT_NECK","EQ_SLOT_ARM"]}},{"type":"Throwable"}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"ClothArmor","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Cloth armor"}},{"type":"Glyph","properties":{"ch":"[","fg1":"#587546","fg2":"#402f20"}},{"type":"Loot"},{"type":"Equipment","properties":{"slotTypes":["EQ_SLOT_BODY"]}},{"type":"Armor","properties":{"value":1}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Boots","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Boots"}},{"type":"Glyph","properties":{"ch":"£","fg1":"#923e2b"}},{"type":"Loot"},{"type":"Equipment","properties":{"slotTypes":["EQ_SLOT_FEET"]}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Weapon","inherit":["GameObject"],"components":[{"type":"Moniker","properties":{"name":"Weapon"}},{"type":"Glyph","properties":{"ch":"(","fg1":"silver"}},{"type":"Weapon","properties":{"weaponType":"WPN_TYPE_DAGGER"}},{"type":"Loot"},{"type":"Equipment","properties":{"slotTypes":["EQ_SLOT_HAND"]}}]}')},module=>{"use strict";module.exports=JSON.parse('{"name":"Shortsword","inherit":["Weapon"],"components":[{"type":"Moniker","properties":{"name":"Shortsword"}},{"type":"Glyph","properties":{"ch":"(","fg1":"silver"}},{"type":"Weapon","properties":{"weaponType":"WPN_TYPE_SHORTSWORD"}}]}')},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>GameStateManager});var _Manager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _isStarted=new WeakMap,_filename=new WeakMap,GameStateManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(GameStateManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(GameStateManager);function GameStateManager(){var _this;_classCallCheck(this,GameStateManager);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_isStarted.set(_assertThisInitialized(_this),{writable:!0,value:!1}),_filename.set(_assertThisInitialized(_this),{writable:!0,value:"test"}),_this}return Constructor=GameStateManager,(protoProps=[{key:"gameOver",value:function(){_classPrivateFieldSet(this,_isStarted,!1)}},{key:"initiateTeardown",value:function(){console.log("STATE - teardown"),_classPrivateFieldSet(this,_isStarted,!1),this.game.player.teardown(),this.game.map.teardown(),this.game.engine.teardown(),this.game.world.teardown()}},{key:"initiateSetup",value:function(data){console.log("STATE - setup"),_classPrivateFieldSet(this,_isStarted,!0),this.game.clock.setup(data.clock),this.game.player.setup(data.player),this.game.world.setup(data.world),this.game.map.setup(data.map)}},{key:"newGame",value:function(){_classPrivateFieldSet(this,_filename,prompt("Enter save name","test")),this.deleteFile(this.filename),this.initiateTeardown();var data={filename:this.filename,clock:this.game.clock.getSetupData(),player:this.game.player.getSetupData(),world:this.game.world.getSetupData(),map:this.game.map.getSetupData()};this.initiateSetup(data)}},{key:"saveGame",value:function(){if(this.isStarted){var data={filename:this.filename,clock:this.game.clock.getSaveGameData(),map:this.game.map.getSaveGameData(),player:this.game.player.getSaveGameData(),world:this.game.world.getSaveGameData()};return console.log("save data",data),localStorage.setItem(this.filename,JSON.stringify(data)),data}console.warn("cannot save game since it's not started")}},{key:"deleteFile",value:function(filename){Object.keys(localStorage).forEach((function(file){file.startsWith("".concat(filename,"-"))&&localStorage.removeItem(file)}))}},{key:"saveSectorPositionData",value:function(sectorId,positionData){localStorage.setItem("".concat(this.filename,"-").concat(sectorId,"-positions"),JSON.stringify(positionData))}},{key:"saveSectorEntityData",value:function(sectorId,entityData){localStorage.setItem("".concat(this.filename,"-").concat(sectorId,"-entities"),JSON.stringify(entityData))}},{key:"loadSectorEntityData",value:function(sectorId){var json=localStorage.getItem("".concat(this.filename,"-").concat(sectorId,"-entities"));return json&&JSON.parse(json)}},{key:"loadSectorPositionData",value:function(sectorId){var json=localStorage.getItem("".concat(this.filename,"-").concat(sectorId,"-positions"));return json&&JSON.parse(json)}},{key:"loadSavefileData",value:function(filename){var json=localStorage.getItem(filename);return json&&JSON.parse(json)}},{key:"loadGame",value:function(){var filename=prompt("Enter save filename to load","test"),data=this.loadSavefileData(filename);data||console.warn("save file ".concat(filename," not found")),_classPrivateFieldSet(this,_filename,filename),console.log("Loading game",data),this.initiateTeardown(),this.initiateSetup(data)}},{key:"loadGameData",value:function(data){this.initiateTeardown(),this.initiateSetup(data)}},{key:"filename",get:function(){return _classPrivateFieldGet(this,_filename)}},{key:"isStarted",get:function(){return _classPrivateFieldGet(this,_isStarted)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),GameStateManager}(_Manager__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ClockManager});var _Manager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _tick=new WeakMap,_tickDelta=new WeakMap,ClockManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ClockManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(ClockManager);function ClockManager(){var _this;_classCallCheck(this,ClockManager);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_tick.set(_assertThisInitialized(_this),{writable:!0,value:0}),_tickDelta.set(_assertThisInitialized(_this),{writable:!0,value:0}),_this}return Constructor=ClockManager,(protoProps=[{key:"getSetupData",value:function(){return{tick:0,tickDelta:0}}},{key:"getSaveGameData",value:function(){return{tick:this.tick,tickDelta:this.tickDelta}}},{key:"setup",value:function(data){_classPrivateFieldSet(this,_tick,data.tick),_classPrivateFieldSet(this,_tickDelta,data.tickDelta)}},{key:"incrementTick",value:function(delta){_classPrivateFieldSet(this,_tickDelta,delta),_classPrivateFieldSet(this,_tick,_classPrivateFieldGet(this,_tick)+delta)}},{key:"update",value:function(dt){_classPrivateFieldSet(this,_tickDelta,0)}},{key:"tick",get:function(){return _classPrivateFieldGet(this,_tick)}},{key:"tickDelta",get:function(){return _classPrivateFieldGet(this,_tickDelta)}},{key:"turn",get:function(){return Math.floor(_classPrivateFieldGet(this,_tick)/1e3)}},{key:"subTurn",get:function(){return _classPrivateFieldGet(this,_tick)-1e3*this.turn}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ClockManager}(_Manager__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CursorSystem});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_enums_Directions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83),_System__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _isEnabled=new WeakMap,_x=new WeakMap,_y=new WeakMap,CursorSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CursorSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(CursorSystem);function CursorSystem(){var _this;_classCallCheck(this,CursorSystem);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_isEnabled.set(_assertThisInitialized(_this),{writable:!0,value:!1}),_x.set(_assertThisInitialized(_this),{writable:!0,value:1}),_y.set(_assertThisInitialized(_this),{writable:!0,value:1}),_this}return Constructor=CursorSystem,(protoProps=[{key:"enable",value:function(){var player=this.game.player.position;_classPrivateFieldSet(this,_x,player.x),_classPrivateFieldSet(this,_y,player.y),_classPrivateFieldSet(this,_isEnabled,!0)}},{key:"disable",value:function(){_classPrivateFieldSet(this,_isEnabled,!1)}},{key:"toggle",value:function(){this.isEnabled?this.disable():this.enable()}},{key:"move",value:function(direction){var delta=_enums_Directions__WEBPACK_IMPORTED_MODULE_1__.delta(direction);_classPrivateFieldSet(this,_x,_classPrivateFieldGet(this,_x)+delta.x),_classPrivateFieldSet(this,_y,_classPrivateFieldGet(this,_y)+delta.y)}},{key:"getEntities",value:function(){return this.game.map.getEntitiesAt(this.x,this.y).filter((function(e){return e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsVisible)}))}},{key:"drawCursor",value:function(){var color=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yellow",screen=this.game.camera.worldToScreen(this.x,this.y);this.game.renderer.draw(screen.x,screen.y,"X",color)}},{key:"drawTags",value:function(){var _this2=this,entities=this.getEntities().filter((function(e){return e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_0__.Moniker)})),screen=this.game.camera.worldToScreen(this.x,this.y);screen.x<this.game.camera.width/2?entities.forEach((function(entity,i){var c=0===i?"◄":" ";_this2.game.renderer.drawText(screen.x+1,screen.y+i,"".concat(c,"█"),"#ddd"),_this2.game.renderer.drawText(screen.x+2,screen.y+i,entity.moniker.display+" ","#111133","white","#ddd")})):entities.forEach((function(entity,i){var c=0===i?"►":" ";_this2.game.renderer.drawText(screen.x-1,screen.y+i,"█".concat(c),"#ddd");var len=_this2.game.renderer.computeTextWidth(entity.moniker.display);_this2.game.renderer.drawText(screen.x-len-1.5,screen.y+i," "+entity.moniker.display,"#111133","white","#ddd")}))}},{key:"x",get:function(){return _classPrivateFieldGet(this,_x)}},{key:"y",get:function(){return _classPrivateFieldGet(this,_y)}},{key:"isEnabled",get:function(){return _classPrivateFieldGet(this,_isEnabled)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CursorSystem}(_System__WEBPACK_IMPORTED_MODULE_2__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>MapManager});var _Manager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_utils_FastMap__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(176),_ecs_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _playerOutOfBounds=new WeakMap,_lookup=new WeakMap,_width=new WeakMap,_height=new WeakMap,MapManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MapManager,_Manager);var _super=_createSuper(MapManager);function MapManager(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MapManager),_this=_super.call(this,game),_playerOutOfBounds.set(_assertThisInitialized(_this),{writable:!0,value:null}),_lookup.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_width.set(_assertThisInitialized(_this),{writable:!0,value:32}),_height.set(_assertThisInitialized(_this),{writable:!0,value:32}),_this.query=_this.game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_2__.Position]}),_classPrivateFieldSet(_assertThisInitialized(_this),_lookup,new _utils_FastMap__WEBPACK_IMPORTED_MODULE_1__.default(_this.width,_this.height)),_this.query.onEntityAdded((function(e){_classPrivateFieldGet(_assertThisInitialized(_this),_lookup).set(0,0,e.id)})),_this.query.onEntityRemoved((function(e){_classPrivateFieldGet(_assertThisInitialized(_this),_lookup).remove(e.id)})),_this}return _createClass(MapManager,[{key:"width",get:function(){return _classPrivateFieldGet(this,_width)}},{key:"height",get:function(){return _classPrivateFieldGet(this,_height)}}]),_createClass(MapManager,[{key:"getSetupData",value:function(){return{}}},{key:"teardown",value:function(){_classPrivateFieldSet(this,_playerOutOfBounds,!1),_classPrivateFieldGet(this,_lookup).clear()}},{key:"setup",value:function(data){if(data.playerPosition)this.game.player.entity.position.setPos(data.playerPosition.x,data.playerPosition.y);else{var position=this.getRandomEmptyPosition();this.game.player.entity.position.setPos(position.x,position.y)}this.game.FOVSystem.computeFOV()}},{key:"getSaveGameData",value:function(){var data=_classPrivateFieldGet(this,_lookup).serialize();return this.game.state.saveSectorPositionData(this.game.world.sectorId,data),{playerPosition:this.game.player.position}}},{key:"onSectorLoaded",value:function(sector){_classPrivateFieldSet(this,_playerOutOfBounds,!1);var data=this.game.state.loadSectorPositionData(sector.id);data&&_classPrivateFieldGet(this,_lookup).deserialize(data)}},{key:"getPosition",value:function(entityId){return _classPrivateFieldGet(this,_lookup).getPosition(entityId)}},{key:"setPosition",value:function(x,y,entityId){_classPrivateFieldGet(this,_lookup).isOutOfBounds(x,y)?this.game.player.id===entityId&&_classPrivateFieldSet(this,_playerOutOfBounds,{x,y}):(_classPrivateFieldGet(this,_lookup).set(x,y,entityId),entityId===this.game.player.id&&this.game.camera.setFocus(x,y))}},{key:"getEntitiesAt",value:function(x,y){var _this2=this;return _classPrivateFieldGet(this,_lookup).get(x,y).map((function(id){return _this2.game.ecs.getEntity(id)})).filter((function(e){return!e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_2__.IsInventoried)}))}},{key:"isAdjacent",value:function(x1,y1,x2,y2){return Math.abs(x1-x2)<=1&&Math.abs(y1-y2)<=1}},{key:"getEntitiesInRect",value:function(x,y,width,height){for(var entities=[],i=x;i<x+width+1;i++)for(var j=y;j<y+height+1;j++)entities.push.apply(entities,_toConsumableArray(this.getEntitiesAt(i,j)));return entities}},{key:"getEntitiesInRange",value:function(x,y,range){var diameter=2*range;return this.getEntitiesInRect(x-range,y-range,diameter,diameter)}},{key:"getNeighborEntities",value:function(x,y){return[this.getEntitiesAt(x-1,y-1),this.getEntitiesAt(x,y-1),this.getEntitiesAt(x+1,y-1),this.getEntitiesAt(x-1,y),this.getEntitiesAt(x+1,y),this.getEntitiesAt(x-1,y+1),this.getEntitiesAt(x,y+1),this.getEntitiesAt(x+1,y+1)]}},{key:"getRandomEmptyPosition",value:function(){var x,y;do{x=Math.trunc(Math.random()*this.width),y=Math.trunc(Math.random()*this.height)}while(this.getEntitiesAt(x,y).length>0);return{x,y}}},{key:"isOutOfbounds",value:function(x,y){return x<0||y<0||x>=this.width||y>=this.height}},{key:"onPlayerOutOfBounds",value:function(x,y){y<0&&this.game.world.enterSector(this.game.world.sector.northSector,{x,y:this.height-1}),y>=this.height&&this.game.world.enterSector(this.game.world.sector.southSector,{x,y:0}),x>=this.width&&this.game.world.enterSector(this.game.world.sector.eastSector,{x:0,y}),x<0&&this.game.world.enterSector(this.game.world.sector.westSector,{x:this.width-1,y})}},{key:"update",value:function(dt){_classPrivateFieldGet(this,_playerOutOfBounds)&&this.onPlayerOutOfBounds(_classPrivateFieldGet(this,_playerOutOfBounds).x,_classPrivateFieldGet(this,_playerOutOfBounds).y)}}]),MapManager}(_Manager__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>FastMap});var FastMap=function(){function FastMap(width,height){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FastMap),_defineProperty(this,"_width",0),_defineProperty(this,"_height",0),_defineProperty(this,"_data",[]),_defineProperty(this,"_idHash",new Map),this._width=width,this._height=height;for(var i=0;i<this.size;i++)this._data[i]=new Set}return _createClass(FastMap,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"size",get:function(){return this._width*this._height}}]),_createClass(FastMap,[{key:"idx",value:function(x,y){return y*this.width+x}},{key:"coord",value:function(idx){return{x:Math.trunc(idx%this.width),y:Math.trunc(idx/this.width)}}},{key:"clear",value:function(){this._idHash.clear();for(var i=0;i<this.size;i++)this._data[i].clear()}},{key:"serialize",value:function(){var entries=this._data.map((function(d){return Array.from(d)}));return{width:this.width,height:this.height,entries}}},{key:"deserialize",value:function(data){var _this=this;this._width=data.width,this._height=data.height,this._idHash=new Map;for(var _loop=function(i){var coord=_this.coord(i);_this._data[i]=new Set(data.entries[i]),data.entries[i].forEach((function(id){_this._idHash.set(id,coord)}))},i=0;i<data.entries.length;i++)_loop(i)}},{key:"set",value:function(x,y,id){if(this.isOutOfBounds(x,y))console.warn("Trying to set an entity ".concat(id," position out-of-bounds ").concat(x,", ").concat(y));else{var idx=this.idx(x,y);this.remove(id),this._idHash.set(id,{x,y}),this._data[idx].add(id)}}},{key:"get",value:function(x,y){return this.isOutOfBounds(x,y)?[]:Array.from(this._data[this.idx(x,y)])}},{key:"has",value:function(id){return this._idHash.has(id)}},{key:"getPosition",value:function(id){var pos=this._idHash.get(id);return pos||console.warn("Cannot get position",id),pos}},{key:"remove",value:function(id){if(this.has(id)){var pos=this.getPosition(id),idx=this.idx(pos.x,pos.y);this._idHash.delete(id),this._data[idx].delete(id)}}},{key:"isOutOfBounds",value:function(x,y){return x<0||y<0||x>=this.width||y>=this.height}}]),FastMap}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>FOVSystem});var rot_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(178),_ecs_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var FOVSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(FOVSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(FOVSystem);function FOVSystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FOVSystem),(_this=_super.call(this,game)).fov=new rot_js__WEBPACK_IMPORTED_MODULE_0__.FOV.PreciseShadowcasting((function(x,y){return _this.isSquareVisible(x,y)})),_this.query=_this.game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsVisible]}),_this}return Constructor=FOVSystem,(protoProps=[{key:"isSquareVisible",value:function(x,y){return!this.game.map.getEntitiesAt(x,y).some((function(e){return e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Shadowcaster)}))}},{key:"setVisible",value:function(x,y,amount,range){this.game.map.getEntitiesAt(x,y).forEach((function(e){e.add(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsVisible,{range,amount}),e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Explorable)&&!e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Explored)&&e.add(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Explored)}))}},{key:"computeFOV",value:function(){var _this2=this;this.query.get().forEach((function(e){return e.isVisible.destroy()}));var pos=this.game.player.position;this.fov.compute(pos.x,pos.y,12,(function(x,y,r,visibility){_this2.setVisible(x,y,visibility,r)}))}},{key:"update",value:function(dt){this.game.clock.tickDelta&&this.computeFOV()}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),FOVSystem}(__webpack_require__(114).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RNG:()=>_rng_js__WEBPACK_IMPORTED_MODULE_0__.default,Display:()=>_display_display_js__WEBPACK_IMPORTED_MODULE_1__.default,StringGenerator:()=>_stringgenerator_js__WEBPACK_IMPORTED_MODULE_2__.default,EventQueue:()=>_eventqueue_js__WEBPACK_IMPORTED_MODULE_3__.default,Scheduler:()=>_scheduler_index_js__WEBPACK_IMPORTED_MODULE_4__.default,FOV:()=>_fov_index_js__WEBPACK_IMPORTED_MODULE_5__.default,Map:()=>_map_index_js__WEBPACK_IMPORTED_MODULE_6__.default,Noise:()=>_noise_index_js__WEBPACK_IMPORTED_MODULE_7__.default,Path:()=>_path_index_js__WEBPACK_IMPORTED_MODULE_8__.default,Engine:()=>_engine_js__WEBPACK_IMPORTED_MODULE_9__.default,Lighting:()=>_lighting_js__WEBPACK_IMPORTED_MODULE_10__.default,DEFAULT_WIDTH:()=>_constants_js__WEBPACK_IMPORTED_MODULE_11__.DEFAULT_WIDTH,DEFAULT_HEIGHT:()=>_constants_js__WEBPACK_IMPORTED_MODULE_11__.DEFAULT_HEIGHT,DIRS:()=>_constants_js__WEBPACK_IMPORTED_MODULE_11__.DIRS,KEYS:()=>_constants_js__WEBPACK_IMPORTED_MODULE_11__.KEYS,Util:()=>Util,Color:()=>Color,Text:()=>Text});var _rng_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(179),_display_display_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(180),_stringgenerator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(191),_eventqueue_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(139),_scheduler_index_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(192),_fov_index_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(195),_map_index_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(200),_noise_index_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(212),_path_index_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(215),_engine_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(219),_lighting_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(220),_constants_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(190),_util_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(107),_color_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(187),_text_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(189),Util=_util_js__WEBPACK_IMPORTED_MODULE_12__,Color=_color_js__WEBPACK_IMPORTED_MODULE_13__,Text=_text_js__WEBPACK_IMPORTED_MODULE_14__},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var FRAC=2.3283064365386963e-10;const __WEBPACK_DEFAULT_EXPORT__=(new(function(){function RNG(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RNG),this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}var Constructor,protoProps,staticProps;return Constructor=RNG,(protoProps=[{key:"getSeed",value:function(){return this._seed}},{key:"setSeed",value:function(seed){return seed=seed<1?1/seed:seed,this._seed=seed,this._s0=(seed>>>0)*FRAC,seed=69069*seed+1>>>0,this._s1=seed*FRAC,seed=69069*seed+1>>>0,this._s2=seed*FRAC,this._c=1,this}},{key:"getUniform",value:function(){var t=2091639*this._s0+this._c*FRAC;return this._s0=this._s1,this._s1=this._s2,this._c=0|t,this._s2=t-this._c,this._s2}},{key:"getUniformInt",value:function(lowerBound,upperBound){var max=Math.max(lowerBound,upperBound),min=Math.min(lowerBound,upperBound);return Math.floor(this.getUniform()*(max-min+1))+min}},{key:"getNormal",value:function(){var u,v,r,mean=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,stddev=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;do{r=(u=2*this.getUniform()-1)*u+(v=2*this.getUniform()-1)*v}while(r>1||0==r);var gauss=u*Math.sqrt(-2*Math.log(r)/r);return mean+gauss*stddev}},{key:"getPercentage",value:function(){return 1+Math.floor(100*this.getUniform())}},{key:"getItem",value:function(array){return array.length?array[Math.floor(this.getUniform()*array.length)]:null}},{key:"shuffle",value:function(array){for(var result=[],clone=array.slice();clone.length;){var index=clone.indexOf(this.getItem(clone));result.push(clone.splice(index,1)[0])}return result}},{key:"getWeightedValue",value:function(data){var total=0;for(var _id in data)total+=data[_id];var id,random=this.getUniform()*total,part=0;for(id in data)if(random<(part+=data[id]))return id;return id}},{key:"getState",value:function(){return[this._s0,this._s1,this._s2,this._c]}},{key:"setState",value:function(state){return this._s0=state[0],this._s1=state[1],this._s2=state[2],this._c=state[3],this}},{key:"clone",value:function(){var clone=new RNG;return clone.setState(this.getState())}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),RNG}())).setSeed(Date.now())},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _hex_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(181),_rect_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(184),_tile_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(185),_tile_gl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(186),_term_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(188),_text_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(189),_constants_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(190);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var BACKENDS={hex:_hex_js__WEBPACK_IMPORTED_MODULE_0__.default,rect:_rect_js__WEBPACK_IMPORTED_MODULE_1__.default,tile:_tile_js__WEBPACK_IMPORTED_MODULE_2__.default,"tile-gl":_tile_gl_js__WEBPACK_IMPORTED_MODULE_3__.default,term:_term_js__WEBPACK_IMPORTED_MODULE_4__.default},DEFAULT_OPTIONS={width:_constants_js__WEBPACK_IMPORTED_MODULE_6__.DEFAULT_WIDTH,height:_constants_js__WEBPACK_IMPORTED_MODULE_6__.DEFAULT_HEIGHT,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};const __WEBPACK_DEFAULT_EXPORT__=function(){var Display=function(){function Display(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Display),this._data={},this._dirty=!1,this._options={},options=Object.assign({},DEFAULT_OPTIONS,options),this.setOptions(options),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}var Constructor,protoProps,staticProps;return Constructor=Display,(protoProps=[{key:"DEBUG",value:function(x,y,what){var colors=[this._options.bg,this._options.fg];this.draw(x,y,null,null,colors[what%colors.length])}},{key:"clear",value:function(){this._data={},this._dirty=!0}},{key:"setOptions",value:function(options){if(Object.assign(this._options,options),options.width||options.height||options.fontSize||options.fontFamily||options.spacing||options.layout){if(options.layout){var ctor=BACKENDS[options.layout];this._backend=new ctor}this._backend.setOptions(this._options),this._dirty=!0}return this}},{key:"getOptions",value:function(){return this._options}},{key:"getContainer",value:function(){return this._backend.getContainer()}},{key:"computeSize",value:function(availWidth,availHeight){return this._backend.computeSize(availWidth,availHeight)}},{key:"computeFontSize",value:function(availWidth,availHeight){return this._backend.computeFontSize(availWidth,availHeight)}},{key:"computeTileSize",value:function(availWidth,availHeight){return[Math.floor(availWidth/this._options.width),Math.floor(availHeight/this._options.height)]}},{key:"eventToPosition",value:function(e){var x,y;return"touches"in e?(x=e.touches[0].clientX,y=e.touches[0].clientY):(x=e.clientX,y=e.clientY),this._backend.eventToPosition(x,y)}},{key:"draw",value:function(x,y,ch,fg,bg){fg||(fg=this._options.fg),bg||(bg=this._options.bg);var key="".concat(x,",").concat(y);this._data[key]=[x,y,ch,fg,bg],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[key]=!0)}},{key:"drawText",value:function(x,y,text,maxWidth){var fg=null,bg=null,cx=x,cy=y,lines=1;maxWidth||(maxWidth=this._options.width-x);for(var tokens=_text_js__WEBPACK_IMPORTED_MODULE_5__.tokenize(text,maxWidth);tokens.length;){var token=tokens.shift();switch(token.type){case _text_js__WEBPACK_IMPORTED_MODULE_5__.TYPE_TEXT:for(var isSpace=!1,isPrevSpace=!1,isFullWidth=!1,isPrevFullWidth=!1,i=0;i<token.value.length;i++){var cc=token.value.charCodeAt(i),c=token.value.charAt(i);if("term"===this._options.layout){var cch=cc>>8;if(17===cch||cch>=46&&cch<=159||cch>=172&&cch<=215||cc>=43360&&cc<=43391){this.draw(cx+0,cy,c,fg,bg),this.draw(cx+1,cy,"\t",fg,bg),cx+=2;continue}}isFullWidth=cc>65280&&cc<65377||cc>65500&&cc<65512||cc>65518,isSpace=32==c.charCodeAt(0)||12288==c.charCodeAt(0),!isPrevFullWidth||isFullWidth||isSpace||cx++,isFullWidth&&!isPrevSpace&&cx++,this.draw(cx++,cy,c,fg,bg),isPrevSpace=isSpace,isPrevFullWidth=isFullWidth}break;case _text_js__WEBPACK_IMPORTED_MODULE_5__.TYPE_FG:fg=token.value||null;break;case _text_js__WEBPACK_IMPORTED_MODULE_5__.TYPE_BG:bg=token.value||null;break;case _text_js__WEBPACK_IMPORTED_MODULE_5__.TYPE_NEWLINE:cx=x,cy++,lines++}}return lines}},{key:"_tick",value:function(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty)for(var id in this._backend.clear(),this._data)this._draw(id,!1);else for(var key in this._dirty)this._draw(key,!0);this._dirty=!1}}},{key:"_draw",value:function(key,clearBefore){var data=this._data[key];data[4]!=this._options.bg&&(clearBefore=!0),this._backend.draw(data,clearBefore)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Display}();return Display.Rect=_rect_js__WEBPACK_IMPORTED_MODULE_1__.default,Display.Hex=_hex_js__WEBPACK_IMPORTED_MODULE_0__.default,Display.Tile=_tile_js__WEBPACK_IMPORTED_MODULE_2__.default,Display.TileGL=_tile_gl_js__WEBPACK_IMPORTED_MODULE_3__.default,Display.Term=_term_js__WEBPACK_IMPORTED_MODULE_4__.default,Display}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Hex});var _canvas_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(182),_util_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(107);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Hex=function(_Canvas){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Hex,_Canvas);var Constructor,protoProps,staticProps,_super=_createSuper(Hex);function Hex(){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Hex),(_this=_super.call(this))._spacingX=0,_this._spacingY=0,_this._hexSize=0,_this}return Constructor=Hex,(protoProps=[{key:"draw",value:function(data,clearBefore){var _data=_slicedToArray(data,5),x=_data[0],y=_data[1],ch=_data[2],fg=_data[3],bg=_data[4],px=[(x+1)*this._spacingX,y*this._spacingY+this._hexSize];if(this._options.transpose&&px.reverse(),clearBefore&&(this._ctx.fillStyle=bg,this._fill(px[0],px[1])),ch){this._ctx.fillStyle=fg;for(var chars=[].concat(ch),i=0;i<chars.length;i++)this._ctx.fillText(chars[i],px[0],Math.ceil(px[1]))}}},{key:"computeSize",value:function(availWidth,availHeight){return this._options.transpose&&(availWidth+=availHeight,availWidth-=availHeight=availWidth-availHeight),[Math.floor(availWidth/this._spacingX)-1,Math.floor((availHeight-2*this._hexSize)/this._spacingY+1)]}},{key:"computeFontSize",value:function(availWidth,availHeight){this._options.transpose&&(availWidth+=availHeight,availWidth-=availHeight=availWidth-availHeight);var hexSizeWidth=2*availWidth/((this._options.width+1)*Math.sqrt(3))-1,hexSizeHeight=availHeight/(2+1.5*(this._options.height-1)),hexSize=Math.min(hexSizeWidth,hexSizeHeight),oldFont=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;var width=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=oldFont;var ratio=width/100,fontSize=2*(hexSize=Math.floor(hexSize)+1)/(this._options.spacing*(1+ratio/Math.sqrt(3)));return Math.ceil(fontSize)-1}},{key:"_normalizedEventToPosition",value:function(x,y){var nodeSize;this._options.transpose?(x+=y,x-=y=x-y,nodeSize=this._ctx.canvas.width):nodeSize=this._ctx.canvas.height;var size=nodeSize/this._options.height;return y=Math.floor(y/size),(0,_util_js__WEBPACK_IMPORTED_MODULE_1__.mod)(y,2)?(x-=this._spacingX,x=1+2*Math.floor(x/(2*this._spacingX))):x=2*Math.floor(x/(2*this._spacingX)),[x,y]}},{key:"_fill",value:function(cx,cy){var a=this._hexSize,b=this._options.border,ctx=this._ctx;ctx.beginPath(),this._options.transpose?(ctx.moveTo(cx-a+b,cy),ctx.lineTo(cx-a/2+b,cy+this._spacingX-b),ctx.lineTo(cx+a/2-b,cy+this._spacingX-b),ctx.lineTo(cx+a-b,cy),ctx.lineTo(cx+a/2-b,cy-this._spacingX+b),ctx.lineTo(cx-a/2+b,cy-this._spacingX+b),ctx.lineTo(cx-a+b,cy)):(ctx.moveTo(cx,cy-a+b),ctx.lineTo(cx+this._spacingX-b,cy-a/2+b),ctx.lineTo(cx+this._spacingX-b,cy+a/2-b),ctx.lineTo(cx,cy+a-b),ctx.lineTo(cx-this._spacingX+b,cy+a/2-b),ctx.lineTo(cx-this._spacingX+b,cy-a/2+b),ctx.lineTo(cx,cy-a+b)),ctx.fill()}},{key:"_updateSize",value:function(){var xprop,yprop,opts=this._options,charWidth=Math.ceil(this._ctx.measureText("W").width);this._hexSize=Math.floor(opts.spacing*(opts.fontSize+charWidth/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,opts.transpose?(xprop="height",yprop="width"):(xprop="width",yprop="height"),this._ctx.canvas[xprop]=Math.ceil((opts.width+1)*this._spacingX),this._ctx.canvas[yprop]=Math.ceil((opts.height-1)*this._spacingY+2*this._hexSize)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Hex}(_canvas_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Canvas});var Canvas=function(_Backend){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Canvas,_Backend);var Constructor,protoProps,staticProps,_super=_createSuper(Canvas);function Canvas(){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Canvas),(_this=_super.call(this))._ctx=document.createElement("canvas").getContext("2d"),_this}return Constructor=Canvas,(protoProps=[{key:"schedule",value:function(cb){requestAnimationFrame(cb)}},{key:"getContainer",value:function(){return this._ctx.canvas}},{key:"setOptions",value:function(opts){_get(_getPrototypeOf(Canvas.prototype),"setOptions",this).call(this,opts);var style=opts.fontStyle?"".concat(opts.fontStyle," "):"",font="".concat(style," ").concat(opts.fontSize,"px ").concat(opts.fontFamily);this._ctx.font=font,this._updateSize(),this._ctx.font=font,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}},{key:"clear",value:function(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}},{key:"eventToPosition",value:function(x,y){var canvas=this._ctx.canvas,rect=canvas.getBoundingClientRect();return x-=rect.left,y-=rect.top,x*=canvas.width/rect.width,y*=canvas.height/rect.height,x<0||y<0||x>=canvas.width||y>=canvas.height?[-1,-1]:this._normalizedEventToPosition(x,y)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Canvas}(__webpack_require__(183).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Backend});var Backend=function(){function Backend(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Backend)}var Constructor,protoProps,staticProps;return Constructor=Backend,(protoProps=[{key:"getContainer",value:function(){return null}},{key:"setOptions",value:function(options){this._options=options}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Backend}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _canvas_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(182);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}const __WEBPACK_DEFAULT_EXPORT__=function(){var Rect=function(_Canvas){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Rect,_Canvas);var Constructor,protoProps,staticProps,_super=_createSuper(Rect);function Rect(){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Rect),(_this=_super.call(this))._spacingX=0,_this._spacingY=0,_this._canvasCache={},_this}return Constructor=Rect,(protoProps=[{key:"setOptions",value:function(options){_get(_getPrototypeOf(Rect.prototype),"setOptions",this).call(this,options),this._canvasCache={}}},{key:"draw",value:function(data,clearBefore){Rect.cache?this._drawWithCache(data):this._drawNoCache(data,clearBefore)}},{key:"_drawWithCache",value:function(data){var canvas,_data=_slicedToArray(data,5),x=_data[0],y=_data[1],ch=_data[2],fg=_data[3],bg=_data[4],hash=""+ch+fg+bg;if(hash in this._canvasCache)canvas=this._canvasCache[hash];else{var b=this._options.border,ctx=(canvas=document.createElement("canvas")).getContext("2d");if(canvas.width=this._spacingX,canvas.height=this._spacingY,ctx.fillStyle=bg,ctx.fillRect(b,b,canvas.width-b,canvas.height-b),ch){ctx.fillStyle=fg,ctx.font=this._ctx.font,ctx.textAlign="center",ctx.textBaseline="middle";for(var chars=[].concat(ch),i=0;i<chars.length;i++)ctx.fillText(chars[i],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[hash]=canvas}this._ctx.drawImage(canvas,x*this._spacingX,y*this._spacingY)}},{key:"_drawNoCache",value:function(data,clearBefore){var _data2=_slicedToArray(data,5),x=_data2[0],y=_data2[1],ch=_data2[2],fg=_data2[3],bg=_data2[4];if(clearBefore){var b=this._options.border;this._ctx.fillStyle=bg,this._ctx.fillRect(x*this._spacingX+b,y*this._spacingY+b,this._spacingX-b,this._spacingY-b)}if(ch){this._ctx.fillStyle=fg;for(var chars=[].concat(ch),i=0;i<chars.length;i++)this._ctx.fillText(chars[i],(x+.5)*this._spacingX,Math.ceil((y+.5)*this._spacingY))}}},{key:"computeSize",value:function(availWidth,availHeight){return[Math.floor(availWidth/this._spacingX),Math.floor(availHeight/this._spacingY)]}},{key:"computeFontSize",value:function(availWidth,availHeight){var boxWidth=Math.floor(availWidth/this._options.width),boxHeight=Math.floor(availHeight/this._options.height),oldFont=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;var width=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=oldFont;var widthFraction=width/100*boxHeight/boxWidth;return widthFraction>1&&(boxHeight=Math.floor(boxHeight/widthFraction)),Math.floor(boxHeight/this._options.spacing)}},{key:"_normalizedEventToPosition",value:function(x,y){return[Math.floor(x/this._spacingX),Math.floor(y/this._spacingY)]}},{key:"_updateSize",value:function(){var opts=this._options,charWidth=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(opts.spacing*charWidth),this._spacingY=Math.ceil(opts.spacing*opts.fontSize),opts.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=opts.width*this._spacingX,this._ctx.canvas.height=opts.height*this._spacingY}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Rect}(_canvas_js__WEBPACK_IMPORTED_MODULE_0__.default);return Rect.cache=!1,Rect}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Tile});var Tile=function(_Canvas){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Tile,_Canvas);var Constructor,protoProps,staticProps,_super=_createSuper(Tile);function Tile(){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Tile),(_this=_super.call(this))._colorCanvas=document.createElement("canvas"),_this}return Constructor=Tile,(protoProps=[{key:"draw",value:function(data,clearBefore){var _data=_slicedToArray(data,5),x=_data[0],y=_data[1],ch=_data[2],fg=_data[3],bg=_data[4],tileWidth=this._options.tileWidth,tileHeight=this._options.tileHeight;if(clearBefore&&(this._options.tileColorize?this._ctx.clearRect(x*tileWidth,y*tileHeight,tileWidth,tileHeight):(this._ctx.fillStyle=bg,this._ctx.fillRect(x*tileWidth,y*tileHeight,tileWidth,tileHeight))),ch)for(var chars=[].concat(ch),fgs=[].concat(fg),bgs=[].concat(bg),i=0;i<chars.length;i++){var tile=this._options.tileMap[chars[i]];if(!tile)throw new Error('Char "'.concat(chars[i],'" not found in tileMap'));if(this._options.tileColorize){var canvas=this._colorCanvas,context=canvas.getContext("2d");context.globalCompositeOperation="source-over",context.clearRect(0,0,tileWidth,tileHeight);var _fg=fgs[i],_bg=bgs[i];context.drawImage(this._options.tileSet,tile[0],tile[1],tileWidth,tileHeight,0,0,tileWidth,tileHeight),"transparent"!=_fg&&(context.fillStyle=_fg,context.globalCompositeOperation="source-atop",context.fillRect(0,0,tileWidth,tileHeight)),"transparent"!=_bg&&(context.fillStyle=_bg,context.globalCompositeOperation="destination-over",context.fillRect(0,0,tileWidth,tileHeight)),this._ctx.drawImage(canvas,x*tileWidth,y*tileHeight,tileWidth,tileHeight)}else this._ctx.drawImage(this._options.tileSet,tile[0],tile[1],tileWidth,tileHeight,x*tileWidth,y*tileHeight,tileWidth,tileHeight)}}},{key:"computeSize",value:function(availWidth,availHeight){return[Math.floor(availWidth/this._options.tileWidth),Math.floor(availHeight/this._options.tileHeight)]}},{key:"computeFontSize",value:function(){throw new Error("Tile backend does not understand font size")}},{key:"_normalizedEventToPosition",value:function(x,y){return[Math.floor(x/this._options.tileWidth),Math.floor(y/this._options.tileHeight)]}},{key:"_updateSize",value:function(){var opts=this._options;this._ctx.canvas.width=opts.width*opts.tileWidth,this._ctx.canvas.height=opts.height*opts.tileHeight,this._colorCanvas.width=opts.tileWidth,this._colorCanvas.height=opts.tileHeight}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Tile}(__webpack_require__(182).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>TileGL});var _backend_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(183),_color_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(187);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var TileGL=function(_Backend){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(TileGL,_Backend);var Constructor,protoProps,staticProps,_super=_createSuper(TileGL);function TileGL(){var _this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TileGL),(_this=_super.call(this))._uniforms={};try{_this._gl=_this._initWebGL()}catch(e){alert(e.message)}return _this}return Constructor=TileGL,staticProps=[{key:"isSupported",value:function(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}}],(protoProps=[{key:"schedule",value:function(cb){requestAnimationFrame(cb)}},{key:"getContainer",value:function(){return this._gl.canvas}},{key:"setOptions",value:function(opts){var _this2=this;_get(_getPrototypeOf(TileGL.prototype),"setOptions",this).call(this,opts),this._updateSize();var tileSet=this._options.tileSet;tileSet&&"complete"in tileSet&&!tileSet.complete?tileSet.addEventListener("load",(function(){return _this2._updateTexture(tileSet)})):this._updateTexture(tileSet)}},{key:"draw",value:function(data,clearBefore){var gl=this._gl,opts=this._options,_data=_slicedToArray(data,5),x=_data[0],y=_data[1],ch=_data[2],fg=_data[3],bg=_data[4],scissorY=gl.canvas.height-(y+1)*opts.tileHeight;if(gl.scissor(x*opts.tileWidth,scissorY,opts.tileWidth,opts.tileHeight),clearBefore&&(opts.tileColorize?gl.clearColor(0,0,0,0):gl.clearColor.apply(gl,_toConsumableArray(parseColor(bg))),gl.clear(gl.COLOR_BUFFER_BIT)),ch){var chars=[].concat(ch),bgs=[].concat(bg),fgs=[].concat(fg);gl.uniform2fv(this._uniforms.targetPosRel,[x,y]);for(var i=0;i<chars.length;i++){var tile=this._options.tileMap[chars[i]];if(!tile)throw new Error('Char "'.concat(chars[i],'" not found in tileMap'));gl.uniform1f(this._uniforms.colorize,opts.tileColorize?1:0),gl.uniform2fv(this._uniforms.tilesetPosAbs,tile),opts.tileColorize&&(gl.uniform4fv(this._uniforms.tint,parseColor(fgs[i])),gl.uniform4fv(this._uniforms.bg,parseColor(bgs[i]))),gl.drawArrays(gl.TRIANGLE_STRIP,0,4)}}}},{key:"clear",value:function(){var gl=this._gl;gl.clearColor.apply(gl,_toConsumableArray(parseColor(this._options.bg))),gl.scissor(0,0,gl.canvas.width,gl.canvas.height),gl.clear(gl.COLOR_BUFFER_BIT)}},{key:"computeSize",value:function(availWidth,availHeight){return[Math.floor(availWidth/this._options.tileWidth),Math.floor(availHeight/this._options.tileHeight)]}},{key:"computeFontSize",value:function(){throw new Error("Tile backend does not understand font size")}},{key:"eventToPosition",value:function(x,y){var canvas=this._gl.canvas,rect=canvas.getBoundingClientRect();return x-=rect.left,y-=rect.top,x*=canvas.width/rect.width,y*=canvas.height/rect.height,x<0||y<0||x>=canvas.width||y>=canvas.height?[-1,-1]:this._normalizedEventToPosition(x,y)}},{key:"_initWebGL",value:function(){var _this3=this,gl=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=gl;var program=function(gl,vss,fss){var vs=gl.createShader(gl.VERTEX_SHADER);if(gl.shaderSource(vs,vss),gl.compileShader(vs),!gl.getShaderParameter(vs,gl.COMPILE_STATUS))throw new Error(gl.getShaderInfoLog(vs)||"");var fs=gl.createShader(gl.FRAGMENT_SHADER);if(gl.shaderSource(fs,fss),gl.compileShader(fs),!gl.getShaderParameter(fs,gl.COMPILE_STATUS))throw new Error(gl.getShaderInfoLog(fs)||"");var p=gl.createProgram();if(gl.attachShader(p,vs),gl.attachShader(p,fs),gl.linkProgram(p),!gl.getProgramParameter(p,gl.LINK_STATUS))throw new Error(gl.getProgramInfoLog(p)||"");return p}(gl,VS,FS);return gl.useProgram(program),function(gl){var pos=new Float32Array([0,0,1,0,0,1,1,1]),buf=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buf),gl.bufferData(gl.ARRAY_BUFFER,pos,gl.STATIC_DRAW),gl.enableVertexAttribArray(0),gl.vertexAttribPointer(0,2,gl.FLOAT,!1,0,0)}(gl),UNIFORMS.forEach((function(name){return _this3._uniforms[name]=gl.getUniformLocation(program,name)})),this._program=program,gl.enable(gl.BLEND),gl.blendFuncSeparate(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA),gl.enable(gl.SCISSOR_TEST),gl}},{key:"_normalizedEventToPosition",value:function(x,y){return[Math.floor(x/this._options.tileWidth),Math.floor(y/this._options.tileHeight)]}},{key:"_updateSize",value:function(){var gl=this._gl,opts=this._options,canvasSize=[opts.width*opts.tileWidth,opts.height*opts.tileHeight];gl.canvas.width=canvasSize[0],gl.canvas.height=canvasSize[1],gl.viewport(0,0,canvasSize[0],canvasSize[1]),gl.uniform2fv(this._uniforms.tileSize,[opts.tileWidth,opts.tileHeight]),gl.uniform2fv(this._uniforms.targetSize,canvasSize)}},{key:"_updateTexture",value:function(tileSet){var gl,data,t;gl=this._gl,data=tileSet,t=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,t),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,0),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,data)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),TileGL}(_backend_js__WEBPACK_IMPORTED_MODULE_0__.default),UNIFORMS=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],VS="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),FS="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();var colorCache={};function parseColor(color){if(!(color in colorCache)){var parsed;if("transparent"==color)parsed=[0,0,0,0];else if(color.indexOf("rgba")>-1){parsed=(color.match(/[\d.]+/g)||[]).map(Number);for(var i=0;i<3;i++)parsed[i]=parsed[i]/255}else(parsed=_color_js__WEBPACK_IMPORTED_MODULE_1__.fromString(color).map((function($){return $/255}))).push(1);colorCache[color]=parsed}return colorCache[color]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{fromString:()=>fromString,add:()=>add,add_:()=>add_,multiply:()=>multiply,multiply_:()=>multiply_,interpolate:()=>interpolate,lerp:()=>lerp,interpolateHSL:()=>interpolateHSL,lerpHSL:()=>lerpHSL,randomize:()=>randomize,rgb2hsl:()=>rgb2hsl,hsl2rgb:()=>hsl2rgb,toRGB:()=>toRGB,toHex:()=>toHex});var _util_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(107),_rng_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179);function fromString(str){var cached,r;if(str in CACHE)cached=CACHE[str];else{if("#"==str.charAt(0)){var values=(str.match(/[0-9a-f]/gi)||[]).map((function(x){return parseInt(x,16)}));if(3==values.length)cached=values.map((function(x){return 17*x}));else{for(var i=0;i<3;i++)values[i+1]+=16*values[i],values.splice(i,1);cached=values}}else cached=(r=str.match(/rgb\(([0-9, ]+)\)/i))?r[1].split(/\s*,\s*/).map((function(x){return parseInt(x)})):[0,0,0];CACHE[str]=cached}return cached.slice()}function add(color1){for(var result=color1.slice(),_len=arguments.length,colors=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)colors[_key-1]=arguments[_key];for(var i=0;i<3;i++)for(var j=0;j<colors.length;j++)result[i]+=colors[j][i];return result}function add_(color1){for(var _len2=arguments.length,colors=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)colors[_key2-1]=arguments[_key2];for(var i=0;i<3;i++)for(var j=0;j<colors.length;j++)color1[i]+=colors[j][i];return color1}function multiply(color1){for(var result=color1.slice(),_len3=arguments.length,colors=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)colors[_key3-1]=arguments[_key3];for(var i=0;i<3;i++){for(var j=0;j<colors.length;j++)result[i]*=colors[j][i]/255;result[i]=Math.round(result[i])}return result}function multiply_(color1){for(var _len4=arguments.length,colors=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++)colors[_key4-1]=arguments[_key4];for(var i=0;i<3;i++){for(var j=0;j<colors.length;j++)color1[i]*=colors[j][i]/255;color1[i]=Math.round(color1[i])}return color1}function interpolate(color1,color2){for(var factor=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,result=color1.slice(),i=0;i<3;i++)result[i]=Math.round(result[i]+factor*(color2[i]-color1[i]));return result}var lerp=interpolate;function interpolateHSL(color1,color2){for(var factor=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,hsl1=rgb2hsl(color1),hsl2=rgb2hsl(color2),i=0;i<3;i++)hsl1[i]+=factor*(hsl2[i]-hsl1[i]);return hsl2rgb(hsl1)}var lerpHSL=interpolateHSL;function randomize(color,diff){diff instanceof Array||(diff=Math.round(_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getNormal(0,diff)));for(var result=color.slice(),i=0;i<3;i++)result[i]+=diff instanceof Array?Math.round(_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getNormal(0,diff[i])):diff;return result}function rgb2hsl(color){var s,r=color[0]/255,g=color[1]/255,b=color[2]/255,max=Math.max(r,g,b),min=Math.min(r,g,b),h=0,l=(max+min)/2;if(max==min)s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return[h,s,l]}function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}function hsl2rgb(color){var l=color[2];if(0==color[1])return[l=Math.round(255*l),l,l];var s=color[1],q=l<.5?l*(1+s):l+s-l*s,p=2*l-q,r=hue2rgb(p,q,color[0]+1/3),g=hue2rgb(p,q,color[0]),b=hue2rgb(p,q,color[0]-1/3);return[Math.round(255*r),Math.round(255*g),Math.round(255*b)]}function toRGB(color){var clamped=color.map((function(x){return(0,_util_js__WEBPACK_IMPORTED_MODULE_0__.clamp)(x,0,255)}));return"rgb(".concat(clamped.join(","),")")}function toHex(color){var clamped=color.map((function(x){return(0,_util_js__WEBPACK_IMPORTED_MODULE_0__.clamp)(x,0,255).toString(16).padStart(2,"0")}));return"#".concat(clamped.join(""))}var CACHE={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Term});var _backend_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(183),_color_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(187);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function termcolor(color){var rgb=_color_js__WEBPACK_IMPORTED_MODULE_1__.fromString(color);return 36*Math.floor(.0234375*rgb[0])+6*Math.floor(.0234375*rgb[1])+1*Math.floor(.0234375*rgb[2])+16}var Term=function(_Backend){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Term,_Backend);var Constructor,protoProps,staticProps,_super=_createSuper(Term);function Term(){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Term),(_this=_super.call(this))._offset=[0,0],_this._cursor=[-1,-1],_this._lastColor="",_this}return Constructor=Term,(protoProps=[{key:"schedule",value:function(cb){setTimeout(cb,1e3/60)}},{key:"setOptions",value:function(options){_get(_getPrototypeOf(Term.prototype),"setOptions",this).call(this,options);var size=[options.width,options.height],avail=this.computeSize();this._offset=avail.map((function(val,index){return Math.floor((val-size[index])/2)}))}},{key:"clear",value:function(){var bg;process.stdout.write((bg=this._options.bg,"[0;48;5;".concat(termcolor(bg),"m[2J")))}},{key:"draw",value:function(data,clearBefore){var _data=_slicedToArray(data,5),x=_data[0],y=_data[1],ch=_data[2],fg=_data[3],bg=_data[4],dx=this._offset[0]+x,dy=this._offset[1]+y,size=this.computeSize();if(!(dx<0||dx>=size[0])&&!(dy<0||dy>=size[1])&&(dx===this._cursor[0]&&dy===this._cursor[1]||(process.stdout.write(function(x,y){return"[".concat(y+1,";").concat(x+1,"H")}(dx,dy)),this._cursor[0]=dx,this._cursor[1]=dy),clearBefore&&(ch||(ch=" ")),ch)){var newColor=function(fg,bg){return"[0;38;5;".concat(termcolor(fg),";48;5;").concat(termcolor(bg),"m")}(fg,bg);if(newColor!==this._lastColor&&(process.stdout.write(newColor),this._lastColor=newColor),"\t"!=ch){var chars=[].concat(ch);process.stdout.write(chars[0])}this._cursor[0]++,this._cursor[0]>=size[0]&&(this._cursor[0]=0,this._cursor[1]++)}}},{key:"computeFontSize",value:function(){throw new Error("Terminal backend has no notion of font size")}},{key:"eventToPosition",value:function(x,y){return[x,y]}},{key:"computeSize",value:function(){return[process.stdout.columns,process.stdout.rows]}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Term}(_backend_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{TYPE_TEXT:()=>TYPE_TEXT,TYPE_NEWLINE:()=>TYPE_NEWLINE,TYPE_FG:()=>TYPE_FG,TYPE_BG:()=>TYPE_BG,measure:()=>measure,tokenize:()=>tokenize});var RE_COLORS=/%([bc]){([^}]*)}/g,TYPE_TEXT=0,TYPE_NEWLINE=1,TYPE_FG=2,TYPE_BG=3;function measure(str,maxWidth){for(var result={width:0,height:1},tokens=tokenize(str,maxWidth),lineWidth=0,i=0;i<tokens.length;i++){var token=tokens[i];switch(token.type){case TYPE_TEXT:lineWidth+=token.value.length;break;case TYPE_NEWLINE:result.height++,result.width=Math.max(result.width,lineWidth),lineWidth=0}}return result.width=Math.max(result.width,lineWidth),result}function tokenize(str,maxWidth){var result=[],offset=0;str.replace(RE_COLORS,(function(match,type,name,index){var part=str.substring(offset,index);return part.length&&result.push({type:TYPE_TEXT,value:part}),result.push({type:"c"==type?TYPE_FG:TYPE_BG,value:name.trim()}),offset=index+match.length,""}));var part=str.substring(offset);return part.length&&result.push({type:TYPE_TEXT,value:part}),function(tokens,maxWidth){maxWidth||(maxWidth=1/0);var i=0,lineLength=0,lastTokenWithSpace=-1;for(;i<tokens.length;){var token=tokens[i];if(token.type==TYPE_NEWLINE&&(lineLength=0,lastTokenWithSpace=-1),token.type==TYPE_TEXT){for(;0==lineLength&&" "==token.value.charAt(0);)token.value=token.value.substring(1);var index=token.value.indexOf("\n");if(-1!=index){token.value=breakInsideToken(tokens,i,index,!0);for(var arr=token.value.split("");arr.length&&" "==arr[arr.length-1];)arr.pop();token.value=arr.join("")}if(token.value.length){if(lineLength+token.value.length>maxWidth){for(var _index=-1;;){var nextIndex=token.value.indexOf(" ",_index+1);if(-1==nextIndex)break;if(lineLength+nextIndex>maxWidth)break;_index=nextIndex}if(-1!=_index)token.value=breakInsideToken(tokens,i,_index,!0);else if(-1!=lastTokenWithSpace){var _token=tokens[lastTokenWithSpace],breakIndex=_token.value.lastIndexOf(" ");_token.value=breakInsideToken(tokens,lastTokenWithSpace,breakIndex,!0),i=lastTokenWithSpace}else token.value=breakInsideToken(tokens,i,maxWidth-lineLength,!1)}else lineLength+=token.value.length,-1!=token.value.indexOf(" ")&&(lastTokenWithSpace=i);i++}else tokens.splice(i,1)}else i++}tokens.push({type:TYPE_NEWLINE});for(var lastTextToken=null,_i=0;_i<tokens.length;_i++){var _token2=tokens[_i];switch(_token2.type){case TYPE_TEXT:lastTextToken=_token2;break;case TYPE_NEWLINE:if(lastTextToken){for(var _arr=lastTextToken.value.split("");_arr.length&&" "==_arr[_arr.length-1];)_arr.pop();lastTextToken.value=_arr.join("")}lastTextToken=null}}return tokens.pop(),tokens}(result,maxWidth)}function breakInsideToken(tokens,tokenIndex,breakIndex,removeBreakChar){var newBreakToken={type:TYPE_NEWLINE},newTextToken={type:TYPE_TEXT,value:tokens[tokenIndex].value.substring(breakIndex+(removeBreakChar?1:0))};return tokens.splice(tokenIndex+1,0,newBreakToken,newTextToken),tokens[tokenIndex].value.substring(0,breakIndex)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DEFAULT_WIDTH:()=>DEFAULT_WIDTH,DEFAULT_HEIGHT:()=>DEFAULT_HEIGHT,DIRS:()=>DIRS,KEYS:()=>KEYS});var DEFAULT_WIDTH=80,DEFAULT_HEIGHT=25,DIRS={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},KEYS={VK_CANCEL:3,VK_HELP:6,VK_BACK_SPACE:8,VK_TAB:9,VK_CLEAR:12,VK_RETURN:13,VK_ENTER:14,VK_SHIFT:16,VK_CONTROL:17,VK_ALT:18,VK_PAUSE:19,VK_CAPS_LOCK:20,VK_ESCAPE:27,VK_SPACE:32,VK_PAGE_UP:33,VK_PAGE_DOWN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40,VK_PRINTSCREEN:44,VK_INSERT:45,VK_DELETE:46,VK_0:48,VK_1:49,VK_2:50,VK_3:51,VK_4:52,VK_5:53,VK_6:54,VK_7:55,VK_8:56,VK_9:57,VK_COLON:58,VK_SEMICOLON:59,VK_LESS_THAN:60,VK_EQUALS:61,VK_GREATER_THAN:62,VK_QUESTION_MARK:63,VK_AT:64,VK_A:65,VK_B:66,VK_C:67,VK_D:68,VK_E:69,VK_F:70,VK_G:71,VK_H:72,VK_I:73,VK_J:74,VK_K:75,VK_L:76,VK_M:77,VK_N:78,VK_O:79,VK_P:80,VK_Q:81,VK_R:82,VK_S:83,VK_T:84,VK_U:85,VK_V:86,VK_W:87,VK_X:88,VK_Y:89,VK_Z:90,VK_CONTEXT_MENU:93,VK_NUMPAD0:96,VK_NUMPAD1:97,VK_NUMPAD2:98,VK_NUMPAD3:99,VK_NUMPAD4:100,VK_NUMPAD5:101,VK_NUMPAD6:102,VK_NUMPAD7:103,VK_NUMPAD8:104,VK_NUMPAD9:105,VK_MULTIPLY:106,VK_ADD:107,VK_SEPARATOR:108,VK_SUBTRACT:109,VK_DECIMAL:110,VK_DIVIDE:111,VK_F1:112,VK_F2:113,VK_F3:114,VK_F4:115,VK_F5:116,VK_F6:117,VK_F7:118,VK_F8:119,VK_F9:120,VK_F10:121,VK_F11:122,VK_F12:123,VK_F13:124,VK_F14:125,VK_F15:126,VK_F16:127,VK_F17:128,VK_F18:129,VK_F19:130,VK_F20:131,VK_F21:132,VK_F22:133,VK_F23:134,VK_F24:135,VK_NUM_LOCK:144,VK_SCROLL_LOCK:145,VK_CIRCUMFLEX:160,VK_EXCLAMATION:161,VK_DOUBLE_QUOTE:162,VK_HASH:163,VK_DOLLAR:164,VK_PERCENT:165,VK_AMPERSAND:166,VK_UNDERSCORE:167,VK_OPEN_PAREN:168,VK_CLOSE_PAREN:169,VK_ASTERISK:170,VK_PLUS:171,VK_PIPE:172,VK_HYPHEN_MINUS:173,VK_OPEN_CURLY_BRACKET:174,VK_CLOSE_CURLY_BRACKET:175,VK_TILDE:176,VK_COMMA:188,VK_PERIOD:190,VK_SLASH:191,VK_BACK_QUOTE:192,VK_OPEN_BRACKET:219,VK_BACK_SLASH:220,VK_CLOSE_BRACKET:221,VK_QUOTE:222,VK_META:224,VK_ALTGR:225,VK_WIN:91,VK_KANA:21,VK_HANGUL:21,VK_EISU:22,VK_JUNJA:23,VK_FINAL:24,VK_HANJA:25,VK_KANJI:25,VK_CONVERT:28,VK_NONCONVERT:29,VK_ACCEPT:30,VK_MODECHANGE:31,VK_SELECT:41,VK_PRINT:42,VK_EXECUTE:43,VK_SLEEP:95}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>StringGenerator});var _rng_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(179);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var StringGenerator=function(){function StringGenerator(options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,StringGenerator),this._options={words:!1,order:3,prior:.001},Object.assign(this._options,options),this._boundary=String.fromCharCode(0),this._suffix=this._boundary,this._prefix=[];for(var i=0;i<this._options.order;i++)this._prefix.push(this._boundary);this._priorValues={},this._priorValues[this._boundary]=this._options.prior,this._data={}}var Constructor,protoProps,staticProps;return Constructor=StringGenerator,(protoProps=[{key:"clear",value:function(){this._data={},this._priorValues={}}},{key:"generate",value:function(){for(var result=[this._sample(this._prefix)];result[result.length-1]!=this._boundary;)result.push(this._sample(result));return this._join(result.slice(0,-1))}},{key:"observe",value:function(string){for(var tokens=this._split(string),i=0;i<tokens.length;i++)this._priorValues[tokens[i]]=this._options.prior;tokens=this._prefix.concat(tokens).concat(this._suffix);for(var _i=this._options.order;_i<tokens.length;_i++)for(var context=tokens.slice(_i-this._options.order,_i),event=tokens[_i],j=0;j<context.length;j++){var subcontext=context.slice(j);this._observeEvent(subcontext,event)}}},{key:"getStats",value:function(){var parts=[],priorCount=Object.keys(this._priorValues).length;priorCount--,parts.push("distinct samples: "+priorCount);var dataCount=Object.keys(this._data).length,eventCount=0;for(var p in this._data)eventCount+=Object.keys(this._data[p]).length;return parts.push("dictionary size (contexts): "+dataCount),parts.push("dictionary size (events): "+eventCount),parts.join(", ")}},{key:"_split",value:function(str){return str.split(this._options.words?/\s+/:"")}},{key:"_join",value:function(arr){return arr.join(this._options.words?" ":"")}},{key:"_observeEvent",value:function(context,event){var key=this._join(context);key in this._data||(this._data[key]={});var data=this._data[key];event in data||(data[event]=0),data[event]++}},{key:"_sample",value:function(context){context=this._backoff(context);var key=this._join(context),data=this._data[key],available={};if(this._options.prior){for(var event in this._priorValues)available[event]=this._priorValues[event];for(var _event in data)available[_event]+=data[_event]}else available=data;return _rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getWeightedValue(available)}},{key:"_backoff",value:function(context){for(context.length>this._options.order?context=context.slice(-this._options.order):context.length<this._options.order&&(context=this._prefix.slice(0,this._options.order-context.length).concat(context));!(this._join(context)in this._data)&&context.length>0;)context=context.slice(1);return context}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),StringGenerator}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _simple_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(137),_speed_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(193),_action_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(194);const __WEBPACK_DEFAULT_EXPORT__={Simple:_simple_js__WEBPACK_IMPORTED_MODULE_0__.default,Speed:_speed_js__WEBPACK_IMPORTED_MODULE_1__.default,Action:_action_js__WEBPACK_IMPORTED_MODULE_2__.default}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Speed});var Speed=function(_Scheduler){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Speed,_Scheduler);var Constructor,protoProps,staticProps,_super=_createSuper(Speed);function Speed(){return _classCallCheck(this,Speed),_super.apply(this,arguments)}return Constructor=Speed,(protoProps=[{key:"add",value:function(item,repeat,time){return this._queue.add(item,void 0!==time?time:1/item.getSpeed()),_get(_getPrototypeOf(Speed.prototype),"add",this).call(this,item,repeat)}},{key:"next",value:function(){return this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,1/this._current.getSpeed()),_get(_getPrototypeOf(Speed.prototype),"next",this).call(this)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Speed}(__webpack_require__(138).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Action});var Action=function(_Scheduler){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Action,_Scheduler);var Constructor,protoProps,staticProps,_super=_createSuper(Action);function Action(){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Action),(_this=_super.call(this))._defaultDuration=1,_this._duration=_this._defaultDuration,_this}return Constructor=Action,(protoProps=[{key:"add",value:function(item,repeat,time){return this._queue.add(item,time||this._defaultDuration),_get(_getPrototypeOf(Action.prototype),"add",this).call(this,item,repeat)}},{key:"clear",value:function(){return this._duration=this._defaultDuration,_get(_getPrototypeOf(Action.prototype),"clear",this).call(this)}},{key:"remove",value:function(item){return item==this._current&&(this._duration=this._defaultDuration),_get(_getPrototypeOf(Action.prototype),"remove",this).call(this,item)}},{key:"next",value:function(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&(this._queue.add(this._current,this._duration||this._defaultDuration),this._duration=this._defaultDuration),_get(_getPrototypeOf(Action.prototype),"next",this).call(this)}},{key:"setDuration",value:function(time){return this._current&&(this._duration=time),this}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Action}(__webpack_require__(138).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _discrete_shadowcasting_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(196),_precise_shadowcasting_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(198),_recursive_shadowcasting_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(199);const __WEBPACK_DEFAULT_EXPORT__={DiscreteShadowcasting:_discrete_shadowcasting_js__WEBPACK_IMPORTED_MODULE_0__.default,PreciseShadowcasting:_precise_shadowcasting_js__WEBPACK_IMPORTED_MODULE_1__.default,RecursiveShadowcasting:_recursive_shadowcasting_js__WEBPACK_IMPORTED_MODULE_2__.default}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>DiscreteShadowcasting});var DiscreteShadowcasting=function(_FOV){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DiscreteShadowcasting,_FOV);var Constructor,protoProps,staticProps,_super=_createSuper(DiscreteShadowcasting);function DiscreteShadowcasting(){return _classCallCheck(this,DiscreteShadowcasting),_super.apply(this,arguments)}return Constructor=DiscreteShadowcasting,(protoProps=[{key:"compute",value:function(x,y,R,callback){if(callback(x,y,0,1),this._lightPasses(x,y))for(var A,B,cx,cy,blocks,DATA=[],r=1;r<=R;r++)for(var neighbors=this._getCircle(x,y,r),angle=360/neighbors.length,i=0;i<neighbors.length;i++)if(cx=neighbors[i][0],cy=neighbors[i][1],B=(A=angle*(i-.5))+angle,blocks=!this._lightPasses(cx,cy),this._visibleCoords(Math.floor(A),Math.ceil(B),blocks,DATA)&&callback(cx,cy,r,1),2==DATA.length&&0==DATA[0]&&360==DATA[1])return}},{key:"_visibleCoords",value:function(A,B,blocks,DATA){if(A<0){var v1=this._visibleCoords(0,B,blocks,DATA),v2=this._visibleCoords(360+A,360,blocks,DATA);return v1||v2}for(var index=0;index<DATA.length&&DATA[index]<A;)index++;if(index==DATA.length)return blocks&&DATA.push(A,B),!0;var count=0;if(index%2){for(;index<DATA.length&&DATA[index]<B;)index++,count++;return 0!=count&&(blocks&&(count%2?DATA.splice(index-count,count,B):DATA.splice(index-count,count)),!0)}for(;index<DATA.length&&DATA[index]<B;)index++,count++;return(A!=DATA[index-count]||1!=count)&&(blocks&&(count%2?DATA.splice(index-count,count,A):DATA.splice(index-count,count,A,B)),!0)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),DiscreteShadowcasting}(__webpack_require__(197).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>FOV});var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(190);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var FOV=function(){function FOV(lightPassesCallback){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,FOV),this._lightPasses=lightPassesCallback,this._options=Object.assign({topology:8},options)}var Constructor,protoProps,staticProps;return Constructor=FOV,(protoProps=[{key:"_getCircle",value:function(cx,cy,r){var dirs,countFactor,startOffset,result=[];switch(this._options.topology){case 4:countFactor=1,startOffset=[0,1],dirs=[_constants_js__WEBPACK_IMPORTED_MODULE_0__.DIRS[8][7],_constants_js__WEBPACK_IMPORTED_MODULE_0__.DIRS[8][1],_constants_js__WEBPACK_IMPORTED_MODULE_0__.DIRS[8][3],_constants_js__WEBPACK_IMPORTED_MODULE_0__.DIRS[8][5]];break;case 6:dirs=_constants_js__WEBPACK_IMPORTED_MODULE_0__.DIRS[6],countFactor=1,startOffset=[-1,1];break;case 8:dirs=_constants_js__WEBPACK_IMPORTED_MODULE_0__.DIRS[4],countFactor=2,startOffset=[-1,1];break;default:throw new Error("Incorrect topology for FOV computation")}for(var x=cx+startOffset[0]*r,y=cy+startOffset[1]*r,i=0;i<dirs.length;i++)for(var j=0;j<r*countFactor;j++)result.push([x,y]),x+=dirs[i][0],y+=dirs[i][1];return result}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),FOV}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>PreciseShadowcasting});var PreciseShadowcasting=function(_FOV){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(PreciseShadowcasting,_FOV);var Constructor,protoProps,staticProps,_super=_createSuper(PreciseShadowcasting);function PreciseShadowcasting(){return _classCallCheck(this,PreciseShadowcasting),_super.apply(this,arguments)}return Constructor=PreciseShadowcasting,(protoProps=[{key:"compute",value:function(x,y,R,callback){if(callback(x,y,0,1),this._lightPasses(x,y))for(var cx,cy,blocks,A1,A2,visibility,SHADOWS=[],r=1;r<=R;r++)for(var neighbors=this._getCircle(x,y,r),neighborCount=neighbors.length,i=0;i<neighborCount;i++)if(cx=neighbors[i][0],cy=neighbors[i][1],A1=[i?2*i-1:2*neighborCount-1,2*neighborCount],A2=[2*i+1,2*neighborCount],blocks=!this._lightPasses(cx,cy),(visibility=this._checkVisibility(A1,A2,blocks,SHADOWS))&&callback(cx,cy,r,visibility),2==SHADOWS.length&&0==SHADOWS[0][0]&&SHADOWS[1][0]==SHADOWS[1][1])return}},{key:"_checkVisibility",value:function(A1,A2,blocks,SHADOWS){if(A1[0]>A2[0])return(this._checkVisibility(A1,[A1[1],A1[1]],blocks,SHADOWS)+this._checkVisibility([0,1],A2,blocks,SHADOWS))/2;for(var index1=0,edge1=!1;index1<SHADOWS.length;){var old=SHADOWS[index1],diff=old[0]*A1[1]-A1[0]*old[1];if(diff>=0){0!=diff||index1%2||(edge1=!0);break}index1++}for(var index2=SHADOWS.length,edge2=!1;index2--;){var _old=SHADOWS[index2],_diff=A2[0]*_old[1]-_old[0]*A2[1];if(_diff>=0){0==_diff&&index2%2&&(edge2=!0);break}}var visibleLength,visible=!0;if((index1==index2&&(edge1||edge2)||edge1&&edge2&&index1+1==index2&&index2%2||index1>index2&&index1%2)&&(visible=!1),!visible)return 0;var remove=index2-index1+1;if(remove%2)if(index1%2){var P=SHADOWS[index1];visibleLength=(A2[0]*P[1]-P[0]*A2[1])/(P[1]*A2[1]),blocks&&SHADOWS.splice(index1,remove,A2)}else{var _P=SHADOWS[index2];visibleLength=(_P[0]*A1[1]-A1[0]*_P[1])/(A1[1]*_P[1]),blocks&&SHADOWS.splice(index1,remove,A1)}else{if(!(index1%2))return blocks&&SHADOWS.splice(index1,remove,A1,A2),1;var P1=SHADOWS[index1],P2=SHADOWS[index2];visibleLength=(P2[0]*P1[1]-P1[0]*P2[1])/(P1[1]*P2[1]),blocks&&SHADOWS.splice(index1,remove)}return visibleLength/((A2[0]*A1[1]-A1[0]*A2[1])/(A1[1]*A2[1]))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),PreciseShadowcasting}(__webpack_require__(197).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>RecursiveShadowcasting});var _fov_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(197);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var OCTANTS=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]],RecursiveShadowcasting=function(_FOV){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(RecursiveShadowcasting,_FOV);var Constructor,protoProps,staticProps,_super=_createSuper(RecursiveShadowcasting);function RecursiveShadowcasting(){return _classCallCheck(this,RecursiveShadowcasting),_super.apply(this,arguments)}return Constructor=RecursiveShadowcasting,(protoProps=[{key:"compute",value:function(x,y,R,callback){callback(x,y,0,1);for(var i=0;i<OCTANTS.length;i++)this._renderOctant(x,y,OCTANTS[i],R,callback)}},{key:"compute180",value:function(x,y,R,dir,callback){callback(x,y,0,1);var previousOctant=(dir-1+8)%8,nextPreviousOctant=(dir-2+8)%8,nextOctant=(dir+1+8)%8;this._renderOctant(x,y,OCTANTS[nextPreviousOctant],R,callback),this._renderOctant(x,y,OCTANTS[previousOctant],R,callback),this._renderOctant(x,y,OCTANTS[dir],R,callback),this._renderOctant(x,y,OCTANTS[nextOctant],R,callback)}},{key:"compute90",value:function(x,y,R,dir,callback){callback(x,y,0,1);var previousOctant=(dir-1+8)%8;this._renderOctant(x,y,OCTANTS[dir],R,callback),this._renderOctant(x,y,OCTANTS[previousOctant],R,callback)}},{key:"_renderOctant",value:function(x,y,octant,R,callback){this._castVisibility(x,y,1,1,0,R+1,octant[0],octant[1],octant[2],octant[3],callback)}},{key:"_castVisibility",value:function(startX,startY,row,visSlopeStart,visSlopeEnd,radius,xx,xy,yx,yy,callback){if(!(visSlopeStart<visSlopeEnd))for(var i=row;i<=radius;i++){for(var dx=-i-1,dy=-i,blocked=!1,newStart=0;dx<=0;){var mapX=startX+(dx+=1)*xx+dy*xy,mapY=startY+dx*yx+dy*yy,slopeStart=(dx-.5)/(dy+.5),slopeEnd=(dx+.5)/(dy-.5);if(!(slopeEnd>visSlopeStart)){if(slopeStart<visSlopeEnd)break;if(dx*dx+dy*dy<radius*radius&&callback(mapX,mapY,i,1),blocked){if(!this._lightPasses(mapX,mapY)){newStart=slopeEnd;continue}blocked=!1,visSlopeStart=newStart}else!this._lightPasses(mapX,mapY)&&i<radius&&(blocked=!0,this._castVisibility(startX,startY,i+1,visSlopeStart,slopeStart,radius,xx,xy,yx,yy,callback),newStart=slopeEnd)}}if(blocked)break}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),RecursiveShadowcasting}(_fov_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _arena_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(201),_uniform_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(203),_cellular_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(206),_digger_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(207),_ellermaze_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(208),_dividedmaze_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(209),_iceymaze_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(210),_rogue_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(211);const __WEBPACK_DEFAULT_EXPORT__={Arena:_arena_js__WEBPACK_IMPORTED_MODULE_0__.default,Uniform:_uniform_js__WEBPACK_IMPORTED_MODULE_1__.default,Cellular:_cellular_js__WEBPACK_IMPORTED_MODULE_2__.default,Digger:_digger_js__WEBPACK_IMPORTED_MODULE_3__.default,EllerMaze:_ellermaze_js__WEBPACK_IMPORTED_MODULE_4__.default,DividedMaze:_dividedmaze_js__WEBPACK_IMPORTED_MODULE_5__.default,IceyMaze:_iceymaze_js__WEBPACK_IMPORTED_MODULE_6__.default,Rogue:_rogue_js__WEBPACK_IMPORTED_MODULE_7__.default}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Arena});var Arena=function(_Map){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Arena,_Map);var Constructor,protoProps,staticProps,_super=_createSuper(Arena);function Arena(){return _classCallCheck(this,Arena),_super.apply(this,arguments)}return Constructor=Arena,(protoProps=[{key:"create",value:function(callback){for(var w=this._width-1,h=this._height-1,i=0;i<=w;i++)for(var j=0;j<=h;j++)callback(i,j,i&&j&&i<w&&j<h?0:1);return this}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Arena}(__webpack_require__(202).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Map});var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(190);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Map=function(){function Map(){var width=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_constants_js__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_WIDTH,height=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_constants_js__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_HEIGHT;_classCallCheck(this,Map),this._width=width,this._height=height}var Constructor,protoProps,staticProps;return Constructor=Map,(protoProps=[{key:"_fillMap",value:function(value){for(var map=[],i=0;i<this._width;i++){map.push([]);for(var j=0;j<this._height;j++)map[i].push(value)}return map}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Map}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Uniform});var _dungeon_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(204),_features_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(205),_rng_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(179);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Uniform=function(_Dungeon){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Uniform,_Dungeon);var Constructor,protoProps,staticProps,_super=_createSuper(Uniform);function Uniform(width,height,options){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Uniform),(_this=_super.call(this,width,height))._options={roomWidth:[3,9],roomHeight:[3,5],roomDugPercentage:.1,timeLimit:1e3},Object.assign(_this._options,options),_this._map=[],_this._dug=0,_this._roomAttempts=20,_this._corridorAttempts=20,_this._connected=[],_this._unconnected=[],_this._digCallback=_this._digCallback.bind(_assertThisInitialized(_this)),_this._canBeDugCallback=_this._canBeDugCallback.bind(_assertThisInitialized(_this)),_this._isWallCallback=_this._isWallCallback.bind(_assertThisInitialized(_this)),_this}return Constructor=Uniform,(protoProps=[{key:"create",value:function(callback){for(var t1=Date.now();;){if(Date.now()-t1>this._options.timeLimit)return null;if(this._map=this._fillMap(1),this._dug=0,this._rooms=[],this._unconnected=[],this._generateRooms(),!(this._rooms.length<2)&&this._generateCorridors())break}if(callback)for(var i=0;i<this._width;i++)for(var j=0;j<this._height;j++)callback(i,j,this._map[i][j]);return this}},{key:"_generateRooms",value:function(){var room,w=this._width-2,h=this._height-2;do{if(room=this._generateRoom(),this._dug/(w*h)>this._options.roomDugPercentage)break}while(room)}},{key:"_generateRoom",value:function(){for(var count=0;count<this._roomAttempts;){count++;var room=_features_js__WEBPACK_IMPORTED_MODULE_1__.Room.createRandom(this._width,this._height,this._options);if(room.isValid(this._isWallCallback,this._canBeDugCallback))return room.create(this._digCallback),this._rooms.push(room),room}return null}},{key:"_generateCorridors",value:function(){for(var cnt=0;cnt<this._corridorAttempts;){cnt++,this._corridors=[],this._map=this._fillMap(1);for(var i=0;i<this._rooms.length;i++){var room=this._rooms[i];room.clearDoors(),room.create(this._digCallback)}for(this._unconnected=_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.shuffle(this._rooms.slice()),this._connected=[],this._unconnected.length&&this._connected.push(this._unconnected.pop());;){var connected=_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getItem(this._connected);if(!connected)break;var room1=this._closestRoom(this._unconnected,connected);if(!room1)break;var room2=this._closestRoom(this._connected,room1);if(!room2)break;if(!this._connectRooms(room1,room2))break;if(!this._unconnected.length)return!0}}return!1}},{key:"_closestRoom",value:function(rooms,room){for(var dist=1/0,center=room.getCenter(),result=null,i=0;i<rooms.length;i++){var r=rooms[i],c=r.getCenter(),dx=c[0]-center[0],dy=c[1]-center[1],d=dx*dx+dy*dy;d<dist&&(dist=d,result=r)}return result}},{key:"_connectRooms",value:function(room1,room2){var start,end,dirIndex1,dirIndex2,min,max,index,center1=room1.getCenter(),center2=room2.getCenter(),diffX=center2[0]-center1[0],diffY=center2[1]-center1[1];if(Math.abs(diffX)<Math.abs(diffY)?(dirIndex2=(2+(dirIndex1=diffY>0?2:0))%4,min=room2.getLeft(),max=room2.getRight(),index=0):(dirIndex2=(2+(dirIndex1=diffX>0?1:3))%4,min=room2.getTop(),max=room2.getBottom(),index=1),!(start=this._placeInWall(room1,dirIndex1)))return!1;if(start[index]>=min&&start[index]<=max){end=start.slice();var value=0;switch(dirIndex2){case 0:value=room2.getTop()-1;break;case 1:value=room2.getRight()+1;break;case 2:value=room2.getBottom()+1;break;case 3:value=room2.getLeft()-1}end[(index+1)%2]=value,this._digLine([start,end])}else if(start[index]<min-1||start[index]>max+1){var diff=start[index]-center2[index],rotation=0;switch(dirIndex2){case 0:case 1:rotation=diff<0?3:1;break;case 2:case 3:rotation=diff<0?1:3}if(dirIndex2=(dirIndex2+rotation)%4,!(end=this._placeInWall(room2,dirIndex2)))return!1;var mid=[0,0];mid[index]=start[index];var index2=(index+1)%2;mid[index2]=end[index2],this._digLine([start,mid,end])}else{var _index=(index+1)%2;if(!(end=this._placeInWall(room2,dirIndex2)))return!1;var _mid=Math.round((end[_index]+start[_index])/2),mid1=[0,0],mid2=[0,0];mid1[index]=start[index],mid1[_index]=_mid,mid2[index]=end[index],mid2[_index]=_mid,this._digLine([start,mid1,mid2,end])}return room1.addDoor(start[0],start[1]),room2.addDoor(end[0],end[1]),-1!=(index=this._unconnected.indexOf(room1))&&(this._unconnected.splice(index,1),this._connected.push(room1)),-1!=(index=this._unconnected.indexOf(room2))&&(this._unconnected.splice(index,1),this._connected.push(room2)),!0}},{key:"_placeInWall",value:function(room,dirIndex){var start=[0,0],dir=[0,0],length=0;switch(dirIndex){case 0:dir=[1,0],start=[room.getLeft(),room.getTop()-1],length=room.getRight()-room.getLeft()+1;break;case 1:dir=[0,1],start=[room.getRight()+1,room.getTop()],length=room.getBottom()-room.getTop()+1;break;case 2:dir=[1,0],start=[room.getLeft(),room.getBottom()+1],length=room.getRight()-room.getLeft()+1;break;case 3:dir=[0,1],start=[room.getLeft()-1,room.getTop()],length=room.getBottom()-room.getTop()+1}for(var avail=[],lastBadIndex=-2,i=0;i<length;i++){var x=start[0]+i*dir[0],y=start[1]+i*dir[1];avail.push(null),1==this._map[x][y]?lastBadIndex!=i-1&&(avail[i]=[x,y]):(lastBadIndex=i,i&&(avail[i-1]=null))}for(var _i=avail.length-1;_i>=0;_i--)avail[_i]||avail.splice(_i,1);return avail.length?_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getItem(avail):null}},{key:"_digLine",value:function(points){for(var i=1;i<points.length;i++){var start=points[i-1],end=points[i],corridor=new _features_js__WEBPACK_IMPORTED_MODULE_1__.Corridor(start[0],start[1],end[0],end[1]);corridor.create(this._digCallback),this._corridors.push(corridor)}}},{key:"_digCallback",value:function(x,y,value){this._map[x][y]=value,0==value&&this._dug++}},{key:"_isWallCallback",value:function(x,y){return!(x<0||y<0||x>=this._width||y>=this._height)&&1==this._map[x][y]}},{key:"_canBeDugCallback",value:function(x,y){return!(x<1||y<1||x+1>=this._width||y+1>=this._height)&&1==this._map[x][y]}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Uniform}(_dungeon_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Dungeon});var Dungeon=function(_Map){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Dungeon,_Map);var Constructor,protoProps,staticProps,_super=_createSuper(Dungeon);function Dungeon(width,height){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Dungeon),(_this=_super.call(this,width,height))._rooms=[],_this._corridors=[],_this}return Constructor=Dungeon,(protoProps=[{key:"getRooms",value:function(){return this._rooms}},{key:"getCorridors",value:function(){return this._corridors}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Dungeon}(__webpack_require__(202).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Room:()=>Room,Corridor:()=>Corridor});var _rng_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(179);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var Feature=function Feature(){_classCallCheck(this,Feature)},Room=function(_Feature){_inherits(Room,_Feature);var _super=_createSuper(Room);function Room(x1,y1,x2,y2,doorX,doorY){var _this;return _classCallCheck(this,Room),(_this=_super.call(this))._x1=x1,_this._y1=y1,_this._x2=x2,_this._y2=y2,_this._doors={},void 0!==doorX&&void 0!==doorY&&_this.addDoor(doorX,doorY),_this}return _createClass(Room,[{key:"addDoor",value:function(x,y){return this._doors[x+","+y]=1,this}},{key:"getDoors",value:function(cb){for(var key in this._doors){var parts=key.split(",");cb(parseInt(parts[0]),parseInt(parts[1]))}return this}},{key:"clearDoors",value:function(){return this._doors={},this}},{key:"addDoors",value:function(isWallCallback){for(var left=this._x1-1,right=this._x2+1,top=this._y1-1,bottom=this._y2+1,x=left;x<=right;x++)for(var y=top;y<=bottom;y++)x!=left&&x!=right&&y!=top&&y!=bottom||isWallCallback(x,y)||this.addDoor(x,y);return this}},{key:"debug",value:function(){console.log("room",this._x1,this._y1,this._x2,this._y2)}},{key:"isValid",value:function(isWallCallback,canBeDugCallback){for(var left=this._x1-1,right=this._x2+1,top=this._y1-1,bottom=this._y2+1,x=left;x<=right;x++)for(var y=top;y<=bottom;y++)if(x==left||x==right||y==top||y==bottom){if(!isWallCallback(x,y))return!1}else if(!canBeDugCallback(x,y))return!1;return!0}},{key:"create",value:function(digCallback){for(var left=this._x1-1,right=this._x2+1,top=this._y1-1,bottom=this._y2+1,x=left;x<=right;x++)for(var y=top;y<=bottom;y++)digCallback(x,y,x+","+y in this._doors?2:x==left||x==right||y==top||y==bottom?1:0)}},{key:"getCenter",value:function(){return[Math.round((this._x1+this._x2)/2),Math.round((this._y1+this._y2)/2)]}},{key:"getLeft",value:function(){return this._x1}},{key:"getRight",value:function(){return this._x2}},{key:"getTop",value:function(){return this._y1}},{key:"getBottom",value:function(){return this._y2}}],[{key:"createRandomAt",value:function(x,y,dx,dy,options){var min=options.roomWidth[0],max=options.roomWidth[1],width=_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniformInt(min,max);min=options.roomHeight[0],max=options.roomHeight[1];var height=_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniformInt(min,max);if(1==dx){var y2=y-Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*height);return new this(x+1,y2,x+width,y2+height-1,x,y)}if(-1==dx){var _y=y-Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*height);return new this(x-width,_y,x-1,_y+height-1,x,y)}if(1==dy){var x2=x-Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*width);return new this(x2,y+1,x2+width-1,y+height,x,y)}if(-1==dy){var _x=x-Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*width);return new this(_x,y-height,_x+width-1,y-1,x,y)}throw new Error("dx or dy must be 1 or -1")}},{key:"createRandomCenter",value:function(cx,cy,options){var min=options.roomWidth[0],max=options.roomWidth[1],width=_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniformInt(min,max);min=options.roomHeight[0],max=options.roomHeight[1];var height=_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniformInt(min,max),x1=cx-Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*width),y1=cy-Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*height);return new this(x1,y1,x1+width-1,y1+height-1)}},{key:"createRandom",value:function(availWidth,availHeight,options){var min=options.roomWidth[0],max=options.roomWidth[1],width=_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniformInt(min,max);min=options.roomHeight[0],max=options.roomHeight[1];var height=_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniformInt(min,max),left=availWidth-width-1,top=availHeight-height-1,x1=1+Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*left),y1=1+Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniform()*top);return new this(x1,y1,x1+width-1,y1+height-1)}}]),Room}(Feature),Corridor=function(_Feature2){_inherits(Corridor,_Feature2);var _super2=_createSuper(Corridor);function Corridor(startX,startY,endX,endY){var _this2;return _classCallCheck(this,Corridor),(_this2=_super2.call(this))._startX=startX,_this2._startY=startY,_this2._endX=endX,_this2._endY=endY,_this2._endsWithAWall=!0,_this2}return _createClass(Corridor,[{key:"debug",value:function(){console.log("corridor",this._startX,this._startY,this._endX,this._endY)}},{key:"isValid",value:function(isWallCallback,canBeDugCallback){var sx=this._startX,sy=this._startY,dx=this._endX-sx,dy=this._endY-sy,length=1+Math.max(Math.abs(dx),Math.abs(dy));dx&&(dx/=Math.abs(dx)),dy&&(dy/=Math.abs(dy));for(var nx=dy,ny=-dx,ok=!0,i=0;i<length;i++){var x=sx+i*dx,y=sy+i*dy;if(canBeDugCallback(x,y)||(ok=!1),isWallCallback(x+nx,y+ny)||(ok=!1),isWallCallback(x-nx,y-ny)||(ok=!1),!ok){length=i,this._endX=x-dx,this._endY=y-dy;break}}if(0==length)return!1;if(1==length&&isWallCallback(this._endX+dx,this._endY+dy))return!1;var firstCornerBad=!isWallCallback(this._endX+dx+nx,this._endY+dy+ny),secondCornerBad=!isWallCallback(this._endX+dx-nx,this._endY+dy-ny);return this._endsWithAWall=isWallCallback(this._endX+dx,this._endY+dy),!firstCornerBad&&!secondCornerBad||!this._endsWithAWall}},{key:"create",value:function(digCallback){var sx=this._startX,sy=this._startY,dx=this._endX-sx,dy=this._endY-sy,length=1+Math.max(Math.abs(dx),Math.abs(dy));dx&&(dx/=Math.abs(dx)),dy&&(dy/=Math.abs(dy));for(var i=0;i<length;i++){digCallback(sx+i*dx,sy+i*dy,0)}return!0}},{key:"createPriorityWalls",value:function(priorityWallCallback){if(this._endsWithAWall){var sx=this._startX,sy=this._startY,dx=this._endX-sx,dy=this._endY-sy;dx&&(dx/=Math.abs(dx)),dy&&(dy/=Math.abs(dy));var nx=dy,ny=-dx;priorityWallCallback(this._endX+dx,this._endY+dy),priorityWallCallback(this._endX+nx,this._endY+ny),priorityWallCallback(this._endX-nx,this._endY-ny)}}}],[{key:"createRandomAt",value:function(x,y,dx,dy,options){var min=options.corridorLength[0],max=options.corridorLength[1],length=_rng_js__WEBPACK_IMPORTED_MODULE_0__.default.getUniformInt(min,max);return new this(x,y,x+dx*length,y+dy*length)}}]),Corridor}(Feature)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Cellular});var _map_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(202),_constants_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(190),_rng_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(179);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Cellular=function(_Map){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Cellular,_Map);var Constructor,protoProps,staticProps,_super=_createSuper(Cellular);function Cellular(width,height){var _this,options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,Cellular),(_this=_super.call(this,width,height))._options={born:[5,6,7,8],survive:[4,5,6,7,8],topology:8},_this.setOptions(options),_this._dirs=_constants_js__WEBPACK_IMPORTED_MODULE_1__.DIRS[_this._options.topology],_this._map=_this._fillMap(0),_this}return Constructor=Cellular,(protoProps=[{key:"randomize",value:function(probability){for(var i=0;i<this._width;i++)for(var j=0;j<this._height;j++)this._map[i][j]=_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getUniform()<probability?1:0;return this}},{key:"setOptions",value:function(options){Object.assign(this._options,options)}},{key:"set",value:function(x,y,value){this._map[x][y]=value}},{key:"create",value:function(callback){for(var newMap=this._fillMap(0),born=this._options.born,survive=this._options.survive,j=0;j<this._height;j++){var widthStep=1,widthStart=0;6==this._options.topology&&(widthStep=2,widthStart=j%2);for(var i=widthStart;i<this._width;i+=widthStep){var cur=this._map[i][j],ncount=this._getNeighbors(i,j);cur&&-1!=survive.indexOf(ncount)?newMap[i][j]=1:cur||-1==born.indexOf(ncount)||(newMap[i][j]=1)}}this._map=newMap,callback&&this._serviceCallback(callback)}},{key:"_serviceCallback",value:function(callback){for(var j=0;j<this._height;j++){var widthStep=1,widthStart=0;6==this._options.topology&&(widthStep=2,widthStart=j%2);for(var i=widthStart;i<this._width;i+=widthStep)callback(i,j,this._map[i][j])}}},{key:"_getNeighbors",value:function(cx,cy){for(var result=0,i=0;i<this._dirs.length;i++){var dir=this._dirs[i],x=cx+dir[0],y=cy+dir[1];x<0||x>=this._width||y<0||y>=this._height||(result+=1==this._map[x][y]?1:0)}return result}},{key:"connect",value:function(callback,value,connectionCallback){value||(value=0);var allFreeSpace=[],notConnected={},widthStep=1,widthStarts=[0,0];6==this._options.topology&&(widthStep=2,widthStarts=[0,1]);for(var y=0;y<this._height;y++)for(var x=widthStarts[y%2];x<this._width;x+=widthStep)if(this._freeSpace(x,y,value)){var p=[x,y];notConnected[this._pointKey(p)]=p,allFreeSpace.push([x,y])}var start=allFreeSpace[_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getUniformInt(0,allFreeSpace.length-1)],key=this._pointKey(start),connected={};for(connected[key]=start,delete notConnected[key],this._findConnected(connected,notConnected,[start],!1,value);Object.keys(notConnected).length>0;){var _p=this._getFromTo(connected,notConnected),from=_p[0],to=_p[1],local={};local[this._pointKey(from)]=from,this._findConnected(local,notConnected,[from],!0,value);var tunnelFn=6==this._options.topology?this._tunnelToConnected6:this._tunnelToConnected;for(var k in tunnelFn.call(this,to,from,connected,notConnected,value,connectionCallback),local){var pp=local[k];this._map[pp[0]][pp[1]]=value,connected[k]=pp,delete notConnected[k]}}callback&&this._serviceCallback(callback)}},{key:"_getFromTo",value:function(connected,notConnected){for(var from=[0,0],to=[0,0],connectedKeys=Object.keys(connected),notConnectedKeys=Object.keys(notConnected),i=0;i<5;i++){if(connectedKeys.length<notConnectedKeys.length){var keys=connectedKeys;to=connected[keys[_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getUniformInt(0,keys.length-1)]],from=this._getClosest(to,notConnected)}else{var _keys=notConnectedKeys;from=notConnected[_keys[_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getUniformInt(0,_keys.length-1)]],to=this._getClosest(from,connected)}if((from[0]-to[0])*(from[0]-to[0])+(from[1]-to[1])*(from[1]-to[1])<64)break}return[from,to]}},{key:"_getClosest",value:function(point,space){var minPoint=null,minDist=null;for(var k in space){var p=space[k],d=(p[0]-point[0])*(p[0]-point[0])+(p[1]-point[1])*(p[1]-point[1]);(null==minDist||d<minDist)&&(minDist=d,minPoint=p)}return minPoint}},{key:"_findConnected",value:function(connected,notConnected,stack,keepNotConnected,value){for(;stack.length>0;){var p=stack.splice(0,1)[0],tests=void 0;tests=6==this._options.topology?[[p[0]+2,p[1]],[p[0]+1,p[1]-1],[p[0]-1,p[1]-1],[p[0]-2,p[1]],[p[0]-1,p[1]+1],[p[0]+1,p[1]+1]]:[[p[0]+1,p[1]],[p[0]-1,p[1]],[p[0],p[1]+1],[p[0],p[1]-1]];for(var i=0;i<tests.length;i++){var key=this._pointKey(tests[i]);null==connected[key]&&this._freeSpace(tests[i][0],tests[i][1],value)&&(connected[key]=tests[i],keepNotConnected||delete notConnected[key],stack.push(tests[i]))}}}},{key:"_tunnelToConnected",value:function(to,from,connected,notConnected,value,connectionCallback){var a,b;from[0]<to[0]?(a=from,b=to):(a=to,b=from);for(var xx=a[0];xx<=b[0];xx++){this._map[xx][a[1]]=value;var p=[xx,a[1]],pkey=this._pointKey(p);connected[pkey]=p,delete notConnected[pkey]}connectionCallback&&a[0]<b[0]&&connectionCallback(a,[b[0],a[1]]);var x=b[0];from[1]<to[1]?(a=from,b=to):(a=to,b=from);for(var yy=a[1];yy<b[1];yy++){this._map[x][yy]=value;var _p2=[x,yy],_pkey=this._pointKey(_p2);connected[_pkey]=_p2,delete notConnected[_pkey]}connectionCallback&&a[1]<b[1]&&connectionCallback([b[0],a[1]],[b[0],b[1]])}},{key:"_tunnelToConnected6",value:function(to,from,connected,notConnected,value,connectionCallback){var a,b;from[0]<to[0]?(a=from,b=to):(a=to,b=from);for(var xx=a[0],yy=a[1];xx!=b[0]||yy!=b[1];){var stepWidth=2;yy<b[1]?(yy++,stepWidth=1):yy>b[1]&&(yy--,stepWidth=1),xx<b[0]?xx+=stepWidth:xx>b[0]||b[1]%2?xx-=stepWidth:xx+=stepWidth,this._map[xx][yy]=value;var p=[xx,yy],pkey=this._pointKey(p);connected[pkey]=p,delete notConnected[pkey]}connectionCallback&&connectionCallback(from,to)}},{key:"_freeSpace",value:function(x,y,value){return x>=0&&x<this._width&&y>=0&&y<this._height&&this._map[x][y]==value}},{key:"_pointKey",value:function(p){return p[0]+"."+p[1]}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Cellular}(_map_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Digger});var _dungeon_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(204),_features_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(205),_rng_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(179),_constants_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(190);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var FEATURES={room:_features_js__WEBPACK_IMPORTED_MODULE_1__.Room,corridor:_features_js__WEBPACK_IMPORTED_MODULE_1__.Corridor},Digger=function(_Dungeon){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Digger,_Dungeon);var Constructor,protoProps,staticProps,_super=_createSuper(Digger);function Digger(width,height){var _this,options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,Digger),(_this=_super.call(this,width,height))._options=Object.assign({roomWidth:[3,9],roomHeight:[3,5],corridorLength:[3,10],dugPercentage:.2,timeLimit:1e3},options),_this._features={room:4,corridor:4},_this._map=[],_this._featureAttempts=20,_this._walls={},_this._dug=0,_this._digCallback=_this._digCallback.bind(_assertThisInitialized(_this)),_this._canBeDugCallback=_this._canBeDugCallback.bind(_assertThisInitialized(_this)),_this._isWallCallback=_this._isWallCallback.bind(_assertThisInitialized(_this)),_this._priorityWallCallback=_this._priorityWallCallback.bind(_assertThisInitialized(_this)),_this}return Constructor=Digger,(protoProps=[{key:"create",value:function(callback){this._rooms=[],this._corridors=[],this._map=this._fillMap(1),this._walls={},this._dug=0;var area=(this._width-2)*(this._height-2);this._firstRoom();var priorityWalls,t1=Date.now();do{if(priorityWalls=0,Date.now()-t1>this._options.timeLimit)break;var wall=this._findWall();if(!wall)break;var parts=wall.split(","),x=parseInt(parts[0]),y=parseInt(parts[1]),dir=this._getDiggingDirection(x,y);if(dir){var featureAttempts=0;do{if(featureAttempts++,this._tryFeature(x,y,dir[0],dir[1])){this._removeSurroundingWalls(x,y),this._removeSurroundingWalls(x-dir[0],y-dir[1]);break}}while(featureAttempts<this._featureAttempts);for(var id in this._walls)this._walls[id]>1&&priorityWalls++}}while(this._dug/area<this._options.dugPercentage||priorityWalls);if(this._addDoors(),callback)for(var i=0;i<this._width;i++)for(var j=0;j<this._height;j++)callback(i,j,this._map[i][j]);return this._walls={},this._map=[],this}},{key:"_digCallback",value:function(x,y,value){0==value||2==value?(this._map[x][y]=0,this._dug++):this._walls[x+","+y]=1}},{key:"_isWallCallback",value:function(x,y){return!(x<0||y<0||x>=this._width||y>=this._height)&&1==this._map[x][y]}},{key:"_canBeDugCallback",value:function(x,y){return!(x<1||y<1||x+1>=this._width||y+1>=this._height)&&1==this._map[x][y]}},{key:"_priorityWallCallback",value:function(x,y){this._walls[x+","+y]=2}},{key:"_firstRoom",value:function(){var cx=Math.floor(this._width/2),cy=Math.floor(this._height/2),room=_features_js__WEBPACK_IMPORTED_MODULE_1__.Room.createRandomCenter(cx,cy,this._options);this._rooms.push(room),room.create(this._digCallback)}},{key:"_findWall",value:function(){var prio1=[],prio2=[];for(var _id in this._walls)2==this._walls[_id]?prio2.push(_id):prio1.push(_id);var arr=prio2.length?prio2:prio1;if(!arr.length)return null;var id=_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getItem(arr.sort());return delete this._walls[id],id}},{key:"_tryFeature",value:function(x,y,dx,dy){var featureName=_rng_js__WEBPACK_IMPORTED_MODULE_2__.default.getWeightedValue(this._features),feature=FEATURES[featureName].createRandomAt(x,y,dx,dy,this._options);return!!feature.isValid(this._isWallCallback,this._canBeDugCallback)&&(feature.create(this._digCallback),feature instanceof _features_js__WEBPACK_IMPORTED_MODULE_1__.Room&&this._rooms.push(feature),feature instanceof _features_js__WEBPACK_IMPORTED_MODULE_1__.Corridor&&(feature.createPriorityWalls(this._priorityWallCallback),this._corridors.push(feature)),!0)}},{key:"_removeSurroundingWalls",value:function(cx,cy){for(var deltas=_constants_js__WEBPACK_IMPORTED_MODULE_3__.DIRS[4],i=0;i<deltas.length;i++){var delta=deltas[i],x=cx+delta[0],y=cy+delta[1];delete this._walls[x+","+y],x=cx+2*delta[0],y=cy+2*delta[1],delete this._walls[x+","+y]}}},{key:"_getDiggingDirection",value:function(cx,cy){if(cx<=0||cy<=0||cx>=this._width-1||cy>=this._height-1)return null;for(var result=null,deltas=_constants_js__WEBPACK_IMPORTED_MODULE_3__.DIRS[4],i=0;i<deltas.length;i++){var delta=deltas[i],x=cx+delta[0],y=cy+delta[1];if(!this._map[x][y]){if(result)return null;result=delta}}return result?[-result[0],-result[1]]:null}},{key:"_addDoors",value:function(){var data=this._map;function isWallCallback(x,y){return 1==data[x][y]}for(var i=0;i<this._rooms.length;i++){var room=this._rooms[i];room.clearDoors(),room.addDoors(isWallCallback)}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Digger}(_dungeon_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>EllerMaze});var _map_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(202),_rng_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function addToList(i,L,R){R[L[i+1]]=R[i],L[R[i]]=L[i+1],R[i]=i+1,L[i+1]=i}function removeFromList(i,L,R){R[L[i]]=R[i],L[R[i]]=L[i],R[i]=i,L[i]=i}var EllerMaze=function(_Map){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(EllerMaze,_Map);var Constructor,protoProps,staticProps,_super=_createSuper(EllerMaze);function EllerMaze(){return _classCallCheck(this,EllerMaze),_super.apply(this,arguments)}return Constructor=EllerMaze,(protoProps=[{key:"create",value:function(callback){for(var j,map=this._fillMap(1),w=Math.ceil((this._width-2)/2),L=[],R=[],i=0;i<w;i++)L.push(i),R.push(i);for(L.push(w-1),j=1;j+3<this._height;j+=2)for(var _i=0;_i<w;_i++){var x=2*_i+1,y=j;map[x][y]=0,_i!=L[_i+1]&&_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform()>.375&&(addToList(_i,L,R),map[x+1][y]=0),_i!=L[_i]&&_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform()>.375?removeFromList(_i,L,R):map[x][y+1]=0}for(var _i2=0;_i2<w;_i2++){var _x=2*_i2+1,_y=j;map[_x][_y]=0,_i2!=L[_i2+1]&&(_i2==L[_i2]||_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform()>.375)&&(addToList(_i2,L,R),map[_x+1][_y]=0),removeFromList(_i2,L,R)}for(var _i3=0;_i3<this._width;_i3++)for(var _j=0;_j<this._height;_j++)callback(_i3,_j,map[_i3][_j]);return this}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),EllerMaze}(_map_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>DividedMaze});var _map_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(202),_rng_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var DividedMaze=function(_Map){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DividedMaze,_Map);var Constructor,protoProps,staticProps,_super=_createSuper(DividedMaze);function DividedMaze(){var _this;return _classCallCheck(this,DividedMaze),(_this=_super.apply(this,arguments))._stack=[],_this._map=[],_this}return Constructor=DividedMaze,(protoProps=[{key:"create",value:function(callback){var w=this._width,h=this._height;this._map=[];for(var i=0;i<w;i++){this._map.push([]);for(var j=0;j<h;j++){var border=0==i||0==j||i+1==w||j+1==h;this._map[i].push(border?1:0)}}this._stack=[[1,1,w-2,h-2]],this._process();for(var _i=0;_i<w;_i++)for(var _j=0;_j<h;_j++)callback(_i,_j,this._map[_i][_j]);return this._map=[],this}},{key:"_process",value:function(){for(;this._stack.length;){var room=this._stack.shift();this._partitionRoom(room)}}},{key:"_partitionRoom",value:function(room){for(var availX=[],availY=[],i=room[0]+1;i<room[2];i++){var top=this._map[i][room[1]-1],bottom=this._map[i][room[3]+1];!top||!bottom||i%2||availX.push(i)}for(var j=room[1]+1;j<room[3];j++){var left=this._map[room[0]-1][j],right=this._map[room[2]+1][j];!left||!right||j%2||availY.push(j)}if(availX.length&&availY.length){var x=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getItem(availX),y=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getItem(availY);this._map[x][y]=1;var walls=[],w=[];walls.push(w);for(var _i2=room[0];_i2<x;_i2++)this._map[_i2][y]=1,_i2%2&&w.push([_i2,y]);w=[],walls.push(w);for(var _i3=x+1;_i3<=room[2];_i3++)this._map[_i3][y]=1,_i3%2&&w.push([_i3,y]);w=[],walls.push(w);for(var _j2=room[1];_j2<y;_j2++)this._map[x][_j2]=1,_j2%2&&w.push([x,_j2]);w=[],walls.push(w);for(var _j3=y+1;_j3<=room[3];_j3++)this._map[x][_j3]=1,_j3%2&&w.push([x,_j3]);for(var solid=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getItem(walls),_i4=0;_i4<walls.length;_i4++){var _w=walls[_i4];if(_w!=solid){var hole=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getItem(_w);this._map[hole[0]][hole[1]]=0}}this._stack.push([room[0],room[1],x-1,y-1]),this._stack.push([x+1,room[1],room[2],y-1]),this._stack.push([room[0],y+1,x-1,room[3]]),this._stack.push([x+1,y+1,room[2],room[3]])}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),DividedMaze}(_map_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>IceyMaze});var _map_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(202),_rng_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var IceyMaze=function(_Map){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(IceyMaze,_Map);var Constructor,protoProps,staticProps,_super=_createSuper(IceyMaze);function IceyMaze(width,height){var _this,regularity=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _classCallCheck(this,IceyMaze),(_this=_super.call(this,width,height))._regularity=regularity,_this._map=[],_this}return Constructor=IceyMaze,(protoProps=[{key:"create",value:function(callback){var width=this._width,height=this._height,map=this._fillMap(1);width-=width%2?1:2,height-=height%2?1:2;var cx=0,cy=0,nx=0,ny=0,done=0,blocked=!1,dirs=[[0,0],[0,0],[0,0],[0,0]];do{if(cx=1+2*Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform()*(width-1)/2),cy=1+2*Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform()*(height-1)/2),done||(map[cx][cy]=0),!map[cx][cy]){this._randomize(dirs);do{0==Math.floor(_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform()*(this._regularity+1))&&this._randomize(dirs),blocked=!0;for(var i=0;i<4;i++)if(nx=cx+2*dirs[i][0],ny=cy+2*dirs[i][1],this._isFree(map,nx,ny,width,height)){map[nx][ny]=0,map[cx+dirs[i][0]][cy+dirs[i][1]]=0,cx=nx,cy=ny,blocked=!1,done++;break}}while(!blocked)}}while(done+1<width*height/4);for(var _i=0;_i<this._width;_i++)for(var j=0;j<this._height;j++)callback(_i,j,map[_i][j]);return this._map=[],this}},{key:"_randomize",value:function(dirs){for(var i=0;i<4;i++)dirs[i][0]=0,dirs[i][1]=0;switch(Math.floor(4*_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform())){case 0:dirs[0][0]=-1,dirs[1][0]=1,dirs[2][1]=-1,dirs[3][1]=1;break;case 1:dirs[3][0]=-1,dirs[2][0]=1,dirs[1][1]=-1,dirs[0][1]=1;break;case 2:dirs[2][0]=-1,dirs[3][0]=1,dirs[0][1]=-1,dirs[1][1]=1;break;case 3:dirs[1][0]=-1,dirs[0][0]=1,dirs[3][1]=-1,dirs[2][1]=1}}},{key:"_isFree",value:function(map,x,y,width,height){return!(x<1||y<1||x>=width||y>=height)&&map[x][y]}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),IceyMaze}(_map_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Rogue});var _map_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(202),_rng_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179),_constants_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(190);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Rogue=function(_Map){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Rogue,_Map);var Constructor,protoProps,staticProps,_super=_createSuper(Rogue);function Rogue(width,height,options){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Rogue),(_this=_super.call(this,width,height)).map=[],_this.rooms=[],_this.connectedCells=[],(options=Object.assign({cellWidth:3,cellHeight:3},options)).hasOwnProperty("roomWidth")||(options.roomWidth=_this._calculateRoomSize(_this._width,options.cellWidth)),options.hasOwnProperty("roomHeight")||(options.roomHeight=_this._calculateRoomSize(_this._height,options.cellHeight)),_this._options=options,_this}return Constructor=Rogue,(protoProps=[{key:"create",value:function(callback){if(this.map=this._fillMap(1),this.rooms=[],this.connectedCells=[],this._initRooms(),this._connectRooms(),this._connectUnconnectedRooms(),this._createRandomRoomConnections(),this._createRooms(),this._createCorridors(),callback)for(var i=0;i<this._width;i++)for(var j=0;j<this._height;j++)callback(i,j,this.map[i][j]);return this}},{key:"_calculateRoomSize",value:function(size,cell){var max=Math.floor(size/cell*.8),min=Math.floor(size/cell*.25);return min<2&&(min=2),max<2&&(max=2),[min,max]}},{key:"_initRooms",value:function(){for(var i=0;i<this._options.cellWidth;i++){this.rooms.push([]);for(var j=0;j<this._options.cellHeight;j++)this.rooms[i].push({x:0,y:0,width:0,height:0,connections:[],cellx:i,celly:j})}}},{key:"_connectRooms",value:function(){var idx,ncgx,ncgy,room,otherRoom,dirToCheck,cgx=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(0,this._options.cellWidth-1),cgy=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(0,this._options.cellHeight-1),found=!1;do{dirToCheck=[0,2,4,6],dirToCheck=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.shuffle(dirToCheck);do{if(found=!1,idx=dirToCheck.pop(),ncgx=cgx+_constants_js__WEBPACK_IMPORTED_MODULE_2__.DIRS[8][idx][0],ncgy=cgy+_constants_js__WEBPACK_IMPORTED_MODULE_2__.DIRS[8][idx][1],!(ncgx<0||ncgx>=this._options.cellWidth||ncgy<0||ncgy>=this._options.cellHeight)){if((room=this.rooms[cgx][cgy]).connections.length>0&&room.connections[0][0]==ncgx&&room.connections[0][1]==ncgy)break;0==(otherRoom=this.rooms[ncgx][ncgy]).connections.length&&(otherRoom.connections.push([cgx,cgy]),this.connectedCells.push([ncgx,ncgy]),cgx=ncgx,cgy=ncgy,found=!0)}}while(dirToCheck.length>0&&0==found)}while(dirToCheck.length>0)}},{key:"_connectUnconnectedRooms",value:function(){var room,otherRoom,validRoom,cw=this._options.cellWidth,ch=this._options.cellHeight;this.connectedCells=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.shuffle(this.connectedCells);for(var i=0;i<this._options.cellWidth;i++)for(var j=0;j<this._options.cellHeight;j++)if(0==(room=this.rooms[i][j]).connections.length){var directions=[0,2,4,6];directions=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.shuffle(directions),validRoom=!1;do{var dirIdx=directions.pop(),newI=i+_constants_js__WEBPACK_IMPORTED_MODULE_2__.DIRS[8][dirIdx][0],newJ=j+_constants_js__WEBPACK_IMPORTED_MODULE_2__.DIRS[8][dirIdx][1];if(!(newI<0||newI>=cw||newJ<0||newJ>=ch)){if(validRoom=!0,0==(otherRoom=this.rooms[newI][newJ]).connections.length)break;for(var k=0;k<otherRoom.connections.length;k++)if(otherRoom.connections[k][0]==i&&otherRoom.connections[k][1]==j){validRoom=!1;break}if(validRoom)break}}while(directions.length);validRoom?room.connections.push([otherRoom.cellx,otherRoom.celly]):console.log("-- Unable to connect room.")}}},{key:"_createRandomRoomConnections",value:function(){}},{key:"_createRooms",value:function(){for(var roomw,roomh,sx,sy,otherRoom,w=this._width,h=this._height,cw=this._options.cellWidth,ch=this._options.cellHeight,cwp=Math.floor(this._width/cw),chp=Math.floor(this._height/ch),roomWidth=this._options.roomWidth,roomHeight=this._options.roomHeight,i=0;i<cw;i++)for(var j=0;j<ch;j++){if(0==(sx=cwp*i)&&(sx=1),0==(sy=chp*j)&&(sy=1),roomw=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(roomWidth[0],roomWidth[1]),roomh=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(roomHeight[0],roomHeight[1]),j>0)for(otherRoom=this.rooms[i][j-1];sy-(otherRoom.y+otherRoom.height)<3;)sy++;if(i>0)for(otherRoom=this.rooms[i-1][j];sx-(otherRoom.x+otherRoom.width)<3;)sx++;for(var sxOffset=Math.round(_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(0,cwp-roomw)/2),syOffset=Math.round(_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(0,chp-roomh)/2);sx+sxOffset+roomw>=w;)sxOffset?sxOffset--:roomw--;for(;sy+syOffset+roomh>=h;)syOffset?syOffset--:roomh--;sx+=sxOffset,sy+=syOffset,this.rooms[i][j].x=sx,this.rooms[i][j].y=sy,this.rooms[i][j].width=roomw,this.rooms[i][j].height=roomh;for(var ii=sx;ii<sx+roomw;ii++)for(var jj=sy;jj<sy+roomh;jj++)this.map[ii][jj]=0}}},{key:"_getWallPosition",value:function(aRoom,aDirection){var rx,ry,door;return 1==aDirection||3==aDirection?(rx=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(aRoom.x+1,aRoom.x+aRoom.width-2),door=1==aDirection?1+(ry=aRoom.y-2):(ry=aRoom.y+aRoom.height+1)-1,this.map[rx][door]=0):(ry=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniformInt(aRoom.y+1,aRoom.y+aRoom.height-2),door=2==aDirection?(rx=aRoom.x+aRoom.width+1)-1:1+(rx=aRoom.x-2),this.map[door][ry]=0),[rx,ry]}},{key:"_drawCorridor",value:function(startPosition,endPosition){var tempDist,xDir,yDir,move,xOffset=endPosition[0]-startPosition[0],yOffset=endPosition[1]-startPosition[1],xpos=startPosition[0],ypos=startPosition[1],moves=[],xAbs=Math.abs(xOffset),yAbs=Math.abs(yOffset),percent=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.getUniform(),firstHalf=percent,secondHalf=1-percent;for(xDir=xOffset>0?2:6,yDir=yOffset>0?4:0,xAbs<yAbs?(tempDist=Math.ceil(yAbs*firstHalf),moves.push([yDir,tempDist]),moves.push([xDir,xAbs]),tempDist=Math.floor(yAbs*secondHalf),moves.push([yDir,tempDist])):(tempDist=Math.ceil(xAbs*firstHalf),moves.push([xDir,tempDist]),moves.push([yDir,yAbs]),tempDist=Math.floor(xAbs*secondHalf),moves.push([xDir,tempDist])),this.map[xpos][ypos]=0;moves.length>0;)for(move=moves.pop();move[1]>0;)xpos+=_constants_js__WEBPACK_IMPORTED_MODULE_2__.DIRS[8][move[0]][0],ypos+=_constants_js__WEBPACK_IMPORTED_MODULE_2__.DIRS[8][move[0]][1],this.map[xpos][ypos]=0,move[1]=move[1]-1}},{key:"_createCorridors",value:function(){for(var room,connection,otherRoom,wall,otherWall,cw=this._options.cellWidth,ch=this._options.cellHeight,i=0;i<cw;i++)for(var j=0;j<ch;j++){room=this.rooms[i][j];for(var k=0;k<room.connections.length;k++)connection=room.connections[k],(otherRoom=this.rooms[connection[0]][connection[1]]).cellx>room.cellx?(wall=2,otherWall=4):otherRoom.cellx<room.cellx?(wall=4,otherWall=2):otherRoom.celly>room.celly?(wall=3,otherWall=1):(wall=1,otherWall=3),this._drawCorridor(this._getWallPosition(room,wall),this._getWallPosition(otherRoom,otherWall))}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Rogue}(_map_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={Simplex:__webpack_require__(213).default}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Simplex});var _noise_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(214),_rng_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(179),_util_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(107);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var F2=.5*(Math.sqrt(3)-1),G2=(3-Math.sqrt(3))/6,Simplex=function(_Noise){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Simplex,_Noise);var Constructor,protoProps,staticProps,_super=_createSuper(Simplex);function Simplex(){var _this,gradients=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;_classCallCheck(this,Simplex),(_this=_super.call(this))._gradients=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]];for(var permutations=[],i=0;i<gradients;i++)permutations.push(i);permutations=_rng_js__WEBPACK_IMPORTED_MODULE_1__.default.shuffle(permutations),_this._perms=[],_this._indexes=[];for(var _i=0;_i<2*gradients;_i++)_this._perms.push(permutations[_i%gradients]),_this._indexes.push(_this._perms[_i]%_this._gradients.length);return _this}return Constructor=Simplex,(protoProps=[{key:"get",value:function(xin,yin){var gi,i1,j1,perms=this._perms,indexes=this._indexes,count=perms.length/2,n0=0,n1=0,n2=0,s=(xin+yin)*F2,i=Math.floor(xin+s),j=Math.floor(yin+s),t=(i+j)*G2,x0=xin-(i-t),y0=yin-(j-t);x0>y0?(i1=1,j1=0):(i1=0,j1=1);var x1=x0-i1+G2,y1=y0-j1+G2,x2=x0-1+2*G2,y2=y0-1+2*G2,ii=(0,_util_js__WEBPACK_IMPORTED_MODULE_2__.mod)(i,count),jj=(0,_util_js__WEBPACK_IMPORTED_MODULE_2__.mod)(j,count),t0=.5-x0*x0-y0*y0;if(t0>=0){t0*=t0,gi=indexes[ii+perms[jj]];var grad=this._gradients[gi];n0=t0*t0*(grad[0]*x0+grad[1]*y0)}var t1=.5-x1*x1-y1*y1;if(t1>=0){t1*=t1,gi=indexes[ii+i1+perms[jj+j1]];var _grad=this._gradients[gi];n1=t1*t1*(_grad[0]*x1+_grad[1]*y1)}var t2=.5-x2*x2-y2*y2;if(t2>=0){t2*=t2,gi=indexes[ii+1+perms[jj+1]];var _grad2=this._gradients[gi];n2=t2*t2*(_grad2[0]*x2+_grad2[1]*y2)}return 70*(n0+n1+n2)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Simplex}(_noise_js__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Noise});var Noise=function Noise(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Noise)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _dijkstra_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(216),_astar_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(218);const __WEBPACK_DEFAULT_EXPORT__={Dijkstra:_dijkstra_js__WEBPACK_IMPORTED_MODULE_0__.default,AStar:_astar_js__WEBPACK_IMPORTED_MODULE_1__.default}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Dijkstra});var Dijkstra=function(_Path){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Dijkstra,_Path);var Constructor,protoProps,staticProps,_super=_createSuper(Dijkstra);function Dijkstra(toX,toY,passableCallback,options){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Dijkstra),(_this=_super.call(this,toX,toY,passableCallback,options))._computed={},_this._todo=[],_this._add(toX,toY,null),_this}return Constructor=Dijkstra,(protoProps=[{key:"compute",value:function(fromX,fromY,callback){var key=fromX+","+fromY;if(key in this._computed||this._compute(fromX,fromY),key in this._computed)for(var item=this._computed[key];item;)callback(item.x,item.y),item=item.prev}},{key:"_compute",value:function(fromX,fromY){for(;this._todo.length;){var item=this._todo.shift();if(item.x==fromX&&item.y==fromY)return;for(var neighbors=this._getNeighbors(item.x,item.y),i=0;i<neighbors.length;i++){var neighbor=neighbors[i],x=neighbor[0],y=neighbor[1];x+","+y in this._computed||this._add(x,y,item)}}}},{key:"_add",value:function(x,y,prev){var obj={x,y,prev};this._computed[x+","+y]=obj,this._todo.push(obj)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Dijkstra}(__webpack_require__(217).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Path});var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(190);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Path=function(){function Path(toX,toY,passableCallback){var options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};_classCallCheck(this,Path),this._toX=toX,this._toY=toY,this._passableCallback=passableCallback,this._options=Object.assign({topology:8},options),this._dirs=_constants_js__WEBPACK_IMPORTED_MODULE_0__.DIRS[this._options.topology],8==this._options.topology&&(this._dirs=[this._dirs[0],this._dirs[2],this._dirs[4],this._dirs[6],this._dirs[1],this._dirs[3],this._dirs[5],this._dirs[7]])}var Constructor,protoProps,staticProps;return Constructor=Path,(protoProps=[{key:"_getNeighbors",value:function(cx,cy){for(var result=[],i=0;i<this._dirs.length;i++){var dir=this._dirs[i],x=cx+dir[0],y=cy+dir[1];this._passableCallback(x,y)&&result.push([x,y])}return result}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Path}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>AStar});var AStar=function(_Path){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(AStar,_Path);var Constructor,protoProps,staticProps,_super=_createSuper(AStar);function AStar(toX,toY,passableCallback){var _this,options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _classCallCheck(this,AStar),(_this=_super.call(this,toX,toY,passableCallback,options))._todo=[],_this._done={},_this}return Constructor=AStar,(protoProps=[{key:"compute",value:function(fromX,fromY,callback){for(this._todo=[],this._done={},this._fromX=fromX,this._fromY=fromY,this._add(this._toX,this._toY,null);this._todo.length;){var _item=this._todo.shift(),id=_item.x+","+_item.y;if(!(id in this._done)){if(this._done[id]=_item,_item.x==fromX&&_item.y==fromY)break;for(var neighbors=this._getNeighbors(_item.x,_item.y),i=0;i<neighbors.length;i++){var neighbor=neighbors[i],x=neighbor[0],y=neighbor[1];x+","+y in this._done||this._add(x,y,_item)}}}var item=this._done[fromX+","+fromY];if(item)for(;item;)callback(item.x,item.y),item=item.prev}},{key:"_add",value:function(x,y,prev){for(var h=this._distance(x,y),obj={x,y,prev,g:prev?prev.g+1:0,h},f=obj.g+obj.h,i=0;i<this._todo.length;i++){var item=this._todo[i],itemF=item.g+item.h;if(f<itemF||f==itemF&&h<item.h)return void this._todo.splice(i,0,obj)}this._todo.push(obj)}},{key:"_distance",value:function(x,y){switch(this._options.topology){case 4:return Math.abs(x-this._fromX)+Math.abs(y-this._fromY);case 6:var dx=Math.abs(x-this._fromX),dy=Math.abs(y-this._fromY);return dy+Math.max(0,(dx-dy)/2);case 8:return Math.max(Math.abs(x-this._fromX),Math.abs(y-this._fromY))}}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),AStar}(__webpack_require__(217).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Engine});var Engine=function(){function Engine(scheduler){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Engine),this._scheduler=scheduler,this._lock=1}var Constructor,protoProps,staticProps;return Constructor=Engine,(protoProps=[{key:"start",value:function(){return this.unlock()}},{key:"lock",value:function(){return this._lock++,this}},{key:"unlock",value:function(){if(!this._lock)throw new Error("Cannot unlock unlocked engine");for(this._lock--;!this._lock;){var actor=this._scheduler.next();if(!actor)return this.lock();var result=actor.act();result&&result.then&&(this.lock(),result.then(this.unlock.bind(this)))}return this}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Engine}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>Lighting});var _color_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(187);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Lighting=function(){function Lighting(reflectivityCallback){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,Lighting),this._reflectivityCallback=reflectivityCallback,this._options={},options=Object.assign({passes:1,emissionThreshold:100,range:10},options),this._lights={},this._reflectivityCache={},this._fovCache={},this.setOptions(options)}var Constructor,protoProps,staticProps;return Constructor=Lighting,(protoProps=[{key:"setOptions",value:function(options){return Object.assign(this._options,options),options&&options.range&&this.reset(),this}},{key:"setFOV",value:function(fov){return this._fov=fov,this._fovCache={},this}},{key:"setLight",value:function(x,y,color){var key=x+","+y;return color?this._lights[key]="string"==typeof color?_color_js__WEBPACK_IMPORTED_MODULE_0__.fromString(color):color:delete this._lights[key],this}},{key:"clearLights",value:function(){this._lights={}}},{key:"reset",value:function(){return this._reflectivityCache={},this._fovCache={},this}},{key:"compute",value:function(lightingCallback){var doneCells={},emittingCells={},litCells={};for(var key in this._lights){var light=this._lights[key];emittingCells[key]=[0,0,0],_color_js__WEBPACK_IMPORTED_MODULE_0__.add_(emittingCells[key],light)}for(var i=0;i<this._options.passes;i++)this._emitLight(emittingCells,litCells,doneCells),i+1!=this._options.passes&&(emittingCells=this._computeEmitters(litCells,doneCells));for(var litKey in litCells){var parts=litKey.split(",");lightingCallback(parseInt(parts[0]),parseInt(parts[1]),litCells[litKey])}return this}},{key:"_emitLight",value:function(emittingCells,litCells,doneCells){for(var key in emittingCells){var parts=key.split(","),x=parseInt(parts[0]),y=parseInt(parts[1]);this._emitLightFromCell(x,y,emittingCells[key],litCells),doneCells[key]=1}return this}},{key:"_computeEmitters",value:function(litCells,doneCells){var result={};for(var key in litCells)if(!(key in doneCells)){var color=litCells[key],reflectivity=void 0;if(key in this._reflectivityCache)reflectivity=this._reflectivityCache[key];else{var parts=key.split(","),x=parseInt(parts[0]),y=parseInt(parts[1]);reflectivity=this._reflectivityCallback(x,y),this._reflectivityCache[key]=reflectivity}if(0!=reflectivity){for(var emission=[0,0,0],intensity=0,i=0;i<3;i++){var part=Math.round(color[i]*reflectivity);emission[i]=part,intensity+=part}intensity>this._options.emissionThreshold&&(result[key]=emission)}}return result}},{key:"_emitLightFromCell",value:function(x,y,color,litCells){var fov,key=x+","+y;for(var fovKey in fov=key in this._fovCache?this._fovCache[key]:this._updateFOV(x,y)){var formFactor=fov[fovKey],result=void 0;fovKey in litCells?result=litCells[fovKey]:(result=[0,0,0],litCells[fovKey]=result);for(var i=0;i<3;i++)result[i]+=Math.round(color[i]*formFactor)}return this}},{key:"_updateFOV",value:function(x,y){var key1=x+","+y,cache={};this._fovCache[key1]=cache;var range=this._options.range;return this._fov.compute(x,y,range,function(x,y,r,vis){var formFactor=vis*(1-r/range);0!=formFactor&&(cache[x+","+y]=formFactor)}.bind(this)),cache}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Lighting}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>MeleeSystem});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_System__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var _query=new WeakMap,MeleeSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MeleeSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(MeleeSystem);function MeleeSystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MeleeSystem),_this=_super.call(this,game),_query.set(_assertThisInitialized(_this),{writable:!0,value:null}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_query,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.MeleeCommand]})),_this}return Constructor=MeleeSystem,(protoProps=[{key:"update",value:function(dt){(function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value})(this,_query).get().forEach((function(entity){var target=entity.meleeCommand.target;target&&entity.fireEvent("try-melee",{target}),entity.meleeCommand.destroy()}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),MeleeSystem}(_System__WEBPACK_IMPORTED_MODULE_1__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>DeathSystem});var _core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(53),_ecs_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_System__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var _query=new WeakMap,DeathSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DeathSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(DeathSystem);function DeathSystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DeathSystem),_this=_super.call(this,game),_query.set(_assertThisInitialized(_this),{writable:!0,value:null}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_query,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsDead],none:[_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsDestroying]})),_this}return Constructor=DeathSystem,(protoProps=[{key:"update",value:function(dt){var _this2=this;(function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value})(this,_query).get().forEach((function(entity){entity.fireEvent("death"),entity.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsPlayer)?_this2.game.screens.setScreen(_core_screens_ScreenType__WEBPACK_IMPORTED_MODULE_0__.SCREEN_DEATH):entity.add(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsDestroying)}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),DeathSystem}(_System__WEBPACK_IMPORTED_MODULE_2__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ParticleSystem});__webpack_require__(3);var _ecs_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_System__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}var _particleQuery=new WeakMap,_emitterQuery=new WeakMap,ParticleSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ParticleSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(ParticleSystem);function ParticleSystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ParticleSystem),_this=_super.call(this,game),_particleQuery.set(_assertThisInitialized(_this),{writable:!0,value:null}),_emitterQuery.set(_assertThisInitialized(_this),{writable:!0,value:null}),_classPrivateFieldSet(_assertThisInitialized(_this),_emitterQuery,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_1__.ParticleEmitter]})),_classPrivateFieldSet(_assertThisInitialized(_this),_particleQuery,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Particle]})),_this}return Constructor=ParticleSystem,(protoProps=[{key:"createParticle",value:function(x,y){var properties=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=this.game.ecs.createEntity();e.add(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.Particle,_objectSpread(_objectSpread({},properties),{},{x,y}))}},{key:"createEmitter",value:function(x,y){var particleData=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=this.game.ecs.createEntity();e.add(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.ParticleEmitter,{x,y,particleData:_objectSpread({direction:{x:0,y:1},glyphs:["░","▒","▓","█"],fg1s:["cyan","blue"],speed:.04,lifetime:600},particleData)})}},{key:"update",value:function(dt){var _this2=this;_classPrivateFieldGet(this,_emitterQuery).get().forEach((function(entity){var emitter=entity.particleEmitter;if(emitter.age+=dt,emitter.isExpired)entity.destroy();else for(var total=emitter.rate/1e3*emitter.duration,targetCount=Math.trunc(emitter.percent*total),i=emitter.count;i<targetCount;i++)emitter.createParticle()})),_classPrivateFieldGet(this,_particleQuery).get().forEach((function(entity){var particle=entity.particle;if(particle.age+=dt,particle.isExpired)entity.destroy();else if(particle.x+=particle.direction.x*particle.speed,particle.y+=particle.direction.y*particle.speed,_this2.game.camera.isInView(particle.x,particle.y)){var screen=_this2.game.camera.worldToScreen(particle.x,particle.y);_this2.game.renderer.draw(Math.round(screen.x),Math.round(screen.y),particle.glyph,particle.fg1,particle.fg2,particle.bg)}}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ParticleSystem}(_System__WEBPACK_IMPORTED_MODULE_2__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>FactionManager});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_enums_Factions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(92);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var FactionManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(FactionManager,_Manager);var _super=_createSuper(FactionManager);function FactionManager(game){var _this,obj,key,value;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FactionManager),_this=_super.call(this,game),obj=_assertThisInitialized(_this),value={},(key="relations")in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,_this.setRelation(_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.FACTION_PLAYER,_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.FACTION_GOBLIN,-300),_this.setRelation(_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.FACTION_PLAYER,_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.FACTION_VILLAGER,120),_this.setRelation(_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.FACTION_GOBLIN,_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.FACTION_VILLAGER,-400),_this}return _createClass(FactionManager,[{key:"factions",get:function(){return Object.values(_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.factions)}}]),_createClass(FactionManager,[{key:"getFactionById",value:function(id){return this.factions.find((function(f){return f.id===id}))}},{key:"getFactionByName",value:function(name){return(0,_enums_Factions__WEBPACK_IMPORTED_MODULE_1__.getFactionByName)(name)}},{key:"isHostile",value:function(factionA,factionB){return factionA!==factionB}},{key:"_relationKey",value:function(idA,idB){return[idA,idB].sort().join("-")}},{key:"setRelation",value:function(idA,idB,value){var key=this._relationKey(idA,idB);this.relations[key]=value}},{key:"getRelation",value:function(idA,idB){var key=this._relationKey(idA,idB);return this.relations.hasOwnProperty(key)||(this.relations[key]=0),this.relations[key]}},{key:"getEntityRelation",value:function(entityA,entityB){var memberA=entityA.get(_ecs_components__WEBPACK_IMPORTED_MODULE_0__.FactionMember),memberB=entityB.get(_ecs_components__WEBPACK_IMPORTED_MODULE_0__.FactionMember);if(memberA&&memberB){var factionA=memberA.faction,factionB=memberB.faction;return this.getRelation(factionA.id,factionB.id)}return 0}},{key:"areEntitiesHostile",value:function(entityA,entityB){return this.getEntityRelation(entityA,entityB)<-200}},{key:"getDisplay",value:function(value){return value<=-300?"Aggressive":value<=-200?"Unfriendly":value>=300?"Loyal":value>=200?"Friendly":value>=100?"Amicable":"Neutral"}}]),FactionManager}(__webpack_require__(5).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CameraManager});var _Manager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _focusX=new WeakMap,_focusY=new WeakMap,CameraManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CameraManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(CameraManager);function CameraManager(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CameraManager),_defineProperty(_assertThisInitialized(_this=_super.call(this,game)),"width",32),_defineProperty(_assertThisInitialized(_this),"height",24),_defineProperty(_assertThisInitialized(_this),"zoom",2),_defineProperty(_assertThisInitialized(_this),"padding",4),_focusX.set(_assertThisInitialized(_this),{writable:!0,value:0}),_focusY.set(_assertThisInitialized(_this),{writable:!0,value:0}),window.addEventListener("resize",_this.onWindowResize.bind(_assertThisInitialized(_this))),_this.onWindowResize(),_this}return Constructor=CameraManager,(protoProps=[{key:"computeSize",value:function(){this.width=Math.floor(window.innerWidth/this.renderedTileWidth)-2,this.height=Math.floor(window.innerHeight/this.renderedTileHeight)-2}},{key:"onWindowResize",value:function(){this.computeSize(),this.game.renderer.resizeDisplay(this.width,this.height,this.zoom)}},{key:"setZoom",value:function(zoom){this.zoom=zoom,this.onWindowResize()}},{key:"setFocus",value:function(x,y){_classPrivateFieldSet(this,_focusX,x),_classPrivateFieldSet(this,_focusY,y)}},{key:"worldToScreen",value:function(x,y){return{x:x-this.topLeftWorldX,y:y-this.topLeftWorldY}}},{key:"screenToWorld",value:function(x,y){return{x:x+this.topLeftWorldX,y:y+this.topLeftWorldY}}},{key:"isInView",value:function(worldX,worldY){var screen=this.worldToScreen(worldX,worldY);return screen.x<this.width&&screen.y<this.height&&screen.x>=0&&screen.y>=0}},{key:"renderedTileWidth",get:function(){return this.zoom*this.game.renderer.tileWidth}},{key:"renderedTileHeight",get:function(){return this.zoom*this.game.renderer.tileHeight}},{key:"topLeftWorldX",get:function(){return Math.floor(Math.min(Math.max(-this.padding,_classPrivateFieldGet(this,_focusX)-this.width/2),Math.max((this.width-this.game.map.width)/-2,this.padding+this.game.map.width-this.width)))}},{key:"topLeftWorldY",get:function(){return Math.floor(Math.min(Math.max(-this.padding,_classPrivateFieldGet(this,_focusY)-this.height/2),Math.max((this.height-this.game.map.height)/-2,this.padding+this.game.map.height-this.height)))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CameraManager}(_Manager__WEBPACK_IMPORTED_MODULE_0__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>FPSMonitoringSystem});var FPSMonitoringSystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(FPSMonitoringSystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(FPSMonitoringSystem);function FPSMonitoringSystem(){return _classCallCheck(this,FPSMonitoringSystem),_super.apply(this,arguments)}return Constructor=FPSMonitoringSystem,(protoProps=[{key:"update",value:function(dt){var sector=this.game.world.sector,sectorTxt="";sector&&(sectorTxt="(".concat(sector.x,", ").concat(sector.y,")"));var fps=Math.trunc(1e3/dt),display="".concat(sectorTxt," ").concat(fps),textWidth=this.game.renderer.computeTextWidth(display),x=this.game.camera.width-textWidth;this.game.renderer.drawText(x,this.game.camera.height-1,display,"#172e2e")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),FPSMonitoringSystem}(__webpack_require__(114).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WorldManager:()=>WorldManager});var _data_WorldData__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(228),_ecs_components__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_Manager__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5),_screens_ScreenType__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(53);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _data=new WeakMap,_sectorId=new WeakMap,_entry=new WeakMap,WorldManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(WorldManager,_Manager);var _super=_createSuper(WorldManager);function WorldManager(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,WorldManager),_this=_super.call(this,game),_data.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_sectorId.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_entry.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),_classPrivateFieldSet(_assertThisInitialized(_this),_data,new _data_WorldData__WEBPACK_IMPORTED_MODULE_0__.default),_this}return _createClass(WorldManager,[{key:"sectorId",get:function(){return _classPrivateFieldGet(this,_sectorId)}},{key:"sector",get:function(){return _classPrivateFieldGet(this,_data).getSector(_classPrivateFieldGet(this,_sectorId))}},{key:"entry",get:function(){return _classPrivateFieldGet(this,_entry)}}]),_createClass(WorldManager,[{key:"getSetupData",value:function(){return{sectorId:_classPrivateFieldGet(this,_data).getStartingSector().id,exploredSectorIds:[]}}},{key:"getSaveGameData",value:function(){var data=Array.from(this.game.ecs.entities.all).filter((function(e){return!e.has(_ecs_components__WEBPACK_IMPORTED_MODULE_1__.IsPlayer)})),serialized=this.game.ecs.serialize(data);return console.log("serialized map data",serialized),this.game.state.saveSectorEntityData(this.sector.id,serialized),{sectorId:this.sector.id,exploredSectorIds:[]}}},{key:"setup",value:function(data){var sector=_classPrivateFieldGet(this,_data).getSector(data.sectorId);this.game.screens.setScreen(_screens_ScreenType__WEBPACK_IMPORTED_MODULE_3__.SCREEN_LOAD_SECTOR,{nextSector:sector,entry:data.position})}},{key:"teardown",value:function(){_classPrivateFieldSet(this,_sectorId,null)}},{key:"onSectorLoaded",value:function(sector,entry){_classPrivateFieldSet(this,_sectorId,sector.id);var data=this.game.state.loadSectorEntityData(sector.id);data?(console.log("loading sector...",data),this.game.ecs.deserialize(data)):(console.log("generating sector..."),sector.generate(this.game))}},{key:"enterSector",value:function(sector,entry){this.game.screens.setScreen(_screens_ScreenType__WEBPACK_IMPORTED_MODULE_3__.SCREEN_LOAD_SECTOR,{prevousSector:this.sector,nextSector:sector,entry})}}]),WorldManager}(_Manager__WEBPACK_IMPORTED_MODULE_2__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>WorldData});var _Sector__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(229),_world_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(252);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _sectors=new WeakMap,WorldData=function(){function WorldData(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,WorldData),_sectors.set(this,{writable:!0,value:[]}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_sectors,[]);for(var x=0;x<_world_json__WEBPACK_IMPORTED_MODULE_1__.width;x++)for(var y=0;y<_world_json__WEBPACK_IMPORTED_MODULE_1__.height;y++){var sector=_Sector__WEBPACK_IMPORTED_MODULE_0__.Sector.parseData(this,_world_json__WEBPACK_IMPORTED_MODULE_1__.sectors[y][x],x,y);_classPrivateFieldGet(this,_sectors)[sector.id]=sector}}return _createClass(WorldData,[{key:"idx",value:function(x,y){return y*this.width+x}},{key:"coord",value:function(idx){return{x:Math.trunc(idx%this.width),y:Math.trunc(idx/this.width)}}},{key:"width",get:function(){return _world_json__WEBPACK_IMPORTED_MODULE_1__.width}},{key:"height",get:function(){return _world_json__WEBPACK_IMPORTED_MODULE_1__.height}}]),_createClass(WorldData,[{key:"isOutOfBounds",value:function(x,y){return x<0||y<0||x>=this.width||y>=this.height}},{key:"getStartingSector",value:function(){return this.getSector(4)}},{key:"getSectorByCoord",value:function(x,y){return this.getSector(this.idx(x,y))}},{key:"getSector",value:function(idx){var _this$coord=this.coord(idx),x=_this$coord.x,y=_this$coord.y;return this.isOutOfBounds(x,y)?new _Sector__WEBPACK_IMPORTED_MODULE_0__.Sector(this,x,y):_classPrivateFieldGet(this,_sectors)[idx]}}]),WorldData}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Sector:()=>Sector});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_level_generators_generators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(230);function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _x=new WeakMap,_y=new WeakMap,Sector=function(){function Sector(world,x,y){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Sector),_x.set(this,{writable:!0,value:0}),_y.set(this,{writable:!0,value:0}),_defineProperty(this,"connectionsNorth",[]),_defineProperty(this,"connectionsWest",[]),_defineProperty(this,"generator",{}),_defineProperty(this,"music",null),this.world=world,_classPrivateFieldSet(this,_x,x),_classPrivateFieldSet(this,_y,y)}return _createClass(Sector,[{key:"x",get:function(){return _classPrivateFieldGet(this,_x)}},{key:"y",get:function(){return _classPrivateFieldGet(this,_y)}},{key:"id",get:function(){return this.world.idx(this.x,this.y)}},{key:"northSector",get:function(){return this.world.getSectorByCoord(_classPrivateFieldGet(this,_x),_classPrivateFieldGet(this,_y)-1)}},{key:"southSector",get:function(){return this.world.getSectorByCoord(_classPrivateFieldGet(this,_x),_classPrivateFieldGet(this,_y)+1)}},{key:"eastSector",get:function(){return this.world.getSectorByCoord(_classPrivateFieldGet(this,_x)+1,_classPrivateFieldGet(this,_y))}},{key:"westSector",get:function(){return this.world.getSectorByCoord(_classPrivateFieldGet(this,_x)-1,_classPrivateFieldGet(this,_y))}}]),_createClass(Sector,[{key:"getExits",value:function(){var exits=[];return exits.push.apply(exits,_toConsumableArray(this.connectionsNorth.map((function(c){return{x:12,y:0}})))),exits.push.apply(exits,_toConsumableArray(this.connectionsWest.map((function(c){return{x:0,y:12}})))),exits.push.apply(exits,_toConsumableArray(this.eastSector.connectionsWest.map((function(c){return{x:_core_Game__WEBPACK_IMPORTED_MODULE_0__.game.map.width-1,y:12}})))),exits.push.apply(exits,_toConsumableArray(this.southSector.connectionsNorth.map((function(c){return{x:12,y:_core_Game__WEBPACK_IMPORTED_MODULE_0__.game.map.height-1}})))),exits}},{key:"generate",value:function(game){var exits=this.getExits(),generator=(0,_level_generators_generators__WEBPACK_IMPORTED_MODULE_1__.getGenerator)(this.generator.type),settings={width:game.map.width,height:game.map.height,exits},tiles=generator.generate(settings);generator.populate(settings,tiles),this.tiles=tiles}}],[{key:"parseData",value:function(world,data,x,y){var sector=new Sector(world,x,y);return sector.connectionsNorth=data.connectionsNorth,sector.connectionsWest=data.connectionsWest,sector.generator=data.generator,sector.music=data.music,sector}}]),Sector}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{getGenerator:()=>getGenerator});var _mapping,_ForestCabinsGenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(231),_ForestGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(246),_ForestStrongholdGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(247),_ForestTownGenerator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(249);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var mapping=(_defineProperty(_mapping={},"FOREST",_ForestGenerator__WEBPACK_IMPORTED_MODULE_1__.ForestGenerator),_defineProperty(_mapping,"FOREST_STRONGHOLD",_ForestStrongholdGenerator__WEBPACK_IMPORTED_MODULE_2__.ForestStrongholdGenerator),_defineProperty(_mapping,"FOREST_CABINS",_ForestCabinsGenerator__WEBPACK_IMPORTED_MODULE_0__.ForestCabinsGenerator),_defineProperty(_mapping,"FOREST_TOWN",_ForestTownGenerator__WEBPACK_IMPORTED_MODULE_3__.ForestTownGenerator),_mapping),getGenerator=function(name){return mapping[name]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ForestCabinsGenerator:()=>ForestCabinsGenerator});var _utils_rand__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(44),_LevelConnections__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(232),_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(239),_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(234);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ForestCabinsGenerator=function(_SectorGenerator){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ForestCabinsGenerator,_SectorGenerator);var Constructor,protoProps,staticProps,_super=_createSuper(ForestCabinsGenerator);function ForestCabinsGenerator(){return _classCallCheck(this,ForestCabinsGenerator),_super.apply(this,arguments)}return Constructor=ForestCabinsGenerator,staticProps=[{key:"generate",value:function(settings){var tiles=_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_2__.UniformScheme.generate({width:settings.width,height:settings.height});tiles.rooms.forEach((function(room){return room.theme=_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_FOREST}));var mediumRooms=tiles.rooms.filter((function(r){return r.width>=3&&r.height>=3})),room=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_0__.pickRandom)(mediumRooms);room&&(room.theme=_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_CABIN,room.includeWalls=!0);var distancedRooms=mediumRooms.filter((function(r){return r!==room})),room2=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_0__.pickRandom)(distancedRooms);return room2&&(room2.theme=_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_CABIN,room2.includeWalls=!0),tiles.getUnassignedTiles().forEach((function(tile){tile.theme=_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_FOREST})),(0,_LevelConnections__WEBPACK_IMPORTED_MODULE_1__.digExits)(tiles,settings.exits),tiles}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ForestCabinsGenerator}(__webpack_require__(245).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{digExit:()=>digExit,digExits:()=>digExits});var _utils_AStar__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(37),_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(38),_utils_ManhattanDistance__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39),_TileData__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(233),digExit=function(tiles,exit){var source=function(tiles,target){var closest=null,closestDistance=null;return tiles.data.forEach((function(tile){if(tile.isType(_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_FLOOR)){var distance=(0,_utils_ManhattanDistance__WEBPACK_IMPORTED_MODULE_2__.manhattanDistance)(tile,target);return distance<closestDistance||null===closest?(closest=tile,void(closestDistance=distance)):void 0}})),closest}(tiles,exit);if(source.x!==exit.x||source.y!==exit.y){tiles.setTileType(source.x,source.y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL),tiles.setTileType(exit.x,exit.y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL);var result=(0,_utils_AStar__WEBPACK_IMPORTED_MODULE_0__.computeAStar)({goal:{x:source.x,y:source.y},start:{x:exit.x,y:exit.y},cost:function(a,b){return tiles.isOnEdge(b.x,b.y)?1/0:tiles.tileTypeMatches(b.x,b.y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL)?(0,_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_1__.diagonalDistance)(a,b):1/0}});if(result.path.forEach((function(segment){tiles.setTileType(segment.x,segment.y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_FLOOR)})),result.success){var door=result.path[result.path.length-2],room=tiles.getRoomForTile(door.x,door.y);room&&room.addExit(door.x,door.y)}}else tiles.setTileType(exit.x,exit.y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_FLOOR)},digExits=function(tiles,exits){exits.forEach((function(exit){return digExit(tiles,exit)}))}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{TILE_TYPE_FLOOR:()=>TILE_TYPE_FLOOR,TILE_TYPE_WALL:()=>TILE_TYPE_WALL,TILE_TYPE_OUT_OF_BOUNDS:()=>TILE_TYPE_OUT_OF_BOUNDS,TileData:()=>TileData,createTileData:()=>createTileData});var _themes_TileTheme__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(234);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var TILE_TYPE_FLOOR=0,TILE_TYPE_WALL=1,TILE_TYPE_OUT_OF_BOUNDS=1,TileData=function(){function TileData(x,y){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TileData),_defineProperty(this,"x",-1),_defineProperty(this,"y",-1),_defineProperty(this,"type",TILE_TYPE_OUT_OF_BOUNDS),_defineProperty(this,"theme",_themes_TileTheme__WEBPACK_IMPORTED_MODULE_0__.TILE_THEME_CASTLE),this.x=x,this.y=y}var Constructor,protoProps,staticProps;return Constructor=TileData,(protoProps=[{key:"isType",value:function(type){return this.type===type}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),TileData}(),createTileData=function(x,y){return new TileData(x,y)}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{TILE_THEME_FOREST:()=>TILE_THEME_FOREST,TILE_THEME_CASTLE:()=>TILE_THEME_CASTLE,TILE_THEME_CABIN:()=>TILE_THEME_CABIN,getThemePopulator:()=>getThemePopulator});var _mapping,_CastleTheme__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(235),_ForestTheme__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(237),_CabinTheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(238);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var TILE_THEME_FOREST=0,TILE_THEME_CASTLE=1,TILE_THEME_CABIN=2,mapping=(_defineProperty(_mapping={},TILE_THEME_FOREST,_ForestTheme__WEBPACK_IMPORTED_MODULE_1__.default),_defineProperty(_mapping,TILE_THEME_CASTLE,_CastleTheme__WEBPACK_IMPORTED_MODULE_0__.default),_defineProperty(_mapping,TILE_THEME_CABIN,_CabinTheme__WEBPACK_IMPORTED_MODULE_2__.default),_mapping),getThemePopulator=function(theme){return mapping[theme]}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CastleTheme});var _data_Spawnables__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25),_data_Spawner__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(26),_utils_rand__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(44),_TileData__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(233);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var CastleTheme=function(_TileThemePopulator){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CastleTheme,_TileThemePopulator);var Constructor,protoProps,staticProps,_super=_createSuper(CastleTheme);function CastleTheme(){return _classCallCheck(this,CastleTheme),_super.apply(this,arguments)}return Constructor=CastleTheme,staticProps=[{key:"populateTile",value:function(tile){0===this.getEntities(tile).length&&tile.isType(_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL)&&(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_STONE_WALL,tile.x,tile.y)}},{key:"populateRoom",value:function(room){var _this=this;room.exits.forEach((function(exit){0===_this.getEntities(exit).length&&(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_WOOD_DOOR,exit.x,exit.y)})),room.tiles.forEach((function(tile){return _this.populateTile(tile)}));for(var i=0;i<(0,_utils_rand__WEBPACK_IMPORTED_MODULE_2__.randomInt)(0,3);i++)this.trySpawn(room,(function(tile){(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_STONE,tile.x,tile.y)}))}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CastleTheme}(__webpack_require__(236).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>TileThemePopulator});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_utils_rand__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(44);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var TileThemePopulator=function(){function TileThemePopulator(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TileThemePopulator)}var Constructor,protoProps,staticProps;return Constructor=TileThemePopulator,staticProps=[{key:"populateTile",value:function(tile){}},{key:"populateRoom",value:function(room){var _this=this;room.tiles.forEach((function(tile){_this.populateTile(tile)}))}},{key:"populate",value:function(tiles){var _this2=this;tiles.data.forEach((function(tile){_this2.populateTile(tile)}))}},{key:"getEntities",value:function(tile){return _core_Game__WEBPACK_IMPORTED_MODULE_0__.game.map.getEntitiesAt(tile.x,tile.y)}},{key:"clearTile",value:function(tile){getEntities(tile).forEach((function(e){e.destroy()}))}},{key:"getRandomEmptyTile",value:function(tileArr){for(var attempts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=0;i<attempts;i++){var tile=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_1__.pickRandom)(tileArr);if(this.getEntities(tile)<=0)return tile}console.warn("ran out of attempts (".concat(attempts,") to place item"),tileArr)}},{key:"trySpawn",value:function(room,cb){var tile=this.getRandomEmptyTile(room.interiorTiles);tile&&cb(tile)}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),TileThemePopulator}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ForestTheme});var _data_Spawnables__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25),_data_Spawner__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(26),_utils_rand__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(44),_TileData__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(233);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ForestTheme=function(_TileThemePopulator){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ForestTheme,_TileThemePopulator);var Constructor,protoProps,staticProps,_super=_createSuper(ForestTheme);function ForestTheme(){return _classCallCheck(this,ForestTheme),_super.apply(this,arguments)}return Constructor=ForestTheme,staticProps=[{key:"populateTile",value:function(tile){tile.isType(_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL)&&(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_PINE_TREE,tile.x,tile.y)}},{key:"populateRoom",value:function(room){var _this=this;room.tiles.forEach((function(tile){_this.populateTile(tile),Math.random()>.05||tile.isType(_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_FLOOR)&&(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_STONE,tile.x,tile.y)}));for(var i=0;i<(0,_utils_rand__WEBPACK_IMPORTED_MODULE_2__.randomInt)(0,1);i++)this.trySpawn(room,(function(tile){(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_GOBLIN_GRUNT,tile.x,tile.y)}));for(var _i=0;_i<(0,_utils_rand__WEBPACK_IMPORTED_MODULE_2__.randomInt)(0,1);_i++){if(Math.random()>.05)return;this.trySpawn(room,(function(tile){(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_VIAL_BLOOD,tile.x,tile.y)}))}for(var _i2=0;_i2<(0,_utils_rand__WEBPACK_IMPORTED_MODULE_2__.randomInt)(0,1);_i2++){if(Math.random()>.05)return;this.trySpawn(room,(function(tile){(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_VIAL_WATER,tile.x,tile.y)}))}for(var _i3=0;_i3<(0,_utils_rand__WEBPACK_IMPORTED_MODULE_2__.randomInt)(0,1);_i3++){if(Math.random()>.05)return;this.trySpawn(room,(function(tile){(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_VIAL_HONEY,tile.x,tile.y)}))}}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ForestTheme}(__webpack_require__(236).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>CabinTheme});var _data_Spawnables__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25),_data_Spawner__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(26),_utils_rand__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(44),_TileData__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(233);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var CabinTheme=function(_TileThemePopulator){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CabinTheme,_TileThemePopulator);var Constructor,protoProps,staticProps,_super=_createSuper(CabinTheme);function CabinTheme(){return _classCallCheck(this,CabinTheme),_super.apply(this,arguments)}return Constructor=CabinTheme,staticProps=[{key:"populateTile",value:function(tile){0===this.getEntities(tile).length&&tile.isType(_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL)&&(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_WOOD_WALL,tile.x,tile.y)}},{key:"populateRoom",value:function(room){var _this=this;room.exits.forEach((function(exit){0===_this.getEntities(exit).length&&(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_WOOD_DOOR,exit.x,exit.y)})),room.tiles.forEach((function(tile){return _this.populateTile(tile)})),this.trySpawn(room,(function(tile){var chest=(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_WOOD_CHEST,tile.x,tile.y);chest.inventory.addLoot((0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_VIAL_HONEY)),chest.inventory.addLoot((0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_STONE)),chest.inventory.addLoot((0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_AMULET)),chest.inventory.addLoot((0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_CLOTH_ARMOR)),chest.inventory.addLoot((0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_LEATHER_BOOTS)),chest.inventory.addLoot((0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_SHORTSWORD))}));for(var i=0;i<(0,_utils_rand__WEBPACK_IMPORTED_MODULE_2__.randomInt)(0,3);i++)this.trySpawn(room,(function(tile){(0,_data_Spawner__WEBPACK_IMPORTED_MODULE_1__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_0__.SPWN_HUMAN_WANDERER,tile.x,tile.y)}))}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),CabinTheme}(__webpack_require__(236).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{UniformScheme:()=>UniformScheme});var rot_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(178),_LevelConnections__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(232),_TileContainer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(240),_TileData__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(233);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var UniformScheme=function(_TileScheme){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(UniformScheme,_TileScheme);var Constructor,protoProps,staticProps,_super=_createSuper(UniformScheme);function UniformScheme(){return _classCallCheck(this,UniformScheme),_super.apply(this,arguments)}return Constructor=UniformScheme,staticProps=[{key:"generate",value:function(settings){var width=settings.width,height=settings.height,exits=settings.exits||[],tiles=new _TileContainer__WEBPACK_IMPORTED_MODULE_2__.default(width,height),generator=new rot_js__WEBPACK_IMPORTED_MODULE_0__.Map.Uniform(width,height,{timeLimit:8e3,roomWidth:settings.roomWidth||[2,8],roomHeight:settings.roomHeight||[2,8],roomDugPercentage:settings.digPercentage||.8});return generator.create((function(x,y,v){0===v&&tiles.setTileType(x,y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_FLOOR),1===v&&tiles.setTileType(x,y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL)})),generator.getRooms().forEach((function(r){var room=tiles.createRoom(r.getLeft(),r.getTop(),r.getRight()-r.getLeft()+1,r.getBottom()-r.getTop()+1);r.getDoors((function(x,y){room.addExit(x,y)}))})),(0,_LevelConnections__WEBPACK_IMPORTED_MODULE_1__.digExits)(tiles,exits),tiles}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),UniformScheme}(__webpack_require__(244).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>TileContainer});var _utils_Grid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),_RoomData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(241),_TileData__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(233);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classPrivateFieldSet(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}return value}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _defaultType=new WeakMap,_grid=new WeakMap,_rooms=new WeakMap,TileContainer=function(){function TileContainer(width,height){var defaultType=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR;_classCallCheck(this,TileContainer),_defaultType.set(this,{writable:!0,value:_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR}),_grid.set(this,{writable:!0,value:[]}),_rooms.set(this,{writable:!0,value:{}}),_classPrivateFieldSet(this,_grid,new _utils_Grid__WEBPACK_IMPORTED_MODULE_0__.default(width,height,_TileData__WEBPACK_IMPORTED_MODULE_2__.createTileData)),_classPrivateFieldSet(this,_defaultType,defaultType),this.clear()}return _createClass(TileContainer,[{key:"width",get:function(){return _classPrivateFieldGet(this,_grid).width}},{key:"height",get:function(){return _classPrivateFieldGet(this,_grid).height}},{key:"size",get:function(){return this.width*this.height}},{key:"data",get:function(){return _classPrivateFieldGet(this,_grid).data}},{key:"rooms",get:function(){return Object.values(_classPrivateFieldGet(this,_rooms))}}]),_createClass(TileContainer,[{key:"getTile",value:function(x,y){return _classPrivateFieldGet(this,_grid).get(x,y)}},{key:"setTileType",value:function(x,y,type){_classPrivateFieldGet(this,_grid).get(x,y).type=type}},{key:"setTileTheme",value:function(x,y,theme){_classPrivateFieldGet(this,_grid).get(x,y).theme=theme}},{key:"getTileType",value:function(x,y){return this.getTile(x,y).type}},{key:"addRoom",value:function(room){_classPrivateFieldGet(this,_rooms)[room.id]=room}},{key:"createRoom",value:function(x,y,width,height){var room=new _RoomData__WEBPACK_IMPORTED_MODULE_1__.default(x,y,width,height,this);return this.addRoom(room),room}},{key:"clear",value:function(){this.fill(0,0,this.width,this.height,_classPrivateFieldGet(this,_defaultType))}},{key:"fill",value:function(x,y,width,height,type){for(var i=x;i<x+width;i++)for(var j=y;j<y+height;j++)this.setTileType(i,j,type)}},{key:"tileTypeMatches",value:function(x,y,type){return this.getTile(x,y).isType(type)}},{key:"combineOther",value:function(offsetX,offsetY,tiles){var _this=this;tiles.rooms.forEach((function(room){room.cloneTo(room.x+offsetX,room.y+offsetY,_this)})),tiles.data.forEach((function(tile){_this.setTileType(tile.x+offsetX,tile.y+offsetY,tile.type),_this.setTileTheme(tile.x+offsetX,tile.y+offsetY,tile.theme)}))}},{key:"isOnEdge",value:function(x,y){return 0===x||0===y||x===this.width-1||y===this.height-1}},{key:"setTheme",value:function(theme){var _this2=this;this.data.forEach((function(tile){return _this2.setTileTheme(tile.x,tile.y,theme)})),this.rooms.forEach((function(room){return room.theme=theme}))}},{key:"getRoomForTile",value:function(x,y){var tile=this.getTile(x,y);return this.rooms.find((function(room){return room.tiles.includes(tile)}))}},{key:"getUnassignedTiles",value:function(){var _this3=this;return this.data.filter((function(tile){return!_this3.getRoomForTile(tile.x,tile.y)}))}},{key:"getNeighbors",value:function(x,y){return _classPrivateFieldGet(this,_grid).getNeighbors(x,y)}}]),TileContainer}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>RoomData});var nanoid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(242),_themes_TileTheme__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(234),_TileData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(233);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _container=new WeakMap,_exitCoords=new WeakMap,RoomData=function(){function RoomData(x,y,width,height,container){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RoomData),_defineProperty(this,"id",0),_defineProperty(this,"x",0),_defineProperty(this,"y",0),_defineProperty(this,"width",0),_defineProperty(this,"height",0),_defineProperty(this,"theme",_themes_TileTheme__WEBPACK_IMPORTED_MODULE_0__.TILE_THEME_FOREST),_defineProperty(this,"includeWalls",!1),_container.set(this,{writable:!0,value:null}),_exitCoords.set(this,{writable:!0,value:[]}),this.id=(0,nanoid__WEBPACK_IMPORTED_MODULE_2__.nanoid)(),this.x=x,this.y=y,this.width=width,this.height=height,function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_container,container)}return _createClass(RoomData,[{key:"relativeExits",get:function(){return _classPrivateFieldGet(this,_exitCoords)}},{key:"exits",get:function(){var _this=this;return this.relativeExits.map((function(exit){return{x:exit.x+_this.x,y:exit.y+_this.y}}))}},{key:"left",get:function(){return this.includeWalls?this.x-1:this.x}},{key:"right",get:function(){return this.includeWalls?this.x+this.width+1:this.x+this.width}},{key:"top",get:function(){return this.includeWalls?this.y-1:this.y}},{key:"bottom",get:function(){return this.includeWalls?this.y+this.height+1:this.y+this.height}},{key:"borderTiles",get:function(){for(var start=this.includeWalls?-1:0,endWidth=this.includeWalls?this.width+1:this.width,endHeight=this.includeWalls?this.height+1:this.height,borders=[],i=start;i<endWidth;i++)for(var j=start;j<endHeight;j++)i!==start&&i!==endWidth-1&&j!==start&&j!==endHeight-1||borders.push(_classPrivateFieldGet(this,_container).getTile(i+this.x,j+this.y));return borders}},{key:"interiorTiles",get:function(){for(var interior=[],i=0;i<this.width;i++)for(var j=0;j<this.height;j++)interior.push(_classPrivateFieldGet(this,_container).getTile(i+this.x,j+this.y));return interior}},{key:"tiles",get:function(){for(var start=this.includeWalls?-1:0,endWidth=this.includeWalls?this.width+1:this.width,endHeight=this.includeWalls?this.height+1:this.height,tiles=[],i=start;i<endWidth;i++)for(var j=start;j<endHeight;j++)tiles.push(_classPrivateFieldGet(this,_container).getTile(i+this.x,j+this.y));return tiles}}]),_createClass(RoomData,[{key:"addRelativeExit",value:function(x,y){_classPrivateFieldGet(this,_container).setTileType(this.x+x,this.y+y,_TileData__WEBPACK_IMPORTED_MODULE_1__.TILE_TYPE_FLOOR),_classPrivateFieldGet(this,_exitCoords).push({x,y})}},{key:"addExit",value:function(x,y){this.addRelativeExit(x-this.x,y-this.y)}},{key:"cloneTo",value:function(x,y,container){var room=new RoomData(x,y,this.width,this.height,container);return room.theme=this.theme,room.includeWalls=this.includeWalls,this.relativeExits.forEach((function(exit){room.addRelativeExit(exit.x,exit.y)})),container.addRoom(room),room}},{key:"containsPoint",value:function(x,y){return x<=this.right&&x>=this.left&&y<=this.bottom&&y>=this.top}},{key:"intersects",value:function(left,top,right,bottom){var c1=left<this.right,c2=right>this.left,c3=top<this.bottom,c4=bottom>this.top;return c1&&c2&&c3&&c4}}]),RoomData}()},(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{nanoid:()=>nanoid,customAlphabet:()=>customAlphabet,customRandom:()=>customRandom,urlAlphabet:()=>_url_alphabet_index_js__WEBPACK_IMPORTED_MODULE_0__.urlAlphabet,random:()=>random});var _url_alphabet_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(243);var random=function(bytes){return crypto.getRandomValues(new Uint8Array(bytes))},customRandom=function(alphabet,size,getRandom){var mask=(2<<Math.log(alphabet.length-1)/Math.LN2)-1,step=-~(1.6*mask*size/alphabet.length);return function(){for(var id="";;)for(var bytes=getRandom(step),j=step;j--;)if((id+=alphabet[bytes[j]&mask]||"").length===+size)return id}},customAlphabet=function(alphabet,size){return customRandom(alphabet,size,random)},nanoid=function(){for(var size=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,id="",bytes=crypto.getRandomValues(new Uint8Array(size));size--;){var _byte=63&bytes[size];id+=_byte<36?_byte.toString(36):_byte<62?(_byte-26).toString(36).toUpperCase():_byte<63?"_":"-"}return id}},(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{urlAlphabet:()=>urlAlphabet});var urlAlphabet="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>TileScheme});var TileScheme=function(){function TileScheme(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TileScheme)}var Constructor,protoProps,staticProps;return Constructor=TileScheme,staticProps=[{key:"generate",value:function(){}},{key:"populate",value:function(){}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),TileScheme}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>SectorGenerator});var _themes_TileTheme__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(234),_TileContainer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(240);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var SectorGenerator=function(){function SectorGenerator(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SectorGenerator)}var Constructor,protoProps,staticProps;return Constructor=SectorGenerator,staticProps=[{key:"generate",value:function(settings){return new _TileContainer__WEBPACK_IMPORTED_MODULE_1__.default(settings.width,settings.height)}},{key:"populate",value:function(settings,tiles){tiles.rooms.forEach((function(room){(0,_themes_TileTheme__WEBPACK_IMPORTED_MODULE_0__.getThemePopulator)(room.theme).populateRoom(room)})),tiles.getUnassignedTiles().forEach((function(tile){(0,_themes_TileTheme__WEBPACK_IMPORTED_MODULE_0__.getThemePopulator)(tile.theme).populateTile(tile)}))}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),SectorGenerator}()},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ForestGenerator:()=>ForestGenerator});var _LevelConnections__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(232),_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(239),_themes_TileTheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(234);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ForestGenerator=function(_SectorGenerator){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ForestGenerator,_SectorGenerator);var Constructor,protoProps,staticProps,_super=_createSuper(ForestGenerator);function ForestGenerator(){return _classCallCheck(this,ForestGenerator),_super.apply(this,arguments)}return Constructor=ForestGenerator,staticProps=[{key:"generate",value:function(settings){var tiles=_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_1__.UniformScheme.generate({width:settings.width,height:settings.height,exits:settings.exits});return tiles.setTheme(_themes_TileTheme__WEBPACK_IMPORTED_MODULE_2__.TILE_THEME_FOREST),(0,_LevelConnections__WEBPACK_IMPORTED_MODULE_0__.digExits)(tiles,settings.exits),tiles}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ForestGenerator}(__webpack_require__(245).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ForestStrongholdGenerator:()=>ForestStrongholdGenerator});var _LevelConnections__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(232),_schemes_DenseCastleScheme__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(248),_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(239),_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(234),_TileContainer__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(240);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ForestStrongholdGenerator=function(_SectorGenerator){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ForestStrongholdGenerator,_SectorGenerator);var Constructor,protoProps,staticProps,_super=_createSuper(ForestStrongholdGenerator);function ForestStrongholdGenerator(){return _classCallCheck(this,ForestStrongholdGenerator),_super.apply(this,arguments)}return Constructor=ForestStrongholdGenerator,staticProps=[{key:"generate",value:function(settings){var tiles=new _TileContainer__WEBPACK_IMPORTED_MODULE_4__.default(settings.width,settings.height),exitOffset=Math.ceil(2.5)-1,top=_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_2__.UniformScheme.generate({width:settings.width-5,height:5,exits:[{x:exitOffset,y:4},{x:settings.width-5-1,y:exitOffset-1},{x:16,y:4}]}),left=_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_2__.UniformScheme.generate({width:5,height:settings.height-5,exits:[{x:exitOffset,y:0},{x:4,y:settings.height-5-exitOffset-1}]}),bottom=_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_2__.UniformScheme.generate({width:settings.width-5,height:5,exits:[{x:0,y:exitOffset-1},{x:settings.width-5-exitOffset-1,y:0}]}),right=_schemes_UniformScheme__WEBPACK_IMPORTED_MODULE_2__.UniformScheme.generate({width:5,height:settings.height-5,exits:[{x:0,y:exitOffset-1},{x:exitOffset-1,y:settings.height-5-1}]}),castle=_schemes_DenseCastleScheme__WEBPACK_IMPORTED_MODULE_1__.DenseCastleScheme.generate({width:settings.width-10+2,height:settings.height-10+2,exits:[{x:12,y:0}]});return top.setTheme(_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_FOREST),left.setTheme(_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_FOREST),bottom.setTheme(_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_FOREST),right.setTheme(_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_FOREST),castle.setTheme(_themes_TileTheme__WEBPACK_IMPORTED_MODULE_3__.TILE_THEME_CASTLE),tiles.combineOther(0,0,top),tiles.combineOther(0,5,left),tiles.combineOther(5,settings.height-5,bottom),tiles.combineOther(settings.width-5,0,right),tiles.combineOther(4,4,castle),(0,_LevelConnections__WEBPACK_IMPORTED_MODULE_0__.digExits)(tiles,settings.exits),tiles}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ForestStrongholdGenerator}(__webpack_require__(245).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DenseCastleScheme:()=>DenseCastleScheme});var _LevelConnections__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(232),_TileContainer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(240),_TileData__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(233),_utils_rand__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(44),_utils_AStar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(37),_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(38),_TileScheme__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(244);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var curId=1,createNodeId=function(){return curId++},splitNodeVertical=function(node,cut){var leftId=createNodeId(),rightId=createNodeId();return[{id:leftId,isLeaf:!0,parentId:node.id,siblingId:rightId,offsetX:node.offsetX,offsetY:node.offsetY,width:cut,height:node.height},{id:rightId,isLeaf:!0,parentId:node.id,siblingId:leftId,offsetX:node.offsetX+cut,offsetY:node.offsetY,width:node.width-cut,height:node.height}]},splitNodeHorizontal=function(node,cut){var topId=createNodeId(),bottomId=createNodeId();return[{id:topId,isLeaf:!0,parentId:node.id,siblingId:bottomId,offsetX:node.offsetX,offsetY:node.offsetY,width:node.width,height:cut},{id:bottomId,isLeaf:!0,parentId:node.id,siblingId:topId,offsetX:node.offsetX,offsetY:node.offsetY+cut,width:node.width,height:node.height-cut}]},DenseCastleScheme=function(_TileScheme){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DenseCastleScheme,_TileScheme);var Constructor,protoProps,staticProps,_super=_createSuper(DenseCastleScheme);function DenseCastleScheme(){return _classCallCheck(this,DenseCastleScheme),_super.apply(this,arguments)}return Constructor=DenseCastleScheme,staticProps=[{key:"generate",value:function(settings){for(var width=settings.width,height=settings.height,exits=settings.exits||[],minRoomWidth=settings.minRoomWidth||4,minRoomHeight=settings.minRoomHeight||4,maxRoomWidth=settings.maxRoomWidth||12,maxRoomHeight=settings.maxRoomHeight||12,splitIgnoreChance=settings.splitIgnoreChance||.8,loopiness=settings.loopiness||35,tiles=new _TileContainer__WEBPACK_IMPORTED_MODULE_1__.default(width,height),i=0;i<width;i++)for(var j=0;j<height;j++)0===i||i===width-1||0===j||j===height-1?tiles.setTileType(i,j,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_WALL):tiles.setTileType(i,j,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR);for(var nodes=[{isLeaf:!0,parentId:null,siblingId:null,id:createNodeId(),offsetX:0,offsetY:0,height:height-1,width:width-1}],graph=[];nodes.length>0;){var node=nodes.pop();if(graph.push(node),!(node.width<maxRoomWidth&&node.height<maxRoomHeight&&Math.random()<splitIgnoreChance)){var directions=[];if(node.width-minRoomWidth-1>minRoomWidth&&directions.push(0),node.height-minRoomHeight-1>minRoomHeight&&directions.push(1),!(directions.length<=0)){if(0===(0,_utils_rand__WEBPACK_IMPORTED_MODULE_3__.pickRandom)(directions)){var cut=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_3__.randomInt)(minRoomWidth+1,node.width-minRoomWidth-1);nodes.push.apply(nodes,_toConsumableArray(splitNodeVertical(node,cut)))}else{var _cut=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_3__.randomInt)(minRoomHeight+1,node.height-minRoomHeight-1);nodes.push.apply(nodes,_toConsumableArray(splitNodeHorizontal(node,_cut)))}node.isLeaf=!1}}}graph.forEach((function(node){if(null!==node.parentId&&node.isLeaf){tiles.createRoom(node.offsetX+1,node.offsetY+1,node.width-1,node.height-1).includeWalls=!0;for(var _i=0;_i<node.width;_i++)tiles.setTileType(node.offsetX+_i,node.offsetY,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_WALL);for(var _j=0;_j<node.height;_j++)tiles.setTileType(node.offsetX,node.offsetY+_j,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_WALL)}})),graph.forEach((function(node){if(null!==node.parentId){var sibling=graph.find((function(n){return n.id===node.siblingId})),doorCandidates=[],hasSib=!1;if(sibling.offsetX<node.offsetX){hasSib=!0;for(var _i2=1;_i2<node.height;_i2++){var x=node.offsetX,y=node.offsetY+_i2,tile=tiles.getTile(x,y);tiles.tileTypeMatches(x-1,y,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)&&tiles.tileTypeMatches(x+1,y,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)&&doorCandidates.push(tile)}}else if(sibling.offsetY<node.offsetY){hasSib=!0;for(var _i3=1;_i3<node.width;_i3++){var _x=node.offsetX+_i3,_y=node.offsetY,_tile=tiles.getTile(_x,_y);tiles.tileTypeMatches(_x,_y-1,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)&&tiles.tileTypeMatches(_x,_y+1,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)&&doorCandidates.push(_tile)}}var door=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_3__.pickRandom)(doorCandidates);if(hasSib&&!door&&console.warn("cannot make door!?",node,node.width,node.height),door){var room=tiles.getRoomForTile(door.x,door.y);room&&room.addExit(door.x,door.y),tiles.setTileType(door.x,door.y,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)}}}));var cost=function(a,b){return tiles.tileTypeMatches(b.x,b.y,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)?(0,_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_5__.diagonalDistance)(a,b):1/0},tryAddLoop=function(a,b){if(a.isType(_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)&&b.isType(_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR)){var start={x:b.x,y:b.y},goal={x:a.x,y:a.y},path=(0,_utils_AStar__WEBPACK_IMPORTED_MODULE_4__.computeAStar)({start,goal,cost});if(path.success&&path.cost>=loopiness)return!0}return!1};return tiles.data.filter((function(tile){return tile.isType(_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_WALL)})).forEach((function(tile){var north=tiles.getTile(tile.x,tile.y-1),south=tiles.getTile(tile.x,tile.y+1);if(tryAddLoop(north,south)){tiles.setTileType(tile.x,tile.y,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR);var room=tiles.getRoomForTile(tile.x,tile.y);room&&room.addExit(tile.x,tile.y)}else{var east=tiles.getTile(tile.x-1,tile.y),west=tiles.getTile(tile.x+1,tile.y);if(tryAddLoop(east,west)){tiles.setTileType(tile.x,tile.y,_TileData__WEBPACK_IMPORTED_MODULE_2__.TILE_TYPE_FLOOR);var _room=tiles.getRoomForTile(tile.x,tile.y);_room&&_room.addExit(tile.x,tile.y)}}})),(0,_LevelConnections__WEBPACK_IMPORTED_MODULE_0__.digExits)(tiles,exits),tiles}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),DenseCastleScheme}(_TileScheme__WEBPACK_IMPORTED_MODULE_6__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ForestTownGenerator:()=>ForestTownGenerator});var _core_Game__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_data_Spawnables__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25),_data_Spawner__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(26),_utils_AStar__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(37),_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(38),_utils_rand__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(44),_LevelConnections__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(232),_schemes_ScatteredScheme__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(250),_themes_TileTheme__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(234),_TileData__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(233),_GeneratorUtils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(251),_SectorGenerator__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(245);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ForestTownGenerator=function(_SectorGenerator){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ForestTownGenerator,_SectorGenerator);var Constructor,protoProps,staticProps,_super=_createSuper(ForestTownGenerator);function ForestTownGenerator(){return _classCallCheck(this,ForestTownGenerator),_super.apply(this,arguments)}return Constructor=ForestTownGenerator,staticProps=[{key:"generate",value:function(settings){var tiles=_schemes_ScatteredScheme__WEBPACK_IMPORTED_MODULE_7__.ScatteredScheme.generate({width:settings.width,height:settings.height,exits:settings.exits});return tiles.setTheme(_themes_TileTheme__WEBPACK_IMPORTED_MODULE_8__.TILE_THEME_CABIN),tiles.rooms.forEach((function(room){var edges=room.borderTiles.filter((function(t){return!(function(t,room){return t.x===room.left&&t.y===room.top}(t,room)||function(t,room){return t.x===room.left&&t.y===room.bottom-1}(t,room)||function(t,room){return t.x===room.right-1&&t.y===room.bottom-1}(t,room)||function(t,room){return t.x===room.right-1&&t.y===room.top}(t,room))})),door=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_5__.pickRandom)(edges);door&&room.addExit(door.x,door.y)})),tiles.getUnassignedTiles().forEach((function(tile){tile.theme=_themes_TileTheme__WEBPACK_IMPORTED_MODULE_8__.TILE_THEME_FOREST})),(0,_GeneratorUtils__WEBPACK_IMPORTED_MODULE_10__.addBorder)(tiles),(0,_LevelConnections__WEBPACK_IMPORTED_MODULE_6__.digExits)(tiles,settings.exits),tiles}},{key:"populate",value:function(settings,tiles){tiles.rooms.forEach((function(room){(0,_themes_TileTheme__WEBPACK_IMPORTED_MODULE_8__.getThemePopulator)(room.theme).populateRoom(room)}));var doors=tiles.rooms.map((function(room){return room.exits})).flat(),walkways=new Set,generatePath=function(start,end){var result,path=(0,_utils_AStar__WEBPACK_IMPORTED_MODULE_3__.computeAStar)({start:{x:start.x,y:start.y},goal:{x:end.x,y:end.y},cost:function(a,b){if(tiles.tileTypeMatches(b.x,b.y,_TileData__WEBPACK_IMPORTED_MODULE_9__.TILE_TYPE_WALL))return 1/0;var walls=tiles.getNeighbors(b.x,b.y).filter((function(n){return n.isType(_TileData__WEBPACK_IMPORTED_MODULE_9__.TILE_TYPE_WALL)}));return walls.length>0?2*walls.length:walkways.has("".concat(b.x,",").concat(b.y))?.1:2*(0,_utils_diagonalDistance__WEBPACK_IMPORTED_MODULE_4__.diagonalDistance)(a,b)}});(result=path).success&&result.path.forEach((function(segment){_core_Game__WEBPACK_IMPORTED_MODULE_0__.game.map.getEntitiesAt(segment.x,segment.y).length>0||((0,_data_Spawner__WEBPACK_IMPORTED_MODULE_2__.spawn)(_data_Spawnables__WEBPACK_IMPORTED_MODULE_1__.SPWN_DIRT_PATH,segment.x,segment.y),walkways.add("".concat(segment.x,",").concat(segment.y)))}))};doors.forEach((function(doorA){settings.exits.forEach((function(exit){generatePath(doorA,exit)})),doors.forEach((function(doorB){doorA!==doorB&&generatePath(doorA,doorB)}))})),tiles.getUnassignedTiles().forEach((function(tile){(0,_themes_TileTheme__WEBPACK_IMPORTED_MODULE_8__.getThemePopulator)(tile.theme).populateTile(tile)}))}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ForestTownGenerator}(_SectorGenerator__WEBPACK_IMPORTED_MODULE_11__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ScatteredScheme:()=>ScatteredScheme});var _utils_rand__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(44),_LevelConnections__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(232),_TileContainer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(240),_TileData__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(233);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ScatteredScheme=function(_TileScheme){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ScatteredScheme,_TileScheme);var Constructor,protoProps,staticProps,_super=_createSuper(ScatteredScheme);function ScatteredScheme(){return _classCallCheck(this,ScatteredScheme),_super.apply(this,arguments)}return Constructor=ScatteredScheme,staticProps=[{key:"generate",value:function(settings){var attempt=settings.attempt||1,maxAttempts=settings.maxAttempts||100,width=settings.width,height=settings.height,padding=settings.padding||3,roomPadding=settings.roomPadding||3,minCount=settings.minCount||5,maxCount=settings.maxCount||8,minWidth=settings.minWidth||6,maxWidth=settings.maxWidth||10,minHeight=settings.minHeight||6,maxHeight=settings.maxHeight||10,exits=settings.exits||[],tiles=new _TileContainer__WEBPACK_IMPORTED_MODULE_2__.default(width,height);if(attempt>maxAttempts)return console.warn("Failed to generate ScatteredScheme in ".concat(maxAttempts," attempts")),tiles;for(var createBox=function(){var width=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_0__.randomInt)(minWidth,maxWidth),height=(0,_utils_rand__WEBPACK_IMPORTED_MODULE_0__.randomInt)(minHeight,maxHeight);return{x:(0,_utils_rand__WEBPACK_IMPORTED_MODULE_0__.randomInt)(padding,settings.width-padding-width),y:(0,_utils_rand__WEBPACK_IMPORTED_MODULE_0__.randomInt)(padding,settings.height-padding-height),width,height,get top(){return this.y-roomPadding},get bottom(){return this.y+this.height+roomPadding},get left(){return this.x-roomPadding},get right(){return this.x+this.width+roomPadding}}},overlaps=function(box){return tiles.rooms.some((function(room){return room.intersects(box.left,box.top,box.right,box.bottom)}))},i=0;i<100;i++){var box=createBox();if(!overlaps(box)){for(var _i=0;_i<box.width;_i++)for(var j=0;j<box.height;j++){var point={x:box.x+_i,y:box.y+j};0===_i||_i===box.width-1||0===j||j===box.height-1?tiles.setTileType(point.x,point.y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_WALL):tiles.setTileType(point.x,point.y,_TileData__WEBPACK_IMPORTED_MODULE_3__.TILE_TYPE_FLOOR)}if(tiles.createRoom(box.x,box.y,box.width,box.height),tiles.rooms.length>=maxCount)break}}return tiles.rooms.length<minCount?this.generate(_objectSpread(_objectSpread({},settings),{},{attempt:attempt+1})):((0,_LevelConnections__WEBPACK_IMPORTED_MODULE_1__.digExits)(tiles,exits),tiles)}}],(protoProps=null)&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ScatteredScheme}(__webpack_require__(244).default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{addBorder:()=>addBorder});var _TileData__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(233),addBorder=function(tiles){for(var i=0;i<tiles.width;i++)tiles.setTileType(i,0,_TileData__WEBPACK_IMPORTED_MODULE_0__.TILE_TYPE_WALL),tiles.setTileType(i,tiles.height-1,_TileData__WEBPACK_IMPORTED_MODULE_0__.TILE_TYPE_WALL);for(var j=1;j<tiles.height-1;j++)tiles.setTileType(0,j,_TileData__WEBPACK_IMPORTED_MODULE_0__.TILE_TYPE_WALL),tiles.setTileType(tiles.width-1,j,_TileData__WEBPACK_IMPORTED_MODULE_0__.TILE_TYPE_WALL)}},module=>{"use strict";module.exports=JSON.parse('{"width":3,"height":3,"sectors":[[{"music":"FOREST","generator":{"type":"FOREST"},"connectionsNorth":[],"connectionsWest":[]},{"music":"FOREST","generator":{"type":"FOREST_CABINS"},"connectionsNorth":[],"connectionsWest":[{"type":"path"}]},{"music":"FOREST","generator":{"type":"FOREST_STRONGHOLD"},"connectionsNorth":[],"connectionsWest":[{"type":"path"}]}],[{"music":"FOREST","generator":{"type":"FOREST_STRONGHOLD"},"connectionsNorth":[],"connectionsWest":[]},{"music":"FOREST_VILLAGE","generator":{"type":"FOREST_TOWN"},"connectionsNorth":[{"type":"path"}],"connectionsWest":[{"type":"path"}]},{"music":"FOREST","generator":{"type":"FOREST_CABINS"},"connectionsNorth":[{"type":"path"}],"connectionsWest":[{"type":"path"}]}],[{"music":"FOREST","generator":{"type":"FOREST"},"connectionsNorth":[{"type":"path"}],"connectionsWest":[]},{"music":"FOREST","generator":{"type":"FOREST_STRONGHOLD"},"connectionsNorth":[{"type":"path"}],"connectionsWest":[{"type":"path"}]},{"music":"FOREST","generator":{"type":"FOREST"},"connectionsNorth":[{"type":"path"}],"connectionsWest":[]}]]}')},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ConsoleManager});var _enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(72),_Manager__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}var _messages=new WeakMap,_events=new WeakMap,_viewCount=new WeakMap,ConsoleManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ConsoleManager,_Manager);var Constructor,protoProps,staticProps,_super=_createSuper(ConsoleManager);function ConsoleManager(){var _this;_classCallCheck(this,ConsoleManager);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_messages.set(_assertThisInitialized(_this),{writable:!0,value:[]}),_events.set(_assertThisInitialized(_this),{writable:!0,value:[]}),_viewCount.set(_assertThisInitialized(_this),{writable:!0,value:4}),_this}return Constructor=ConsoleManager,(protoProps=[{key:"event",value:function(type,data){_classPrivateFieldGet(this,_events).push({type,data})}},{key:"log",value:function(text){_classPrivateFieldGet(this,_messages).push({text})}},{key:"render",value:function(dt){var _this2=this;_classPrivateFieldGet(this,_events).forEach((function(_ref){var type=_ref.type,data=_ref.data;(0,_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_0__.shouldAppear)(type,data)&&_classPrivateFieldGet(_this2,_messages).push({text:(0,_enums_ConsoleEvents__WEBPACK_IMPORTED_MODULE_0__.getMessage)(type,data)})})),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(this,_events,[]);var msgs=_classPrivateFieldGet(this,_messages).slice(Math.max(_classPrivateFieldGet(this,_messages).length-_classPrivateFieldGet(this,_viewCount),0)),height=Math.min(msgs.length,_classPrivateFieldGet(this,_viewCount));msgs.forEach((function(message,i){_this2.game.renderer.drawText(0,_this2.game.camera.height-(height-i),message.text)}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),ConsoleManager}(_Manager__WEBPACK_IMPORTED_MODULE_1__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>DestroySystem});var _ecs_components__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),_System__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(114);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var _query=new WeakMap,DestroySystem=function(_System){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DestroySystem,_System);var Constructor,protoProps,staticProps,_super=_createSuper(DestroySystem);function DestroySystem(game){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DestroySystem),_this=_super.call(this,game),_query.set(_assertThisInitialized(_this),{writable:!0,value:void 0}),function(receiver,privateMap,value){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to set private field on non-instance");if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(_assertThisInitialized(_this),_query,game.ecs.createQuery({all:[_ecs_components__WEBPACK_IMPORTED_MODULE_0__.IsDestroying]})),_this}return Constructor=DestroySystem,(protoProps=[{key:"update",value:function(dt){(function(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value})(this,_query).get().forEach((function(entity){entity.isDestroying.pass>0?entity.destroy():entity.isDestroying.pass++}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),DestroySystem}(_System__WEBPACK_IMPORTED_MODULE_1__.default)},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>MusicManager});var howler__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_Manager__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5),_data_music_json__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(256);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var Track=function(){function Track(path,data){var _this=this;_classCallCheck(this,Track),_defineProperty(this,"isPlaying",!1),_defineProperty(this,"isIntro",!1),_defineProperty(this,"howl",null),this.name=data.name,this.loop=new howler__WEBPACK_IMPORTED_MODULE_0__.Howl({loop:!0,src:["".concat(path).concat(data.loop)]}),data.intro&&(this.intro=new howler__WEBPACK_IMPORTED_MODULE_0__.Howl({loop:!1,src:["".concat(path).concat(data.intro)]}),this.intro.on("end",(function(){_this.isPlaying?(_this.howl=_this.loop,_this.loop.seek(0),_this.loop.volume(1),_this.loop.play()):(_this.intro.stop(),_this.loop.stop())})))}return _createClass(Track,[{key:"play",value:function(){this.isPlaying||(this.intro?(this.howl=this.intro,this.intro.seek(0),this.intro.play(),this.intro.fade(0,1,5e3),this.loop.stop()):(this.howl=this.loop,this.loop.seek(0),this.loop.play(),this.loop.fade(0,1,5e3)),this.isPlaying=!0)}},{key:"stop",value:function(){this.howl&&this.howl.fade(1,0,500),this.isPlaying=!1}}]),Track}(),MusicManager=function(_Manager){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(MusicManager,_Manager);var _super=_createSuper(MusicManager);function MusicManager(game){var _this2;_classCallCheck(this,MusicManager),_defineProperty(_assertThisInitialized(_this2=_super.call(this,game)),"tracks",{}),_defineProperty(_assertThisInitialized(_this2),"currentTrack",null);var path="".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(_data_music_json__WEBPACK_IMPORTED_MODULE_2__.path);return _data_music_json__WEBPACK_IMPORTED_MODULE_2__.tracks.forEach((function(data){var track=new Track(path,data);_this2.tracks[data.key]=track})),_this2}return _createClass(MusicManager,[{key:"play",value:function(key){key!==this.currentTrack&&(this.currentTrack&&this.tracks[this.currentTrack].stop(),this.tracks[key].play(),this.currentTrack=key)}},{key:"stop",value:function(){this.currentTrack&&this.tracks[this.currentTrack].stop()}},{key:"onSectorLoaded",value:function(sector){this.play(sector.music)}}]),MusicManager}(_Manager__WEBPACK_IMPORTED_MODULE_1__.default)},module=>{"use strict";module.exports=JSON.parse('{"path":"/resources/music/","tracks":[{"name":"Bards Tale","key":"BARDS_TALE","loop":"menu.wav"},{"name":"Hello New York","key":"FOREST_VILLAGE","intro":"village_intro.wav","loop":"village_loop.wav"},{"name":"Intrigue Awaits","key":"FOREST","intro":"forest_intro.wav","loop":"forest_loop.wav"}]}')}],__webpack_module_cache__={};function __webpack_require__(moduleId){if(__webpack_module_cache__[moduleId])return __webpack_module_cache__[moduleId].exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(getter,{a:getter}),getter},getProto=Object.getPrototypeOf?obj=>Object.getPrototypeOf(obj):obj=>obj.__proto__,__webpack_require__.t=function(value,mode){if(1&mode&&(value=this(value)),8&mode)return value;if("object"==typeof value&&value){if(4&mode&&value.__esModule)return value;if(16&mode&&"function"==typeof value.then)return value}var ns=Object.create(null);__webpack_require__.r(ns);var def={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var current=2&mode&&value;"object"==typeof current&&!~leafPrototypes.indexOf(current);current=getProto(current))Object.getOwnPropertyNames(current).forEach((key=>def[key]=()=>value[key]));return def.default=()=>value,__webpack_require__.d(ns,def),ns},__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__(0)})();
//# sourceMappingURL=main.6b05dc0b09e3b72a55b4.js.map