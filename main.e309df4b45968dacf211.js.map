{"version":3,"sources":["webpack://knossonia/./src/index.js","webpack://knossonia/./src/core/Game.js","webpack://knossonia/./src/core/rendering/RenderManager.js","webpack://knossonia/./src/core/Manager.js","webpack://knossonia/./src/core/rendering/Display.js","webpack://knossonia/./src/core/rendering/spritesheets.js","webpack://knossonia/./src/core/rendering/SpriteSheet.js","webpack://knossonia/./src/core/rendering/cp437.js","webpack://knossonia/./src/core/rendering/Sprite.js","webpack://knossonia/./node_modules/color-parse/index.mjs","webpack://knossonia/./node_modules/color-name/index.js","webpack://knossonia/./src/core/input/InputController.js","webpack://knossonia/./src/core/input/events/InputKeyboardEvent.js","webpack://knossonia/./src/core/input/events/InputEvent.js","webpack://knossonia/./src/core/input/events/InputMouseEvent.js","webpack://knossonia/./src/systems/HungerSystem.js","webpack://knossonia/./src/ecs/components/Actor.js","webpack://knossonia/../node_modules/camelcase/index.js","webpack://knossonia/../src/Properties/Property.js","webpack://knossonia/../src/Properties/SimpleProperty.js","webpack://knossonia/../src/Properties/EntityProperty.js","webpack://knossonia/../src/Properties/EntityArrayProperty.js","webpack://knossonia/../src/Properties/PropertyFactory.js","webpack://knossonia/../src/Component.js","webpack://knossonia/../src/registries/ComponentRegistry.js","webpack://knossonia/../node_modules/deepmerge/dist/cjs.js","webpack://knossonia/../src/PrefabComponent.js","webpack://knossonia/../src/Prefab.js","webpack://knossonia/../src/registries/PrefabRegistry.js","webpack://knossonia/../node_modules/nanoid/non-secure/index.js","webpack://knossonia/../src/EntityEvent.js","webpack://knossonia/../src/Entity.js","webpack://knossonia/../src/registries/EntityRegistry.js","webpack://knossonia/../src/Query.js","webpack://knossonia/../src/registries/QueryRegistry.js","webpack://knossonia/../src/Engine.js","webpack://knossonia/./src/ecs/components/Brain.js","webpack://knossonia/./src/ai/GoalActionResult.js","webpack://knossonia/./src/ecs/components/Goal.js","webpack://knossonia/./src/ai/GoalEvaluator.js","webpack://knossonia/./src/ai/GoalTypes/BoredGoalType.js","webpack://knossonia/./src/ai/GoalTypes/GoalType.js","webpack://knossonia/./src/ai/GoalTypes/EatFoodGoalType.js","webpack://knossonia/./src/ai/GoalTypes/SatisfyHungerGoalType.js","webpack://knossonia/./src/ai/GoalTypes/MoveGoalType.js","webpack://knossonia/./src/ecs/components/Eater.js","webpack://knossonia/./src/ecs/components/Moniker.js","webpack://knossonia/./src/ecs/components/Logger.js","webpack://knossonia/./src/ecs/components/Position.js","webpack://knossonia/./src/ecs/components/Map.js","webpack://knossonia/./src/ecs/components/MapLayer.js","webpack://knossonia/./src/ecs/components/Glyph.js","webpack://knossonia/./src/ecs/components/Legs.js","webpack://knossonia/./src/ecs/components/MoveCommand.js","webpack://knossonia/./src/enums/Directions.js","webpack://knossonia/./src/ecs/components/IsPlayer.js","webpack://knossonia/./src/ecs/components/Wandering.js","webpack://knossonia/./src/systems/System.js","webpack://knossonia/./src/systems/ActionSystem.js","webpack://knossonia/./src/ecs/index.js","webpack://knossonia/./src/systems/RenderSystem.js","webpack://knossonia/./src/systems/MovementSystem.js","webpack://knossonia/./src/systems/UISystem.js","webpack://knossonia/./src/core/input/MouseManager.js","webpack://knossonia/./src/core/input/CommandManager.js","webpack://knossonia/./src/core/input/InputDomainType.js","webpack://knossonia/./src/core/input/commands.js","webpack://knossonia/./src/core/input/InputCommand.js","webpack://knossonia/./src/core/input/InputCommandType.js","webpack://knossonia/./src/core/input/KeyCodes.js","webpack://knossonia/./src/core/screens/ScreenManager.js","webpack://knossonia/./src/core/screens/ScreenType.js","webpack://knossonia/./src/core/screens/screens/AdventureScreen.js","webpack://knossonia/./src/core/screens/screens/Screen.js","webpack://knossonia/./src/core/screens/screens/MainMenuScreen.js","webpack://knossonia/./src/core/PlayerManager.js","webpack://knossonia/./src/core/GameStateManager.js","webpack://knossonia/./src/core/ClockManager.js","webpack://knossonia/./src/systems/CursorSystem.js","webpack://knossonia/webpack/bootstrap","webpack://knossonia/webpack/runtime/create fake namespace object","webpack://knossonia/webpack/runtime/define property getters","webpack://knossonia/webpack/runtime/hasOwnProperty shorthand","webpack://knossonia/webpack/runtime/make namespace object","webpack://knossonia/webpack/startup"],"names":["game","Game","this","engine","ECS","clock","ClockManager","renderer","Renderer","state","GameStateManager","mouse","MouseManager","player","PlayerManager","screens","ScreenManager","commands","CommandManager","input","InputController","hungerSystem","HungerSystem","actionSystem","ActionSystem","movementSystem","MovementSystem","renderSystem","RenderSystem","UISystem","cursor","CursorSystem","newGame","requestAnimationFrame","loop","bind","t","update","spritesheets","spritesheet","name","Display","scale","width","height","tileWidth","tileHeight","document","body","appendChild","display","canvas","x","y","char","fg","bg","drawSprite","text","length","i","sprite","font","getSprite","charAt","glyph","fg1","fg2","tiles","clear","xPx","yPx","Math","trunc","Manager","data","defaultFg","createElement","getContext","widthPx","heightPx","style","cssText","ctx","textBaseline","pixelX","pixelY","img","colorize","putImageData","clearRect","tileImage","getElementById","fontImage","SpriteSheet","image","cp437","row","forEach","j","Sprite","spriteCountX","spriteCountY","isBlack","r","g","b","sheet","drawImage","sourceX","sourceY","spriteWidth","spriteHeight","primaryCss","secondaryCss","primary","colorParse","values","secondary","pixels","getImageData","alpha","cstr","m","space","parts","names","slice","test","size","base","parseInt","exec","isRGB","replace","trim","split","map","parseFloat","undefined","baseHues","push","match","value","join","toLowerCase","isNaN","Array","isArray","Object","red","R","green","G","blue","B","h","hue","H","s","saturation","S","l","lightness","L","brightness","a","opacity","orange","yellow","purple","module","exports","addEventListener","onKeydown","container","onMouseClick","onMouseMove","onMouseEnter","onMouseLeave","e","evt","InputKeyboardEvent","key","keyCode","shift","shiftKey","ctrl","ctrlKey","alt","altKey","meta","metaKey","preventDefault","onInputEvent","offsetX","offsetY","pxToTile","InputMouseEvent","button","updatePosition","updateMouseEnter","updateMouseLeave","InputEvent","tileX","tileY","ecs","createQuery","all","Eater","dt","tickDelta","get","entity","eater","hunger","System","Actor","reduceEnergy","addEnergy","energy","Component","camelCase","options","TypeError","pascalCase","string","isLastCharLower","isLastCharUpper","isLastLastCharUpper","character","preserveCamelCase","p1","constructor","component","enumerable","set","v","id","getEntity","console","Proxy","Reflect","old","deleteProperty","len","proxy","ref","filter","EntityProperty","EntityArrayProperty","SimpleProperty","properties","Boolean","ob","prop","destroy","createComponent","handlerName","camelcase","initialValue","initialProperties","_defaultPropertyValue","property","PropertyFactory","Map","type","_getType","definition","typeOrClassOrComponent","isMergeableObject","isNonNullObject","stringValue","isReactElement","isSpecial","REACT_ELEMENT_TYPE","Symbol","cloneUnlessOtherwiseSpecified","deepmerge","val","defaultArrayMerge","target","source","element","getKeys","getEnumerableOwnPropertySymbols","propertyIsOnObject","object","mergeObject","destination","propertyIsUnsafe","customMerge","getMergeFunction","sourceIsArray","array","Error","prev","next","overwrite","componentDef","initialProps","props","merge","parent","arrComps","accessor","initialCompProps","registered","prefab","Prefab","inherit","componentData","def","PrefabComponent","PrefabRegistry","nameOrClassOrPrefab","urlAlphabet","writable","components","getAccessor","hasType","hasOwnProperty","nestedComponent","create","typeOrClass","attach","configurable","has","allowMultiple","isComponent","instance","index","v2","EntityEvent","Entity","refs","Set","json","entityData","createOrGetById","d","any","none","hasAny","c","hasAll","hasNone","isMatch","query","Query","nanoid","ComponentRegistry","EntityRegistry","QueryRegistry","entities","prefabs","nameOrClass","queries","serialize","deserializeEntity","deserialize","Brain","peekGoal","isFinished","popGoal","currentGoal","result","takeAction","FAILURE","removeGoal","INVALID","fireEvent","handle","goal","goalsToDestroy","goals","isSelf","isSiblingGoal","originalIntent","pop","SUCCESS","Goal","GoalEvaluator","complete","goalTypeMap","GoalTypes","goalType","getGoalType","warn","BoredGoalType","GoalType","brain","pushGoal","EatFoodGoalType","food","handled","SatisfyHungerGoalType","isHungry","MoveGoalType","random","Moniker","Logger","log","moniker","Position","idx","MapLayer","mapEntity","content","Glyph","Legs","actor","hasEnergy","position","MoveCommand","direction","DIR_Z","directions","shortName","fullName","delta","DIR_NW","DIR_N","DIR_NE","DIR_W","DIR_E","DIR_SW","DIR_S","DIR_SE","IsPlayer","Wandering","floor","Directions","sorted","from","sort","incrementTick","isPlayer","Engine","registerComponent","registerPrefab","renderable","render","moveCommand","turn","subTurn","padEnd","hasMouse","drawText","str","ceil","computeTextWidth","max","INPUT_DOMAIN_DEFAULT","cmd","registerCommand","getCommandForInputEvent","onInputCommand","domain","lastIndexOf","splice","getDomainCommands","find","matches","command","INPUT_DOMAIN_MAIN_MENU","INPUT_DOMAIN_ADVENTURE","INPUT_DOMAIN_LOOK","isKeyboard","InputCommand","INPUT_CMD_CONFIRM","KEY_ENTER","KEY_SPACE","INPUT_CMD_CANCEL","KEY_ESCAPE","INPUT_CMD_SAVE","KEY_S","INPUT_CMD_LOAD","KEY_L","INPUT_CMD_WAIT","INPUT_CMD_MOVE_NW","KEY_Q","INPUT_CMD_MOVE_N","KEY_W","KEY_UP","INPUT_CMD_MOVE_NE","KEY_E","INPUT_CMD_MOVE_W","KEY_A","KEY_LEFT","INPUT_CMD_MOVE_E","KEY_D","KEY_RIGHT","INPUT_CMD_MOVE_SW","KEY_Z","INPUT_CMD_MOVE_S","KEY_X","KEY_DOWN","INPUT_CMD_MOVE_SE","KEY_C","INPUT_CMD_LOOK","inputEvent","KEY_CANCEL","KEY_HELP","KEY_BACK_SPACE","KEY_TAB","KEY_CLEAR","KEY_ENTER_SPECIAL","KEY_SHIFT","KEY_CONTROL","KEY_ALT","KEY_PAUSE","KEY_CAPS_LOCK","KEY_KANA","KEY_EISU","KEY_JUNJA","KEY_FINAL","KEY_HANJA","KEY_CONVERT","KEY_NONCONVERT","KEY_ACCEPT","KEY_MODECHANGE","KEY_PAGE_UP","KEY_PAGE_DOWN","KEY_END","KEY_HOME","KEY_SELECT","KEY_PRINT","KEY_EXECUTE","KEY_PRINTSCREEN","KEY_INSERT","KEY_DELETE","KEY_NUM_0","KEY_NUM_1","KEY_NUM_2","KEY_NUM_3","KEY_NUM_4","KEY_NUM_5","KEY_NUM_6","KEY_NUM_7","KEY_NUM_8","KEY_NUM_9","KEY_COLON","KEY_SEMICOLON","KEY_LESS_THAN","KEY_EQUALS","KEY_GREATER_THAN","KEY_QUESTION_MARK","KEY_AT","KEY_B","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_M","KEY_N","KEY_O","KEY_P","KEY_R","KEY_T","KEY_U","KEY_V","KEY_Y","KEY_META","KEY_CONTEXT_MENU","KEY_SLEEP","KEY_NUMPAD_0","KEY_NUMPAD_1","KEY_NUMPAD_2","KEY_NUMPAD_3","KEY_NUMPAD_4","KEY_NUMPAD_5","KEY_NUMPAD_6","KEY_NUMPAD_7","KEY_NUMPAD_8","KEY_NUMPAD_9","KEY_MULTIPLY","KEY_ADD","KEY_SEPARATOR","KEY_SUBTRACT","KEY_DECIMAL","KEY_DIVIDE","KEY_F1","KEY_F2","KEY_F3","KEY_F4","KEY_F5","KEY_F6","KEY_F7","KEY_F8","KEY_F9","KEY_F10","KEY_F11","KEY_F12","KEY_F13","KEY_F14","KEY_F15","KEY_F16","KEY_F17","KEY_F18","KEY_F19","KEY_F20","KEY_F21","KEY_F22","KEY_F23","KEY_F24","KEY_NUM_LOCK","KEY_SCROLL_LOCK","KEY_WIN_OEM_FJ_JISHO","KEY_WIN_OEM_FJ_MASSHOU","KEY_WIN_OEM_FJ_TOUROKU","KEY_WIN_OEM_FJ_LOYA","KEY_WIN_OEM_FJ_ROYA","KEY_CIRCUMFLEX","KEY_EXCLAMATION","KEY_DOUBLE_QUOTE","KEY_HASH","KEY_DOLLAR","KEY_PERCENT","KEY_AMPERSAND","KEY_UNDERSCORE","KEY_OPEN_PAREN","KEY_CLOSE_PAREN","KEY_ASTERISK","KEY_PLUS","KEY_PIPE","KEY_HYPHEN_MINUS","KEY_OPEN_CURLY_BRACKET","KEY_CLOSE_CURLY_BRACKET","KEY_TILDE","KEY_VOLUME_MUTE","KEY_VOLUME_DOWN","KEY_VOLUME_UP","KEY_SEMICOLON_2","KEY_EQUALS_2","KEY_COMMA","KEY_MINUS","KEY_PERIOD","KEY_SLASH","KEY_BACK_QUOTE","KEY_OPEN_BRACKET","KEY_BACK_SLASH","KEY_CLOSE_BRACKET","KEY_QUOTE","KEY_META_2","KEY_ALTGR","KEY_WIN_ICO_HELP","KEY_WIN_ICO_00","KEY_WIN_ICO_CLEAR","KEY_WIN_OEM_RESET","KEY_WIN_OEM_JUMP","KEY_WIN_OEM_PA1","KEY_WIN_OEM_PA2","KEY_WIN_OEM_PA3","KEY_WIN_OEM_WSCTRL","KEY_WIN_OEM_CUSEL","KEY_WIN_OEM_ATTN","KEY_WIN_OEM_FINISH","KEY_WIN_OEM_COPY","KEY_WIN_OEM_AUTO","KEY_WIN_OEM_ENLW","KEY_WIN_OEM_BACKTAB","KEY_ATTN","KEY_CRSEL","KEY_EXSEL","KEY_EREOF","KEY_PLAY","KEY_ZOOM","KEY_PA1","KEY_WIN_OEM_CLEAR","SCREEN_MAIN_MENU","MainMenuScreen","SCREEN_ADVENTURE","AdventureScreen","screenType","screen","onLeave","onEnter","onUpdate","setScreen","pushDomain","popDomain","dir","isEnabled","move","saveGame","loadGame","toggle","disable","wait","onDirectionInput","Screen","createPrefab","isTurn","remove","add","turns","playerEntityId","onNewGame","onSaveGame","localStorage","setItem","JSON","stringify","parse","getItem","onLoadGame","tick","enable","draw","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","mode","__esModule","ns","o","defineProperty","obj","prototype","call","toStringTag"],"mappings":"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","file":"main.e309df4b45968dacf211.js","sourcesContent":["import { game } from './core/Game';\n\ngame.start();\n","import Renderer from './rendering/RenderManager';\nimport InputController from './input/InputController';\nimport HungerSystem from '../systems/HungerSystem';\nimport ActionSystem from '../systems/ActionSystem';\nimport RenderSystem from '../systems/RenderSystem';\nimport MovementSystem from '../systems/MovementSystem';\nimport UISystem from '../systems/UISystem';\nimport MouseManager from './input/MouseManager';\nimport CommandManager from './input/CommandManager';\nimport ScreenManager from './screens/ScreenManager';\nimport PlayerManager from './PlayerManager';\nimport ECS from '../ecs';\nimport GameStateManager from './GameStateManager';\nimport ClockManager from './ClockManager';\nimport CursorSystem from '../systems/CursorSystem';\n\nexport default class Game {\n    get ecs() {\n        return this.engine.engine;\n    }\n\n    constructor() {\n        this.engine = new ECS();\n        this.clock = new ClockManager(this);\n        this.renderer = new Renderer(this);\n        this.state = new GameStateManager(this);\n        this.mouse = new MouseManager(this);\n        this.player = new PlayerManager(this);\n        this.screens = new ScreenManager(this);\n        this.commands = new CommandManager(this);\n        this.input = new InputController(this);\n\n        this.hungerSystem = new HungerSystem(this);\n        this.actionSystem = new ActionSystem(this);\n        this.movementSystem = new MovementSystem(this);\n        this.renderSystem = new RenderSystem(this);\n        this.UISystem = new UISystem(this);\n        this.cursor = new CursorSystem(this);\n    }\n\n    start() {\n        this.state.newGame();\n        requestAnimationFrame(this.loop.bind(this));\n    }\n\n    loop(t) {\n        const dt = 0;\n\n        this.hungerSystem.update(dt);\n        this.actionSystem.update(dt);\n        this.movementSystem.update(dt);\n        this.renderSystem.update(dt);\n        this.UISystem.update(dt);\n        this.screens.update(dt);\n        this.cursor.update(dt);\n\n        requestAnimationFrame(this.loop.bind(this));\n    }\n}\n\nexport const game = new Game();\n","import Manager from '../Manager';\nimport Display from './Display';\nimport spritesheets from './spritesheets';\n\nexport default class Renderer extends Manager {\n    #tileWidth = 16;\n    #tileHeight = 16;\n    #spritesheets = {};\n    #display = null;\n    #scale = 2;\n\n    width = 24;\n    height = 24;\n\n    get tileWidth() {\n        return this.#tileWidth;\n    }\n\n    get tileHeight() {\n        return this.#tileHeight;\n    }\n\n    get display() {\n        return this.#display;\n    }\n\n    get canvas() {\n        return this.display.canvas;\n    }\n\n    constructor(game) {\n        super(game);\n\n        spritesheets.forEach((spritesheet) => {\n            this.#spritesheets[spritesheet.name] = spritesheet;\n        });\n\n        this.#display = new Display({\n            scale: this.#scale,\n            width: this.width,\n            height: this.height,\n            tileWidth: this.tileWidth,\n            tileHeight: this.tileHeight,\n        });\n\n        document.body.appendChild(this.display.canvas);\n    }\n\n    draw(x, y, char, fg, bg) {\n        this.drawSprite(x, y, char, fg, bg);\n    }\n\n    computeTextWidth(text) {\n        return text.length * .5;\n    }\n\n    drawText(x, y, text, fg, bg) {\n        for (let i = 0; i < text.length; i++) {\n            const sprite = this.#spritesheets.font.getSprite(text.charAt(i));\n\n            this.display.drawSprite(x + (.5 * i), y, sprite, fg, bg);\n        }\n    }\n\n    drawSprite(x, y, glyph, fg1, fg2, bg) {\n        const sprite = this.#spritesheets.tiles.getSprite(glyph);\n\n        this.display.drawSprite(x, y, sprite, fg1, fg2, bg);\n    }\n\n    clear() {\n        this.display.clear();\n    }\n\n    pxToTile(xPx, yPx) {\n        const x = Math.trunc(xPx / this.tileWidth);\n        const y = Math.trunc(yPx / this.tileHeight);\n\n        return {x, y};\n    }\n}\n","export default class Manager {\n    #game;\n\n    get game() {\n        return this.#game;\n    }\n\n    constructor(game) {\n        this.#game = game;\n    }\n\n    onNewGame() {}\n    onSaveGame() {}\n    onLoadGame(data) {}\n}\n","export default class Display {\n    #ctx;\n    #canvas;\n    #width;\n    #height;\n    #tileWidth;\n    #tileHeight;\n    #defaultFg;\n\n    get tileWidth() {\n        return this.#tileWidth;\n    }\n\n    get tileHeight() {\n        return this.#tileHeight;\n    }\n\n    get width() {\n        return this.#width;\n    }\n\n    get height() {\n        return this.#height;\n    }\n\n    get canvas() {\n        return this.#canvas;\n    }\n\n    get ctx() {\n        return this.#ctx;\n    }\n\n    constructor({width, height, tileWidth, tileHeight, defaultFg}) {\n        this.#width = width;\n        this.#height = height;\n        this.#tileWidth = tileWidth;\n        this.#tileHeight = tileHeight;\n        this.#defaultFg = defaultFg || '#fff';\n\n        this.#canvas = document.createElement('canvas');\n        this.#ctx = this.canvas.getContext('2d');\n\n        const widthPx = this.tileWidth * this.width;\n        const heightPx = this.tileHeight * this.height;\n\n        this.canvas.style.cssText = `width: ${widthPx}px; height: ${heightPx}px`;\n        this.canvas.width = widthPx;\n        this.canvas.height = heightPx;\n\n        this.ctx.font = `${this.#tileHeight}px monospace`;\n        this.ctx.textBaseline = 'top';\n    }\n\n    drawSprite(x, y, sprite, fg1 = '#d6d6d6', fg2 = 'red', bg) {\n        const pixelX = x * this.tileWidth;\n        const pixelY = y * this.tileHeight;\n\n        const img = sprite.colorize(fg1, fg2);\n\n        this.ctx.putImageData(img, pixelX, pixelY);\n    }\n\n    clear() {\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    clearTile(x, y) {\n        this.ctx.clearRect(\n            x * this.tileWidth,\n            y * this.tileHeight,\n            this.tileWidth,\n            this.tileHeight\n        );\n    }\n}\n","import SpriteSheet from './SpriteSheet';\n\nconst tileImage = document.getElementById('spritesheet-tiles');\nconst fontImage = document.getElementById('spritesheet-font');\n\nexport default [\n    new SpriteSheet('tiles', tileImage),\n    new SpriteSheet('font', fontImage),\n];\n","import cp437 from './cp437';\nimport Sprite from './Sprite';\n\nexport default class SpriteSheet {\n    #name = null;\n    #image = null;\n    #defaultGlyph = '?';\n    #sprites = {};\n\n    get name() {\n        return this.#name;\n    }\n\n    get image() {\n        return this.#image;\n    }\n\n    get width() {\n        return this.image.width;\n    }\n\n    get height() {\n        return this.image.height;\n    }\n\n    get spriteCountX() {\n        return 16;\n    }\n\n    get spriteCountY() {\n        return 16;\n    }\n\n    get spriteWidth() {\n        return this.image.width / this.spriteCountX;\n    }\n\n    get spriteHeight() {\n        return this.image.height / this.spriteCountY;\n    }\n\n    constructor(name, image) {\n        this.#name = name;\n        this.#image = image;\n\n        cp437.forEach((row, i) => {\n            row.forEach((glyph, j) => {\n                this.#sprites[glyph] = new Sprite(glyph, this, j, i);\n            });\n        });\n    }\n\n    getSprite(glyph) {\n        if (this.#sprites[glyph]) {\n            return this.#sprites[glyph];\n        }\n\n        return this.#sprites[this.#defaultGlyph];\n    }\n}\n","export default [\n    ['NUL', '☺', '☻', '♥', '♦', '♣', '♠', '•', '◘', '○', '◙', '♂', '♀', '♪', '♫', '☼'],\n    ['►', '◄', '↕', '‼', '¶', '§', '▬', '↨', '↑', '↓', '→', '←', '∟', '↔', '▲', '▼'],\n    [' ', '!', '\"', '#', '$', '%', '&', '\\'', '(', ')', '*', '+', ',', '-', '.', '/'],\n    ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '<', '=', '>', '?'],\n    ['@', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O'],\n    ['P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '[', '\\\\', ']', '^', '_'],\n    ['`', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o'],\n    ['p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '{', '|', '}', '~', '⌂'],\n    ['Ç', 'ü', 'é', 'â', 'ä', 'à', 'å', 'ç', 'ê', 'ë', 'è', 'ï', 'î', 'ì', 'Ä', 'Å'],\n    ['É', 'æ', 'Æ', 'ô', 'ö', 'ò', 'û', 'ù', 'ÿ', 'Ö', 'Ü', '¢', '£', '¥', '₧', 'ƒ'],\n    ['á', 'í', 'ó', 'ú', 'ñ', 'Ñ', 'ª', 'º', '¿', '⌐', '¬', '½', '¼', '¡', '«', '»'],\n    ['░', '▒', '▓', '│', '┤', '╡', '╢', '╖', '╕', '╣', '║', '╗', '╝', '╜', '╛', '┐'],\n    ['└', '┴', '┬', '├', '─', '┼', '╞', '╟', '╚', '╔', '╩', '╦', '╠', '═', '╬', '╧'],\n    ['╨', '╤', '╥', '╙', '╘', '╒', '╓', '╫', '╪', '┘', '┌', '█', '▄', '▌', '▐', '▀'],\n    ['α', 'ß', 'Γ', 'π', 'Σ', 'σ', 'µ', 'τ', 'Φ', 'Θ', 'Ω', 'δ', '∞', 'φ', 'ε', '∩'],\n    ['≡', '±', '≥', '≤', '⌠', '⌡', '÷', '≈', '°', '∙', '·', '√', 'ⁿ', '²', '■', 'NBSP'],\n];\n","import colorParse from 'color-parse';\n\nconst isWhite = (r, g, b) => r === 255 && g === 255 && b === 255;\nconst isBlack = (r, g, b) => r === 0 && g === 0 && b === 0;\n\nexport default class Sprite {\n    #ctx = null;\n    #glyph = null;\n    #sheet = null;\n    #x = null;\n    #y = null;\n\n    get glyph() {\n        return this.#glyph;\n    }\n\n    get x() {\n        return this.#x;\n    }\n\n    get y() {\n        return this.#y;\n    }\n\n    get sheet() {\n        return this.#sheet;\n    }\n\n    get image() {\n        return this.sheet.image;\n    }\n\n    get sourceX() {\n        return this.sheet.spriteWidth * this.x;\n    }\n\n    get sourceY() {\n        return this.sheet.spriteHeight * this.y;\n    }\n\n    get width() {\n        return this.sheet.spriteWidth;\n    }\n\n    get height() {\n        return this.sheet.spriteHeight;\n    }\n\n    constructor(glyph, sheet, x, y) {\n        this.#glyph = glyph;\n        this.#sheet = sheet;\n        this.#x = x;\n        this.#y = y;\n\n        const canvas = document.createElement('canvas');\n        canvas.width = this.width;\n        canvas.height = this.height;\n        this.#ctx = canvas.getContext('2d');\n        this.#ctx.drawImage(\n            this.sheet.image,\n            this.sourceX,\n            this.sourceY,\n            this.width,\n            this.height,\n            0,\n            0,\n            this.width,\n            this.height\n        );\n    }\n\n    colorize(primaryCss, secondaryCss) {\n        const primary = colorParse(primaryCss).values;\n        const secondary = colorParse(secondaryCss).values;\n\n        const pixels = this.#ctx.getImageData(0, 0, this.width, this.height);\n\n        for (let i = 0; i < pixels.data.length; i += 4) {\n            const r = pixels.data[i];\n            const g = pixels.data[i + 1];\n            const b = pixels.data[i + 2];\n\n            if (isBlack(r, g, b)) {\n                pixels.data[i] = primary[0];\n                pixels.data[i + 1] = primary[1];\n                pixels.data[i + 2] = primary[2];\n                pixels.data[i + 4] = primary.alpha;\n            } else {\n                pixels.data[i] = secondary[0];\n                pixels.data[i + 1] = secondary[1];\n                pixels.data[i + 2] = secondary[2];\n                pixels.data[i + 4] = secondary.alpha;\n            }\n        }\n\n        return pixels;\n    }\n}\n","/**\r\n * @module color-parse\r\n */\r\nimport names from 'color-name'\r\n\r\nexport default parse\r\n\r\n/**\r\n * Base hues\r\n * http://dev.w3.org/csswg/css-color/#typedef-named-hue\r\n */\r\n//FIXME: use external hue detector\r\nvar baseHues = {\r\n\tred: 0,\r\n\torange: 60,\r\n\tyellow: 120,\r\n\tgreen: 180,\r\n\tblue: 240,\r\n\tpurple: 300\r\n}\r\n\r\n/**\r\n * Parse color from the string passed\r\n *\r\n * @return {Object} A space indicator `space`, an array `values` and `alpha`\r\n */\r\nfunction parse (cstr) {\r\n\tvar m, parts = [], alpha = 1, space\r\n\r\n\tif (typeof cstr === 'string') {\r\n\t\t//keyword\r\n\t\tif (names[cstr]) {\r\n\t\t\tparts = names[cstr].slice()\r\n\t\t\tspace = 'rgb'\r\n\t\t}\r\n\r\n\t\t//reserved words\r\n\t\telse if (cstr === 'transparent') {\r\n\t\t\talpha = 0\r\n\t\t\tspace = 'rgb'\r\n\t\t\tparts = [0,0,0]\r\n\t\t}\r\n\r\n\t\t//hex\r\n\t\telse if (/^#[A-Fa-f0-9]+$/.test(cstr)) {\r\n\t\t\tvar base = cstr.slice(1)\r\n\t\t\tvar size = base.length\r\n\t\t\tvar isShort = size <= 4\r\n\t\t\talpha = 1\r\n\r\n\t\t\tif (isShort) {\r\n\t\t\t\tparts = [\r\n\t\t\t\t\tparseInt(base[0] + base[0], 16),\r\n\t\t\t\t\tparseInt(base[1] + base[1], 16),\r\n\t\t\t\t\tparseInt(base[2] + base[2], 16)\r\n\t\t\t\t]\r\n\t\t\t\tif (size === 4) {\r\n\t\t\t\t\talpha = parseInt(base[3] + base[3], 16) / 255\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tparts = [\r\n\t\t\t\t\tparseInt(base[0] + base[1], 16),\r\n\t\t\t\t\tparseInt(base[2] + base[3], 16),\r\n\t\t\t\t\tparseInt(base[4] + base[5], 16)\r\n\t\t\t\t]\r\n\t\t\t\tif (size === 8) {\r\n\t\t\t\t\talpha = parseInt(base[6] + base[7], 16) / 255\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!parts[0]) parts[0] = 0\r\n\t\t\tif (!parts[1]) parts[1] = 0\r\n\t\t\tif (!parts[2]) parts[2] = 0\r\n\r\n\t\t\tspace = 'rgb'\r\n\t\t}\r\n\r\n\t\t//color space\r\n\t\telse if (m = /^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\\s*\\(([^\\)]*)\\)/.exec(cstr)) {\r\n\t\t\tvar name = m[1]\r\n\t\t\tvar isRGB = name === 'rgb'\r\n\t\t\tvar base = name.replace(/a$/, '')\r\n\t\t\tspace = base\r\n\t\t\tvar size = base === 'cmyk' ? 4 : base === 'gray' ? 1 : 3\r\n\t\t\tparts = m[2].trim()\r\n\t\t\t\t.split(/\\s*[,\\/]\\s*|\\s+/)\r\n\t\t\t\t.map(function (x, i) {\r\n\t\t\t\t\t//<percentage>\r\n\t\t\t\t\tif (/%$/.test(x)) {\r\n\t\t\t\t\t\t//alpha\r\n\t\t\t\t\t\tif (i === size)\treturn parseFloat(x) / 100\r\n\t\t\t\t\t\t//rgb\r\n\t\t\t\t\t\tif (base === 'rgb') return parseFloat(x) * 255 / 100\r\n\t\t\t\t\t\treturn parseFloat(x)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//hue\r\n\t\t\t\t\telse if (base[i] === 'h') {\r\n\t\t\t\t\t\t//<deg>\r\n\t\t\t\t\t\tif (/deg$/.test(x)) {\r\n\t\t\t\t\t\t\treturn parseFloat(x)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//<base-hue>\r\n\t\t\t\t\t\telse if (baseHues[x] !== undefined) {\r\n\t\t\t\t\t\t\treturn baseHues[x]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn parseFloat(x)\r\n\t\t\t\t})\r\n\r\n\t\t\tif (name === base) parts.push(1)\r\n\t\t\talpha = (isRGB) ? 1 : (parts[size] === undefined) ? 1 : parts[size]\r\n\t\t\tparts = parts.slice(0, size)\r\n\t\t}\r\n\r\n\t\t//named channels case\r\n\t\telse if (cstr.length > 10 && /[0-9](?:\\s|\\/)/.test(cstr)) {\r\n\t\t\tparts = cstr.match(/([0-9]+)/g).map(function (value) {\r\n\t\t\t\treturn parseFloat(value)\r\n\t\t\t})\r\n\r\n\t\t\tspace = cstr.match(/([a-z])/ig).join('').toLowerCase()\r\n\t\t}\r\n\t}\r\n\r\n\t//numeric case\r\n\telse if (!isNaN(cstr)) {\r\n\t\tspace = 'rgb'\r\n\t\tparts = [cstr >>> 16, (cstr & 0x00ff00) >>> 8, cstr & 0x0000ff]\r\n\t}\r\n\r\n\t//array-like\r\n\telse if (Array.isArray(cstr) || cstr.length) {\r\n\t\tparts = [cstr[0], cstr[1], cstr[2]]\r\n\t\tspace = 'rgb'\r\n\t\talpha = cstr.length === 4 ? cstr[3] : 1\r\n\t}\r\n\r\n\t//object case - detects css cases of rgb and hsl\r\n\telse if (cstr instanceof Object) {\r\n\t\tif (cstr.r != null || cstr.red != null || cstr.R != null) {\r\n\t\t\tspace = 'rgb'\r\n\t\t\tparts = [\r\n\t\t\t\tcstr.r || cstr.red || cstr.R || 0,\r\n\t\t\t\tcstr.g || cstr.green || cstr.G || 0,\r\n\t\t\t\tcstr.b || cstr.blue || cstr.B || 0\r\n\t\t\t]\r\n\t\t}\r\n\t\telse {\r\n\t\t\tspace = 'hsl'\r\n\t\t\tparts = [\r\n\t\t\t\tcstr.h || cstr.hue || cstr.H || 0,\r\n\t\t\t\tcstr.s || cstr.saturation || cstr.S || 0,\r\n\t\t\t\tcstr.l || cstr.lightness || cstr.L || cstr.b || cstr.brightness\r\n\t\t\t]\r\n\t\t}\r\n\r\n\t\talpha = cstr.a || cstr.alpha || cstr.opacity || 1\r\n\r\n\t\tif (cstr.opacity != null) alpha /= 100\r\n\t}\r\n\r\n\treturn {\r\n\t\tspace: space,\r\n\t\tvalues: parts,\r\n\t\talpha: alpha\r\n\t}\r\n}\r\n","'use strict'\r\n\r\nmodule.exports = {\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n};\r\n","import InputKeyboardEvent from './events/InputKeyboardEvent';\nimport InputMouseEvent from './events/InputMouseEvent';\nimport Manager from '../Manager';\n\nexport default class InputController extends Manager {\n    constructor(game) {\n        super(game);\n        document.addEventListener('keydown', this.onKeydown.bind(this));\n\n        const container = this.game.renderer.canvas;\n\n        container.addEventListener('click', this.onMouseClick.bind(this));\n        container.addEventListener('mousemove', this.onMouseMove.bind(this));\n        container.addEventListener('mouseenter', this.onMouseEnter.bind(this));\n        container.addEventListener('mouseleave', this.onMouseLeave.bind(this));\n    }\n\n    onKeydown(e) {\n        const evt = new InputKeyboardEvent({\n            key: e.keyCode,\n            shift: e.shiftKey,\n            ctrl: e.ctrlKey,\n            alt: e.altKey,\n            meta: e.metaKey,\n        });\n\n        e.preventDefault();\n\n        this.game.commands.onInputEvent(evt);\n    }\n\n    onMouseClick(e) {\n        const xPx = e.offsetX;\n        const yPx = e.offsetY;\n        const {x, y} = this.game.renderer.pxToTile(xPx, yPx);\n\n        const evt = new InputMouseEvent({\n            key: e.button,\n            x,\n            y,\n            shift: e.shiftKey,\n            ctrl: e.ctrlKey,\n            alt: e.altKey,\n            meta: e.metaKey,\n            xPx,\n            yPx,\n        });\n\n        this.game.commands.onInputEvent(evt);\n    }\n\n    onMouseMove(e) {\n        const xPx = e.offsetX;\n        const yPx = e.offsetY;\n        const {x, y} = this.game.renderer.pxToTile(xPx, yPx);\n\n        this.game.mouse.updatePosition(x, y);\n    }\n\n    onMouseEnter(e) {\n        this.game.mouse.updateMouseEnter();\n    }\n\n    onMouseLeave(e) {\n        this.game.mouse.updateMouseLeave();\n    }\n}\n","import InputEvent from './InputEvent';\n\nexport default class InputKeyboardEvent extends InputEvent {}\n","export default class InputEvent {\n    key = false;\n    shift = false;\n    ctrl = false;\n    alt = false;\n    meta = false;\n\n    constructor(data) {\n        this.key = data.key;\n        this.shift = data.shift;\n        this.ctrl = data.ctrl;\n        this.alt = data.alt;\n        this.meta = data.meta;\n    }\n}\n","import InputEvent from './InputEvent';\n\nexport default class InputMouseEvent extends InputEvent {\n    x = false;\n    y = false;\n    tileX = false;\n    tileY = false;\n\n    constructor(data) {\n        super(data);\n        this.x = data.x;\n        this.y = data.y;\n        this.tileX = data.tileX;\n        this.tileY = data.tileY;\n    }\n}\n","import { Eater } from '../ecs/components';\nimport System from './System';\n\nexport default class HungerSystem extends System {\n    #query = null;\n\n    constructor(game) {\n        super(game);\n        this.#query = game.ecs.createQuery({\n            all: [Eater],\n        });\n    }\n\n    update(dt) {\n        if (this.game.actionSystem.tickDelta > 0) {\n            this.#query.get().forEach((entity) => {\n                entity.eater.hunger -= this.game.actionSystem.tickDelta;\n            });\n        }\n    }\n}\n","import { Component } from 'geotic';\n\nexport class Actor extends Component {\n    static properties = {\n        energy: 0,\n    };\n\n    get hasEnergy() {\n        return this.energy >= 0;\n    }\n\n    onEnergyConsumed(evt) {\n        this.reduceEnergy(evt.data);\n    }\n\n    onTick(evt) {\n        this.addEnergy(1);\n    }\n\n    addEnergy(value) {\n        this.energy += value;\n\n        if (this.energy >= 0) {\n            this.energy = 0;\n        }\n    }\n\n    reduceEnergy(value) {\n        this.addEnergy(value * -1);\n    }\n}\n","'use strict';\n\nconst preserveCamelCase = string => {\n\tlet isLastCharLower = false;\n\tlet isLastCharUpper = false;\n\tlet isLastLastCharUpper = false;\n\n\tfor (let i = 0; i < string.length; i++) {\n\t\tconst character = string[i];\n\n\t\tif (isLastCharLower && /[\\p{Lu}]/u.test(character)) {\n\t\t\tstring = string.slice(0, i) + '-' + string.slice(i);\n\t\t\tisLastCharLower = false;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = true;\n\t\t\ti++;\n\t\t} else if (isLastCharUpper && isLastLastCharUpper && /[\\p{Ll}]/u.test(character)) {\n\t\t\tstring = string.slice(0, i - 1) + '-' + string.slice(i - 1);\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = false;\n\t\t\tisLastCharLower = true;\n\t\t} else {\n\t\t\tisLastCharLower = character.toLocaleLowerCase() === character && character.toLocaleUpperCase() !== character;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = character.toLocaleUpperCase() === character && character.toLocaleLowerCase() !== character;\n\t\t}\n\t}\n\n\treturn string;\n};\n\nconst camelCase = (input, options) => {\n\tif (!(typeof input === 'string' || Array.isArray(input))) {\n\t\tthrow new TypeError('Expected the input to be `string | string[]`');\n\t}\n\n\toptions = {\n\t\t...{pascalCase: false},\n\t\t...options\n\t};\n\n\tconst postProcess = x => options.pascalCase ? x.charAt(0).toLocaleUpperCase() + x.slice(1) : x;\n\n\tif (Array.isArray(input)) {\n\t\tinput = input.map(x => x.trim())\n\t\t\t.filter(x => x.length)\n\t\t\t.join('-');\n\t} else {\n\t\tinput = input.trim();\n\t}\n\n\tif (input.length === 0) {\n\t\treturn '';\n\t}\n\n\tif (input.length === 1) {\n\t\treturn options.pascalCase ? input.toLocaleUpperCase() : input.toLocaleLowerCase();\n\t}\n\n\tconst hasUpperCase = input !== input.toLocaleLowerCase();\n\n\tif (hasUpperCase) {\n\t\tinput = preserveCamelCase(input);\n\t}\n\n\tinput = input\n\t\t.replace(/^[_.\\- ]+/, '')\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[_.\\- ]+([\\p{Alpha}\\p{N}_]|$)/gu, (_, p1) => p1.toLocaleUpperCase())\n\t\t.replace(/\\d+([\\p{Alpha}\\p{N}_]|$)/gu, m => m.toLocaleUpperCase());\n\n\treturn postProcess(input);\n};\n\nmodule.exports = camelCase;\n// TODO: Remove this for the next major release\nmodule.exports.default = camelCase;\n","export default class Property {\n    component;\n\n    constructor(component) {\n        this.component = component;\n    }\n\n    get ecs() {\n        return this.component.ecs;\n    }\n\n    get descriptor() {\n        return {\n            enumerable: true,\n            get: () => this.get(),\n            set: (v) => this.set(v),\n        };\n    }\n\n    get() {\n        return undefined;\n    }\n\n    set(value) {}\n\n    serialize() {\n        return undefined;\n    }\n\n    onDestroyed() {}\n\n    cleanupReference(entity) {}\n}\n","import Property from './Property';\n\nexport default class SimpleProperty extends Property {\n    value = null;\n\n    set(value) {\n        this.value = value;\n    }\n\n    get() {\n        return this.value;\n    }\n\n    serialize() {\n        return this.value;\n    }\n}\n","import Property from './Property';\n\nexport default class EntityProperty extends Property {\n    id;\n\n    set(value) {\n        if (this.id && (!value || value.id !== this.id || value !== this.id)) {\n            this.ecs.entities.removeRef(this.id, this);\n        }\n\n        if (value && value.id) {\n            this.ecs.entities.addRef(value.id, this);\n            this.id = value.id;\n            return;\n        }\n\n        if (typeof value === 'string') {\n            this.ecs.entities.addRef(value, this);\n            this.id = value;\n            return;\n        }\n\n        this.id = undefined;\n    }\n\n    get() {\n        return this.id && this.component.ecs.getEntity(this.id);\n    }\n\n    serialize() {\n        return this.id;\n    }\n\n    onDestroyed() {\n        if (this.id) {\n            this.ecs.entities.removeRef(this.id, this);\n        }\n    }\n\n    cleanupReference(entity) {\n        if (this.id === entity.id) {\n            this.id = undefined;\n        } else {\n            console.warn(\n                `Property in unclean state. A reference to an entity \"${entity.id}\" was never cleaned up.`\n            );\n        }\n    }\n}\n","import Property from './Property';\n\nexport default class EntityArrayProperty extends Property {\n    proxy = [];\n\n    constructor(component) {\n        super(component);\n        this.proxy = new Proxy([], {\n            get: (target, prop, receiver) => {\n                return Reflect.get(target, prop, receiver);\n            },\n            set: (target, prop, value, receiver) => {\n                if (isNaN(prop)) {\n                    return Reflect.set(target, prop, value, receiver);\n                }\n\n                const old = Reflect.get(target, prop, receiver);\n\n                if (typeof value === 'string') {\n                    value = this.ecs.entities.get(value);\n                }\n\n                if (old && old != value) {\n                    this.ecs.entities.removeRef(value, this);\n                }\n\n                if (value && value.id) {\n                    this.ecs.entities.addRef(value.id, this);\n\n                    return Reflect.set(target, prop, value, receiver);\n                }\n\n                return Reflect.set(target, prop, value, receiver);\n            },\n            deleteProperty: (target, prop) => {\n                if (isNaN(prop)) {\n                    return Reflect.deleteProperty(target, prop);\n                }\n\n                const value = Reflect.get(target, prop);\n                this.ecs.entities.removeRef(value, this);\n\n                return Reflect.deleteProperty(target, prop);\n            },\n        });\n    }\n\n    set(values = []) {\n        const len = Math.max(values.length, this.proxy.length);\n\n        for (let i = 0; i < len; i++) {\n            if (i in values) {\n                this.proxy[i] = values[i];\n            } else {\n                delete this.proxy[i];\n            }\n        }\n\n        this.proxy.length = values.length;\n    }\n\n    get() {\n        return this.proxy;\n    }\n\n    serialize() {\n        return this.proxy.map((ref) => ref.id);\n    }\n\n    onDestroyed() {\n        this.set([]);\n    }\n\n    cleanupReference(entity) {\n        this.set(this.proxy.filter((ref) => ref.id !== entity.id));\n    }\n}\n","import Property from './Property';\nimport SimpleProperty from './SimpleProperty';\nimport EntityProperty from './EntityProperty';\nimport EntityArrayProperty from './EntityArrayProperty';\n\nexport default class PropertyStrategy {\n    static create(component, value) {\n        switch (value) {\n            case '<Entity>':\n                return new EntityProperty(component);\n            case '<EntityArray>':\n                return new EntityArrayProperty(component);\n            default:\n                return new SimpleProperty(component);\n        }\n    }\n}\n","import camelcase from 'camelcase';\r\nimport PropertyFactory from './Properties/PropertyFactory';\r\n\r\nexport default class Component {\r\n    #entity = null;\r\n    #ecs = null;\r\n    #props = {};\r\n    #isDestroyed = false;\r\n\r\n    static allowMultiple = false;\r\n    static keyProperty = null;\r\n    static properties = {};\r\n\r\n    static get type() {\r\n        return this.name;\r\n    }\r\n\r\n    get entity() {\r\n        return this.#entity;\r\n    }\r\n\r\n    get ecs() {\r\n        return this.#ecs;\r\n    }\r\n\r\n    get type() {\r\n        return this.constructor.name;\r\n    }\r\n\r\n    get isAttached() {\r\n        return Boolean(this.entity);\r\n    }\r\n\r\n    get isDestroyed() {\r\n        return this.#isDestroyed;\r\n    }\r\n\r\n    get allowMultiple() {\r\n        return this.constructor.allowMultiple;\r\n    }\r\n\r\n    get keyProperty() {\r\n        return this.constructor.keyProperty;\r\n    }\r\n\r\n    get properties() {\r\n        const ob = {};\r\n\r\n        for (const [key, value] of Object.entries(this.#props)) {\r\n            ob[key] = value.get();\r\n        }\r\n\r\n        return ob;\r\n    }\r\n\r\n    get key() {\r\n        return this[this.keyProperty];\r\n    }\r\n\r\n    constructor(ecs, properties = {}) {\r\n        this.#ecs = ecs;\r\n        this._defineProxies(properties);\r\n    }\r\n\r\n    serialize() {\r\n        return Object.entries(this.#props).reduce(\r\n            (o, [key, value]) => ({\r\n                ...o,\r\n                [key]: value.serialize(),\r\n            }),\r\n            {}\r\n        );\r\n    }\r\n\r\n    _onAttached(entity) {\r\n        this.#entity = entity;\r\n        this.ecs.queries.onComponentAdded(entity, this);\r\n        this.onAttached();\r\n    }\r\n\r\n    _onDetached() {\r\n        if (this.isAttached) {\r\n            this.onDetached();\r\n            const entity = this.#entity;\r\n\r\n            this.#entity = null;\r\n            this.ecs.queries.onComponentRemoved(entity, this);\r\n        }\r\n    }\r\n\r\n    _onDestroyed() {\r\n        this.#isDestroyed = true;\r\n        this.onDestroyed();\r\n\r\n        for (const prop of Object.values(this.#props)) {\r\n            prop.onDestroyed();\r\n        }\r\n    }\r\n\r\n    onAttached() {}\r\n\r\n    onDetached() {}\r\n\r\n    onDestroyed() {}\r\n\r\n    remove(destroy = true) {\r\n        if (this.isAttached) {\r\n            this.entity.remove(this);\r\n        }\r\n        if (destroy) {\r\n            this._onDestroyed();\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.remove(true);\r\n    }\r\n\r\n    clone() {\r\n        return this.ecs.createComponent(\r\n            this.type,\r\n            this.serialize()\r\n        );\r\n    }\r\n\r\n    _onEvent(evt) {\r\n        this.onEvent(evt);\r\n\r\n        const handlerName = camelcase(`on ${evt.name}`);\r\n\r\n        if (typeof this[handlerName] === 'function') {\r\n            this[handlerName](evt);\r\n        }\r\n    }\r\n\r\n    onEvent(evt) {}\r\n\r\n    _defaultPropertyValue(propertyName) {\r\n        const value = this.constructor.properties[propertyName];\r\n\r\n        if (value === '<EntityArray>') {\r\n            return [];\r\n        }\r\n\r\n        if (value === '<Entity>') {\r\n            return undefined;\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    _defineProxies(initialProperties) {\r\n        for (const key in this.constructor.properties) {\r\n            const initialValue = initialProperties.hasOwnProperty(key)\r\n                ? initialProperties[key]\r\n                : this._defaultPropertyValue(key);\r\n            const property = PropertyFactory.create(\r\n                this,\r\n                this.constructor.properties[key]\r\n            );\r\n\r\n            this.#props[key] = property;\r\n            Object.defineProperty(this, key, property.descriptor);\r\n            property.set(initialValue);\r\n        }\r\n    }\r\n}\r\n","import Component from '../Component';\nimport camelcase from 'camelcase';\n\nexport default class ComponentRegistry {\n    #nameCache = new Map();\n    #definitions = new Map();\n    #ecs = null;\n\n    constructor(ecs) {\n        this.#ecs = ecs;\n    }\n\n    register(component) {\n        this.#definitions.set(component.name, component);\n        this.#nameCache.set(component.name, camelcase(component.name));\n    }\n\n    getAccessor(type) {\n        if (this.#nameCache.has(type)) {\n            return this.#nameCache.get(type);\n        }\n\n        this.#nameCache.set(type, camelcase(type));\n    }\n\n    get(typeOrClassOrComponent) {\n        const type = this._getType(typeOrClassOrComponent);\n\n        if (!type) {\n            console.warn(\n                `Cannot get component definition for type or class ${typeOrClassOrComponent} since it is neither a Component class or type (string)`\n            );\n            return null;\n        }\n\n        return this.#definitions.get(type);\n    }\n\n    create(typeOrClass, properties = {}) {\n        const definition = this.get(typeOrClass);\n\n        if (definition) {\n            return new definition(this.#ecs, properties);\n        }\n\n        console.warn(\n            `Could not create component definition for ${typeOrClass} since it is not registered`\n        );\n    }\n\n    _getType(typeOrClassOrComponent) {\n        if (typeof typeOrClassOrComponent === 'string') {\n            return typeOrClassOrComponent;\n        }\n\n        if (typeOrClassOrComponent instanceof Component) {\n            return typeOrClassOrComponent.type;\n        }\n\n        if (typeOrClassOrComponent.prototype instanceof Component) {\n            return typeOrClassOrComponent.name;\n        }\n\n        return null;\n    }\n}\n","'use strict';\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\nfunction propertyIsOnObject(object, property) {\n\ttry {\n\t\treturn property in object\n\t} catch(_) {\n\t\treturn false\n\t}\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\treturn propertyIsOnObject(target, key) // Properties are safe to merge if they don't exist in the target yet,\n\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (propertyIsOnObject(target, key) && options.isMergeableObject(source[key])) {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n","import merge from 'deepmerge';\n\nexport default class PrefabComponent {\n    get type() {\n        return this.componentDef.type;\n    }\n\n    constructor(componentDef, properties = {}, overwrite = true) {\n        this.componentDef = componentDef;\n        this.properties = properties;\n        this.overwrite = overwrite;\n    }\n\n    applyToEntity(entity, initialProps = {}) {\n        if (!this.componentDef.allowMultiple && entity.has(this.componentDef)) {\n            if (this.overwrite) {\n                entity.remove(this.componentDef);\n            } else {\n                console.log(\n                    `Ignoring prefab component \"${this.type}\" since the entity \"${entity.id}\" already has one.`\n                );\n                return;\n            }\n        }\n\n        const props = merge(this.properties, initialProps);\n\n        entity.add(this.componentDef, props);\n    }\n}\n","export default class Prefab {\r\n    name = '';\r\n    inherit = [];\r\n    components = [];\r\n\r\n    constructor(ecs, name) {\r\n        this.ecs = ecs;\r\n        this.name = name;\r\n    }\r\n\r\n    addComponent(prefabComponent) {\r\n        this.components.push(prefabComponent);\r\n    }\r\n\r\n    applyToEntity(entity, initialProps = {}) {\r\n        this.inherit.forEach((parent) => {\r\n            parent.applyToEntity(entity, initialProps);\r\n        });\r\n\r\n        const arrComps = {};\r\n\r\n        this.components.forEach((component, i) => {\r\n            const definition = component.componentDef;\r\n            const accessor = this.ecs.components.getAccessor(definition.type);\r\n\r\n            let initialCompProps = {};\r\n\r\n            if (definition.allowMultiple) {\r\n                if (definition.keyProperty) {\r\n                    const key = component.properties[definition.keyProperty];\r\n\r\n                    if (\r\n                        initialProps[accessor] &&\r\n                        initialProps[accessor][key]\r\n                    ) {\r\n                        initialCompProps =\r\n                            initialProps[accessor][key];\r\n                    }\r\n                } else {\r\n                    if (!arrComps[accessor]) {\r\n                        arrComps[accessor] = 0;\r\n                    }\r\n\r\n                    if (\r\n                        initialProps[accessor] &&\r\n                        initialProps[accessor][\r\n                            arrComps[accessor]\r\n                        ]\r\n                    ) {\r\n                        initialCompProps =\r\n                            initialProps[accessor][\r\n                                arrComps[accessor]\r\n                            ];\r\n                    }\r\n\r\n                    arrComps[accessor]++;\r\n                }\r\n            } else {\r\n                initialCompProps = initialProps[accessor];\r\n            }\r\n\r\n            component.applyToEntity(entity, initialCompProps);\r\n        });\r\n\r\n        return entity;\r\n    }\r\n}\r\n","import Component from '../Component';\nimport PrefabComponent from '../PrefabComponent';\nimport Prefab from '../Prefab';\n\nexport default class PrefabRegistry {\n    #prefabs = {};\n    #ecs = null;\n\n    constructor(ecs) {\n        this.#ecs = ecs;\n    }\n\n    deserialize(data) {\n        const registered = this.get(data.name);\n\n        if (registered) {\n            return registered;\n        }\n\n        const prefab = new Prefab(this.#ecs, data.name);\n\n        let inherit;\n\n        if (Array.isArray(data.inherit)) {\n            inherit = data.inherit;\n        } else if (typeof data.inherit === 'string') {\n            inherit = [data.inherit];\n        } else {\n            inherit = [];\n        }\n\n        prefab.inherit = inherit.map((parent) => {\n            const ref = this.get(parent);\n\n            if (!ref) {\n                console.warn(\n                    `Prefab \"${data.name}\" cannot inherit from Prefab \"${parent}\" because is not registered yet! Prefabs must be registered in the right order.`\n                );\n                return parent;\n            }\n\n            return ref;\n        });\n\n        const comps = data.components || [];\n\n        for (const componentData of comps) {\n            if (\n                typeof componentData === 'string' ||\n                componentData.prototype instanceof Component\n            ) {\n                const def = this.#ecs.components.get(componentData);\n                if (def) {\n                    prefab.addComponent(new PrefabComponent(def));\n                }\n            } else if (typeof componentData === 'object') {\n                const type = componentData.type;\n                const def = this.#ecs.components.get(type);\n                if (def) {\n                    prefab.addComponent(\n                        new PrefabComponent(\n                            def,\n                            componentData.properties,\n                            componentData.overwrite\n                        )\n                    );\n                }\n            } else {\n                console.warn(\n                    `Unrecognized component reference \"${componentData}\" in prefab \"${data.name}\". Ensure the component is registered before the prefab.`\n                );\n            }\n        }\n\n        this.register(prefab);\n\n        return prefab;\n    }\n\n    register(prefab) {\n        this.#prefabs[prefab.name] = prefab;\n    }\n\n    get(nameOrClassOrPrefab) {\n        const name = PrefabRegistry._getName(nameOrClassOrPrefab);\n\n        return this.#prefabs[name];\n    }\n\n    create(nameOrClass, initialProps = {}) {\n        const prefab = this.get(nameOrClass);\n\n        if (!prefab) {\n            console.warn(\n                `Could not instantiate prefab for ${nameOrClass} since it is not registered`\n            );\n\n            return;\n        }\n\n        const entity = this.#ecs.createEntity();\n        prefab.applyToEntity(entity, initialProps);\n\n        return entity;\n    }\n\n    static _getName(nameOrClassOrPrefab) {\n        if (typeof nameOrClassOrPrefab === 'string') {\n            return nameOrClassOrPrefab;\n        }\n\n        if (nameOrClassOrPrefab instanceof Prefab) {\n            return nameOrClassOrPrefab.name;\n        }\n\n        if (nameOrClassOrPrefab.prototype instanceof Prefab) {\n            return nameOrClassOrPrefab.name;\n        }\n\n        return null;\n    }\n}\n","// This alphabet uses `A-Za-z0-9_-` symbols. The genetic algorithm helped\n// optimize the gzip compression for this alphabet.\nlet urlAlphabet =\n  'ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW'\n\nlet customAlphabet = (alphabet, size) => {\n  return () => {\n    let id = ''\n    // A compact alternative for `for (var i = 0; i < step; i++)`.\n    let i = size\n    while (i--) {\n      // `| 0` is more compact and faster than `Math.floor()`.\n      id += alphabet[Math.random() * alphabet.length | 0]\n    }\n    return id\n  }\n}\n\nlet nanoid = (size = 21) => {\n  let id = ''\n  // A compact alternative for `for (var i = 0; i < step; i++)`.\n  let i = size\n  while (i--) {\n    // `| 0` is more compact and faster than `Math.floor()`.\n    id += urlAlphabet[Math.random() * 64 | 0]\n  }\n  return id\n}\n\nexport { nanoid, customAlphabet }\n","export default class EntityEvent {\n    data = {};\n    #prevented = false;\n    #handled = false;\n\n    get prevented() {\n        return this.#prevented;\n    }\n\n    get handled() {\n        return this.#handled;\n    }\n\n    constructor(name, data = {}) {\n        this.name = name;\n        this.data = data;\n    }\n\n    is(name) {\n        return this.name === name;\n    }\n\n    handle() {\n        this.#handled = true;\n        this.#prevented = true;\n    }\n\n    prevent() {\n        this.#prevented = true;\n    }\n}\n","import Component from './Component';\r\nimport EntityEvent from './EntityEvent';\r\n\r\nexport default class Entity {\r\n    #id = null;\r\n    #components = {};\r\n    #ecs = null;\r\n    #isDestroyed = false;\r\n\r\n    get ecs() {\r\n        return this.#ecs;\r\n    }\r\n\r\n    get components() {\r\n        return this.#components;\r\n    }\r\n\r\n    get isDestroyed() {\r\n        return this.#isDestroyed;\r\n    }\r\n\r\n    constructor(ecs, id = null) {\r\n        this.#ecs = ecs;\r\n        this.#id = id || ecs.generateId();\r\n        Object.defineProperty(this, 'id', {\r\n            value: this.#id,\r\n            enumerable: true,\r\n            writable: false,\r\n        });\r\n    }\r\n\r\n    has(typeOrClass, key = null) {\r\n        const type = this.ecs.components._getType(typeOrClass);\r\n        const accessor = this.ecs.components.getAccessor(type);\r\n        const hasType = this.hasOwnProperty(accessor);\r\n\r\n        if (hasType && key) {\r\n            return this[accessor].hasOwnProperty(key);\r\n        }\r\n\r\n        return hasType;\r\n    }\r\n\r\n    get(typeOrClass, key = null) {\r\n        const type = this.ecs.components._getType(typeOrClass);\r\n        const accessor = this.ecs.components.getAccessor(type);\r\n        const components = this[accessor];\r\n\r\n        if (components && key) {\r\n            return components[key];\r\n        }\r\n\r\n        return components;\r\n    }\r\n\r\n    destroy() {\r\n        this.#isDestroyed = true;\r\n\r\n        for (const component of Object.values(this.components)) {\r\n            if (component instanceof Component) {\r\n                component.destroy();\r\n            } else {\r\n                for (const nestedComponent of Object.values(component)) {\r\n                    nestedComponent.destroy();\r\n                }\r\n            }\r\n        }\r\n\r\n        this.ecs.entities.onEntityDestroyed(this);\r\n    }\r\n\r\n    add(typeOrClass, properties = {}) {\r\n        const component = this.ecs.components.create(typeOrClass, properties);\r\n\r\n        if (!component) {\r\n            console.warn(\r\n                `\"${typeOrClass}\" component cannot be added, since it is not registered.`\r\n            );\r\n            return false;\r\n        }\r\n\r\n        return this.attach(component);\r\n    }\r\n\r\n    attach(component) {\r\n        const accessor = this.ecs.components.getAccessor(component.type);\r\n\r\n        if (!component.allowMultiple) {\r\n            if (this.has(component.type)) {\r\n                console.warn(\r\n                    `\"${component.type}\" component has allowMultiple set to ${component.allowMultiple}. Trying to add a \"${component.type}\" component to an entity which already has one.`\r\n                );\r\n                return false;\r\n            }\r\n\r\n            this.components[accessor] = component;\r\n\r\n            Object.defineProperty(this, accessor, {\r\n                enumerable: true,\r\n                configurable: true,\r\n                get() {\r\n                    return this.components[accessor];\r\n                },\r\n            });\r\n\r\n            component._onAttached(this);\r\n            this.ecs.queries.onComponentAdded(this);\r\n\r\n            return true;\r\n        }\r\n\r\n        if (!component.keyProperty) {\r\n            if (!this.components[accessor]) {\r\n                this.components[accessor] = [];\r\n                Object.defineProperty(this, accessor, {\r\n                    configurable: true,\r\n                    enumerable: true,\r\n                    get() {\r\n                        return this.components[accessor];\r\n                    },\r\n                });\r\n            }\r\n\r\n            this.components[accessor].push(component);\r\n\r\n            component._onAttached(this);\r\n            this.ecs.queries.onComponentAdded(this);\r\n\r\n            return true;\r\n        }\r\n\r\n        if (!component.key) {\r\n            console.warn(\r\n                `\"${component.type}\" component has a falsy key of \"${component.key}\". The keyProperty is set to \"${component.keyProperty}\".`\r\n            );\r\n            return false;\r\n        }\r\n\r\n        if (!this.components[accessor]) {\r\n            this.components[accessor] = {};\r\n            Object.defineProperty(this, accessor, {\r\n                configurable: true,\r\n                enumerable: true,\r\n                get() {\r\n                    return this.components[accessor];\r\n                },\r\n            });\r\n        }\r\n\r\n        this.components[accessor][component.key] = component;\r\n\r\n        component._onAttached(this);\r\n        this.ecs.queries.onComponentAdded(this, component);\r\n\r\n        return true;\r\n    }\r\n\r\n    owns(component) {\r\n        return component.entity === this;\r\n    }\r\n\r\n    remove(typeOrClassOrComponent, key = null) {\r\n        const isComponent = typeOrClassOrComponent instanceof Component;\r\n        key = isComponent ? typeOrClassOrComponent.key : key;\r\n\r\n        const definition = this.ecs.components.get(typeOrClassOrComponent);\r\n\r\n        const accessor = this.ecs.components.getAccessor(definition.type);\r\n\r\n        if (definition.allowMultiple) {\r\n            if (!definition.keyProperty) {\r\n                if (isComponent) {\r\n                    const all = this.components[accessor];\r\n\r\n                    if (!all) {\r\n                        console.warn(\r\n                            `Trying to remove a \"${definition.type}\" component from an entity, but it wasn't found.`\r\n                        );\r\n                        return;\r\n                    }\r\n\r\n                    const index = all.indexOf(typeOrClassOrComponent);\r\n\r\n                    if (index > -1) {\r\n                        all.splice(index, 1);\r\n                        typeOrClassOrComponent._onDetached();\r\n\r\n                        if (all.length === 0) {\r\n                            delete this[accessor];\r\n                            delete this.components[accessor];\r\n                        }\r\n\r\n                        this.ecs.queries.onComponentRemoved(this);\r\n\r\n                        return true;\r\n                    }\r\n                } else {\r\n                    for (const instance of this.components[accessor]) {\r\n                        instance._onDetached();\r\n                    }\r\n\r\n                    delete this[accessor];\r\n                    delete this.components[accessor];\r\n                    this.ecs.queries.onComponentRemoved(this);\r\n\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            if (!key) {\r\n                console.warn(\r\n                    `Trying to remove a \"${definition.type}\" component which allows multiple without specifying an key.`\r\n                );\r\n                return;\r\n            }\r\n\r\n            const all = this.components[accessor];\r\n            const component = all[key];\r\n\r\n            if (component) {\r\n                delete all[key];\r\n                component._onDetached();\r\n                if (Object.keys(all).length <= 0) {\r\n                    delete this[accessor];\r\n                    delete this.components[accessor];\r\n                }\r\n                this.ecs.queries.onComponentRemoved(this);\r\n\r\n                return component;\r\n            } else {\r\n                console.warn(\r\n                    `Trying to remove a \"${definition.type}\" component from an entity at \"${key}\", but it wasn't found.`\r\n                );\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (accessor in this) {\r\n            const component = this.components[accessor];\r\n\r\n            delete this[accessor];\r\n            delete this.components[accessor];\r\n            component._onDetached();\r\n            this.ecs.queries.onComponentRemoved(this);\r\n\r\n            return component;\r\n        }\r\n\r\n        console.warn(\r\n            `Trying to remove a \"${definition.type}\" component from an entity, but it wasn't found.`\r\n        );\r\n    }\r\n\r\n    serialize() {\r\n        return Object.entries(this.components).reduce(\r\n            (o, [key, value]) => {\r\n                if (value instanceof Component) {\r\n                    return {\r\n                        ...o,\r\n                        [key]: value.serialize(),\r\n                    };\r\n                }\r\n\r\n                if (Array.isArray(value)) {\r\n                    return {\r\n                        ...o,\r\n                        [key]: value.map((v) => v.serialize()),\r\n                    };\r\n                }\r\n\r\n                return {\r\n                    ...o,\r\n                    [key]: Object.entries(value).reduce(\r\n                        (o2, [k2, v2]) => ({\r\n                            ...o2,\r\n                            [k2]: v2.serialize(),\r\n                        }),\r\n                        {}\r\n                    ),\r\n                };\r\n            },\r\n            {\r\n                id: this.id,\r\n            }\r\n        );\r\n    }\r\n\r\n    fireEvent(name, data) {\r\n        const evt = new EntityEvent(name, data);\r\n\r\n        for (const component of Object.values(this.components)) {\r\n            if (component instanceof Component) {\r\n                component._onEvent(evt);\r\n\r\n                if (evt.prevented) {\r\n                    return evt;\r\n                }\r\n            } else {\r\n                for (const nestedComponent of Object.values(component)) {\r\n                    nestedComponent._onEvent(evt);\r\n\r\n                    if (evt.prevented) {\r\n                        return evt;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return evt;\r\n    }\r\n}\r\n","import Entity from '../Entity';\nimport camelcase from 'camelcase';\n\nexport default class EntityRegistry {\n    #entities = new Map();\n    #ecs = null;\n    #refs = new Map();\n\n    constructor(ecs) {\n        this.#ecs = ecs;\n    }\n\n    get all() {\n        return this.#entities.values();\n    }\n\n    register(entity) {\n        this.#entities.set(entity.id, entity);\n\n        return entity;\n    }\n\n    get(id) {\n        return this.#entities.get(id);\n    }\n\n    createOrGetById(id) {\n        const entity = this.get(id);\n\n        if (entity) {\n            return entity;\n        }\n\n        return this.create(id);\n    }\n\n    create(id = undefined) {\n        const entity = new Entity(this.#ecs, id);\n\n        this.register(entity);\n\n        this.#ecs.queries.onEntityCreated(entity);\n\n        return entity;\n    }\n\n    destroy(entity) {\n        entity.destroy();\n    }\n\n    onEntityDestroyed(entity) {\n        this.cleanupRefs(entity);\n        this.#entities.delete(entity.id);\n        this.#ecs.queries.onEntityDestroyed(entity);\n    }\n\n    cleanupRefs(entity) {\n        const refs = this.#refs.get(entity.id);\n\n        if (!refs) {\n            return;\n        }\n\n        for (const ref of refs) {\n            ref.cleanupReference(entity);\n        }\n\n        delete this.#refs[entity.id];\n    }\n\n    addRef(entityId, property) {\n        if (!this.#refs.has(entityId)) {\n            this.#refs.set(entityId, new Set([property]));\n            return;\n        }\n\n        this.#refs.get(entityId).add(property);\n    }\n\n    removeRef(entityId, property) {\n        if (this.#refs.has(entityId)) {\n            this.#refs.get(entityId).delete(property);\n        }\n    }\n\n    serialize() {\n        const json = [];\n\n        this.#entities.forEach((entity) => {\n            json.push(entity.serialize());\n        });\n\n        return json;\n    }\n\n    deserialize(data) {\n        for (const entityData of data.entities) {\n            this.createOrGetById(entityData.id);\n        }\n\n        for (const entityData of data.entities) {\n            this.deserializeEntity(entityData);\n        }\n    }\n\n    deserializeEntity(data) {\n        const { id, ...componentData } = data;\n        const entity = this.createOrGetById(id);\n\n        Object.entries(componentData).forEach(([key, value]) => {\n            const type = camelcase(key, { pascalCase: true });\n            const definition = this.#ecs.components.get(type);\n\n            if (definition.allowMultiple) {\n                Object.values(value).forEach((d) => {\n                    entity.add(definition, d);\n                });\n            } else {\n                entity.add(definition, value);\n            }\n        });\n    }\n}\n","import merge from 'deepmerge';\n\nexport default class Query {\n    #ecs;\n    #filter;\n    #cache = new Set();\n\n    constructor(ecs, filter = {}) {\n        this.#ecs = ecs;\n        this.#filter = merge({ any: [], all: [], none: [] }, filter);\n        this.bustCache();\n    }\n\n    isMatch(entity) {\n        const hasAny = this.#filter.any.length\n            ? this.#filter.any.some((c) => entity.has(c))\n            : true;\n        const hasAll = this.#filter.all.every((c) => entity.has(c));\n        const hasNone = !this.#filter.none.some((c) => entity.has(c));\n\n        return hasAny && hasAll && hasNone;\n    }\n\n    candidate(entity) {\n        if (this.isMatch(entity)) {\n            this.#cache.add(entity);\n            return true;\n        }\n\n        this.#cache.delete(entity);\n        return false;\n    }\n\n    _onEntityCreated(entity) {\n        this.candidate(entity);\n    }\n\n    _onComponentAdded(entity) {\n        this.candidate(entity);\n    }\n\n    _onComponentRemoved(entity) {\n        this.candidate(entity);\n    }\n\n    _onEntityDestroyed(entity) {\n        this.#cache.delete(entity);\n    }\n\n    bustCache() {\n        this.#cache.clear();\n\n        for (const entity of this.#ecs.entities.all) {\n            this.candidate(entity);\n        }\n\n        return this.#cache;\n    }\n\n    get() {\n        return this.#cache;\n    }\n}\n","import Query from '../Query';\n\nexport default class QueryRegistry {\n    #ecs;\n    #queries = [];\n\n    constructor(ecs) {\n        this.#ecs = ecs;\n    }\n\n    create(filters) {\n        const query = new Query(this.#ecs, filters);\n\n        this.#queries.push(query);\n\n        return query;\n    }\n\n    onComponentAdded(entity) {\n        this.#queries.forEach((query) => query._onComponentAdded(entity));\n    }\n\n    onComponentRemoved(entity) {\n        this.#queries.forEach((query) => query._onComponentRemoved(entity));\n    }\n\n    onEntityCreated(entity) {\n        this.#queries.forEach((query) => query._onEntityCreated(entity));\n    }\n\n    onEntityDestroyed(entity) {\n        this.#queries.forEach((query) => query._onEntityDestroyed(entity));\n    }\n}\n","import ComponentRegistry from './registries/ComponentRegistry';\nimport PrefabRegistry from './registries/PrefabRegistry';\nimport { nanoid } from 'nanoid/non-secure';\nimport EntityRegistry from './registries/EntityRegistry';\nimport QueryRegistry from './registries/QueryRegistry';\n\nexport default class Engine {\n    constructor() {\n        this.idGenerator = () => nanoid();\n        this.components = new ComponentRegistry(this);\n        this.prefabs = new PrefabRegistry(this);\n        this.entities = new EntityRegistry(this);\n        this.queries = new QueryRegistry(this);\n    }\n\n    generateId() {\n        return this.idGenerator();\n    }\n\n    createEntity() {\n        return this.entities.create();\n    }\n\n    createPrefab(nameOrClass, initialProps = {}) {\n        return this.prefabs.create(nameOrClass, initialProps);\n    }\n\n    destroyEntity(entity) {\n        return this.entities.destroy(entity);\n    }\n\n    registerPrefab(data) {\n        this.prefabs.deserialize(data);\n    }\n\n    registerComponent(component) {\n        this.components.register(component);\n    }\n\n    getEntity(id) {\n        return this.entities.get(id);\n    }\n\n    createComponent(type, properties) {\n        return this.components.create(type, properties);\n    }\n\n    createQuery(filters) {\n        return this.queries.create(filters);\n    }\n\n    serialize() {\n        return {\n            entities: this.entities.serialize(),\n        };\n    }\n\n    deserialize(data) {\n        if (data.id) {\n            return this.entities.deserializeEntity(data);\n        }\n\n        return this.entities.deserialize(data);\n    }\n}\n","import { Component } from 'geotic';\nimport { SUCCESS, INVALID, FAILURE } from '../../ai/GoalActionResult';\n\nexport class Brain extends Component {\n    static properties = {\n        goals: '<EntityArray>',\n    };\n\n    onTakeAction(evt) {\n        while (this.peekGoal() && this.peekGoal().isFinished()) {\n            this.popGoal().entity.destroy();\n        }\n\n        const currentGoal = this.peekGoal();\n        const result = currentGoal.takeAction();\n\n        if (result === FAILURE) {\n            this.removeGoal(currentGoal);\n        } else if (result === INVALID) {\n            this.removeGoal(currentGoal);\n            this.entity.fireEvent('take-action');\n        }\n\n        evt.handle();\n    }\n\n    removeGoal(goal) {\n        const goalsToDestroy = [];\n\n        this.goals = this.goals.filter((g) => {\n            const isSelf = Boolean(g.id === goal.entity.id);\n            const isSiblingGoal = Boolean(\n                g.goal.originalIntent &&\n                    g.goal.originalIntent.id === goal.originalIntent.id\n            );\n\n            if (isSelf || isSiblingGoal) {\n                goalsToDestroy.push(g.goal);\n                return false;\n            }\n\n            return true;\n        });\n\n        goalsToDestroy.forEach((g) => g.entity.destroy());\n    }\n\n    pushGoal(goal) {\n        if (!(goal instanceof Component)) {\n            throw new Error('Pushing non-component goal!', goal);\n        }\n\n        goal.parent = this.entity;\n\n        return this.goals.push(goal.entity);\n    }\n\n    popGoal() {\n        return this.goals.pop().goal;\n    }\n\n    peekGoal() {\n        return this.goals[this.goals.length - 1].goal;\n    }\n}\n","export const SUCCESS = 'SUCCESS';\nexport const FAILURE = 'FAILURE';\nexport const INVALID = 'INVALID';\n","import { Component } from 'geotic';\nimport * as GoalEvaluator from '../../ai/GoalEvaluator';\n\nexport class Goal extends Component {\n    static properties = {\n        name: 'Bored',\n        originalIntent: '<Entity>',\n        parent: '<Entity>',\n        target: '<Entity>',\n        complete: false,\n        data: {},\n    };\n\n    isFinished() {\n        return GoalEvaluator.isFinished(this.parent, this);\n    }\n\n    takeAction() {\n        return GoalEvaluator.takeAction(this.parent, this);\n    }\n}\n","import * as GoalTypes from './GoalTypes';\n\nconst goalTypeMap = {};\n\nObject.values(GoalTypes).forEach((goalType) => {\n    goalTypeMap[goalType.name] = goalType;\n});\n\nconst getGoalType = (name) => {\n    const type = goalTypeMap[name];\n\n    if (!type) {\n        console.warn(`GoalType (${name}) not found!`);\n    }\n\n    return type;\n};\n\nexport const isFinished = (entity, goal) => {\n    const type = getGoalType(goal.name);\n\n    return type.isFinished(entity, goal);\n};\n\nexport const takeAction = (entity, goal) => {\n    const type = getGoalType(goal.name);\n\n    return type.takeAction(entity, goal);\n};\n","import { GoalType } from './GoalType';\nimport { SUCCESS } from '../GoalActionResult';\n\nexport class BoredGoalType extends GoalType {\n    static name = 'Bored';\n\n    static isFinished = (entity, goal) => {\n        return false;\n    };\n\n    static takeAction = (entity, goal) => {\n        const evt = entity.fireEvent('boredom');\n\n        if (evt.data.goal) {\n            entity.brain.pushGoal(evt.data.goal);\n            entity.fireEvent('take-action');\n\n            return SUCCESS;\n        }\n\n        entity.fireEvent('consume-energy', 1000);\n\n        return SUCCESS;\n    };\n}\n","import { FAILURE } from '../GoalActionResult';\nimport { game } from '../../core/Game';\n\nexport class GoalType {\n    static name = 'Unknown';\n\n    static isFinished(entity, goal) {\n        return false;\n    }\n\n    static takeAction(entity, goal) {\n        return FAILURE;\n    }\n\n    static createAsSubGoal(originalIntent, properties = {}) {\n        return this.create({\n            ...properties,\n            originalIntent: originalIntent.entity.id,\n        });\n    }\n\n    static create(properties = {}) {\n        return game.ecs.createPrefab('Goal', {\n            goal: {\n                name: this.name,\n                ...properties,\n            },\n        }).goal;\n    }\n}\n","import { GoalType } from './GoalType';\nimport { SUCCESS, FAILURE } from '../GoalActionResult';\n\nexport class EatFoodGoalType extends GoalType {\n    static name = 'EatFood';\n\n    static isFinished = (entity, goal) => {\n        return goal.complete;\n    };\n\n    static takeAction = (entity, goal) => {\n        const evt = entity.fireEvent('try-eat-food', {\n            food: 10000,\n        });\n\n        if (evt.handled) {\n            goal.complete = true;\n\n            return SUCCESS;\n        }\n\n        return FAILURE;\n    };\n}\n","import { GoalType } from './GoalType';\nimport { EatFoodGoalType } from './EatFoodGoalType';\nimport { SUCCESS } from '../GoalActionResult';\n\nexport class SatisfyHungerGoalType extends GoalType {\n    static name = 'SatisfyHunger';\n\n    static isFinished = (entity, goal) => {\n        return !entity.eater.isHungry;\n    };\n\n    static takeAction = (entity, goal) => {\n        entity.brain.pushGoal(EatFoodGoalType.createAsSubGoal(goal));\n        entity.brain.pushGoal(EatFoodGoalType.createAsSubGoal(goal));\n\n        entity.fireEvent('take-action');\n\n        return SUCCESS;\n    };\n}\n","import { GoalType } from './GoalType';\nimport { SUCCESS, FAILURE } from '../GoalActionResult';\n\nexport class MoveGoalType extends GoalType {\n    static name = 'Move';\n\n    static isFinished = (entity, goal) => {\n        return goal.complete;\n    };\n\n    static takeAction = (entity, goal) => {\n        const evt = entity.fireEvent('try-move', {\n            x: goal.data.x,\n            y: goal.data.y,\n        });\n\n        if (evt.handled) {\n            goal.complete = true;\n\n            return SUCCESS;\n        }\n\n        return FAILURE;\n    };\n}\n","import { Component } from 'geotic';\nimport { SatisfyHungerGoalType } from '../../ai/GoalTypes';\n\nexport class Eater extends Component {\n    static properties = {\n        hunger: 6000,\n    };\n\n    get isHungry() {\n        return this.hunger <= 3000;\n    }\n\n    onBoredom(evt) {\n        if (this.isHungry) {\n            evt.data.goal = SatisfyHungerGoalType.create();\n            evt.handle();\n        }\n    }\n\n    onTryEatFood(evt) {\n        if (Math.random() < 0.75) {\n            this.entity.fireEvent('log', 'eats some food');\n            this.hunger += evt.data.food;\n            this.entity.fireEvent('energy-consumed', 150);\n\n            evt.handle();\n        } else {\n            this.entity.fireEvent('log', 'fails to eat the food');\n        }\n    }\n}\n","import { Component } from 'geotic';\n\nexport class Moniker extends Component {\n    static properties = {\n        name: 'Unknown',\n    };\n}\n","import { Component } from 'geotic';\nimport { Moniker } from './Moniker';\n\nexport class Logger extends Component {\n    get moniker() {\n        return this.entity.has(Moniker) ? this.entity.moniker.name : 'Unknown';\n    }\n\n    onLog(evt) {\n        console.log(`[${this.moniker}]`, evt.data);\n        evt.handle();\n    }\n}\n","import { Component } from 'geotic';\n\nexport class Position extends Component {\n    static properties = {\n        x: 0,\n        y: 0,\n    };\n}\n","import { Component } from 'geotic';\nimport { MapLayer } from './MapLayer';\n\nexport class Map extends Component {\n    static properties = {\n        name: '',\n        width: 32,\n        height: 32,\n    };\n\n    get map() {\n        return this.mapEntity.map;\n    }\n\n    idx(x, y) {\n        return y * this.width + x;\n    }\n\n    coord(idx) {\n        return idx % this.width, idx / this.width;\n    }\n\n    getLayer(name) {\n        return this.entity.get(MapLayer, name);\n    }\n}\n","import { Component } from 'geotic';\n\nexport class MapLayer extends Component {\n    static properties = {\n        mapEntity: '<Entity>',\n        name: '',\n        content: '<EntityArray>',\n    };\n\n    get map() {\n        return this.mapEntity.map;\n    }\n\n    getByIndex(idx) {\n        return content[idx];\n    }\n\n    get(x, y) {}\n}\n","import { Component } from 'geotic';\n\nexport class Glyph extends Component {\n    static properties = {\n        fg: '#fff',\n        bg: 'transparent',\n        char: '',\n    };\n}\n","import { Component } from 'geotic';\nimport { Position } from './Position';\nimport { Actor } from './Actor';\n\nexport class Legs extends Component {\n    onTryMove(evt) {\n        if (!this.entity.has(Position)) {\n            return;\n        }\n\n        if (this.entity.has(Actor) && !this.entity.actor.hasEnergy) {\n            return;\n        }\n\n        this.entity.position.x += evt.data.x;\n        this.entity.position.y += evt.data.y;\n        this.entity.fireEvent('energy-consumed', 750);\n\n        evt.handle();\n    }\n}\n","import { Component } from 'geotic';\nimport { DIR_Z } from '../../enums/Directions';\n\nexport class MoveCommand extends Component {\n    static properties = {\n        direction: DIR_Z,\n    };\n}\n","const directions = [\n    {\n        key: 0,\n        shortName: 'NW',\n        fullName: 'Northwest',\n        delta: {\n            x: -1,\n            y: -1,\n        },\n    },\n    {\n        key: 1,\n        shortName: 'N',\n        fullName: 'North',\n        delta: {\n            x: 0,\n            y: -1,\n        },\n    },\n    {\n        key: 2,\n        shortName: 'NE',\n        fullName: 'Northeast',\n        delta: {\n            x: 1,\n            y: -1,\n        },\n    },\n    {\n        key: 3,\n        shortName: 'W',\n        fullName: 'West',\n        delta: {\n            x: -1,\n            y: 0,\n        },\n    },\n    {\n        key: 4,\n        shortName: 'Z',\n        fullName: 'Here',\n        delta: {\n            x: 0,\n            y: 0,\n        },\n    },\n    {\n        key: 5,\n        shortName: 'E',\n        fullName: 'East',\n        delta: {\n            x: 1,\n            y: 0,\n        },\n    },\n    {\n        key: 6,\n        shortName: 'SW',\n        fullName: 'Southwest',\n        delta: {\n            x: -1,\n            y: 1,\n        },\n    },\n    {\n        key: 7,\n        shortName: 'S',\n        fullName: 'South',\n        delta: {\n            x: 0,\n            y: 1,\n        },\n    },\n    {\n        key: 8,\n        shortName: 'SE',\n        fullName: 'Southeast',\n        delta: {\n            x: 1,\n            y: 1,\n        },\n    },\n];\n\nexport const DIR_NW = 0;\nexport const DIR_N = 1;\nexport const DIR_NE = 2;\nexport const DIR_W = 3;\nexport const DIR_Z = 4;\nexport const DIR_E = 5;\nexport const DIR_SW = 6;\nexport const DIR_S = 7;\nexport const DIR_SE = 8;\n\nexport const shortName = (direction) => directions[direction].shortName;\n\nexport const fullName = (direction) => directions[direction].fullName;\n\nexport const delta = (direction) => directions[direction].delta;\n","import { Component } from 'geotic';\n\nexport class IsPlayer extends Component {}\n","import { Component } from 'geotic';\nimport { MoveGoalType } from '../../ai/GoalTypes';\nimport * as Directions from '../../enums/Directions';\n\nexport class Wandering extends Component {\n    onBoredom(evt) {\n        if (Math.random() > 0.25) {\n            return\n        }\n\n        const direction = Math.floor(Math.random() * 9);\n        const delta = Directions.delta(direction);\n\n        evt.data.goal = MoveGoalType.create({\n            data: delta,\n        });\n        evt.handle();\n    }\n}\n","export default class System {\n    #game = null;\n\n    get game() {\n        return this.#game;\n    }\n\n    constructor(game) {\n        this.#game = game;\n    }\n\n    update(dt) {}\n}\n","import ecs from '../ecs';\nimport { Actor } from '../ecs/components';\nimport System from './System';\n\nexport default class ActionSystem extends System {\n    #query = null;\n\n    constructor(game) {\n        super(game);\n\n        this.#query = game.ecs.createQuery({\n            all: [Actor],\n        });\n    }\n\n    update(dt) {\n        const entities = this.#query.get();\n        const sorted = Array.from(entities);\n        sorted.sort((a, b) => (a.actor.energy < b.actor.energy ? 1 : -1));\n\n        let entity = sorted[0];\n\n        if (!entity.actor.hasEnergy) {\n            this.game.clock.incrementTick(-1 * entity.actor.energy);\n\n            entities.forEach((entity) => {\n                entity.actor.addEnergy(this.game.clock.tickDelta);\n            });\n        }\n\n        while (entity.actor.hasEnergy && !entity.isPlayer) {\n            entity.fireEvent('take-action');\n            entity = sorted.shift();\n        }\n    }\n}\n","import { Engine } from 'geotic';\n\nimport * as components from './components';\nimport * as prefabs from './prefabs';\nimport Manager from '../core/Manager';\n\nexport default class ECS extends Manager {\n    #engine;\n\n    get engine() {\n        return this.#engine;\n    }\n\n    constructor(game) {\n        super(game);\n        this.#engine = new Engine();\n\n        Object.values(components).forEach((component) => {\n            this.#engine.registerComponent(component);\n        });\n\n        Object.values(prefabs).forEach((prefab) => {\n            this.#engine.registerPrefab(prefab);\n        });\n    }\n\n    onNewGame() {\n        for (let entity of this.#engine.entities.all) {\n            entity.destroy();\n        }\n    }\n\n    onSaveGame() {\n        return {\n            engine: this.#engine.serialize(),\n        };\n    }\n\n    onLoadGame(data) {\n        for (let entity of this.#engine.entities.all) {\n            entity.destroy();\n        }\n\n        this.#engine.deserialize(data.engine);\n    }\n}\n","import { Glyph, Position } from '../ecs/components';\nimport System from './System';\n\nexport default class RenderSystem extends System {\n    #query = null;\n\n    constructor(game) {\n        super(game);\n        this.#query = game.ecs.createQuery({\n            all: [Glyph, Position],\n        });\n    }\n\n    render() {\n        this.game.renderer.clear();\n\n        this.#query.get().forEach((renderable) => {\n            this.game.renderer.drawSprite(\n                renderable.position.x,\n                renderable.position.y,\n                renderable.glyph.char,\n                renderable.glyph.fg,\n                renderable.glyph.bg\n            );\n        });\n    }\n\n    update(dt) {\n        if (!this.game.clock.tickDelta) {\n            return;\n        }\n\n        this.render();\n    }\n}\n","import { MoveCommand, Position } from '../ecs/components';\nimport * as Directions from '../enums/Directions';\nimport System from './System';\n\nexport default class MovementSystem extends System {\n    #query = null;\n\n    constructor(game) {\n        super(game);\n        this.#query = game.ecs.createQuery({\n            all: [MoveCommand, Position],\n        });\n    }\n\n    update(dt) {\n        this.#query.get().forEach((entity) => {\n            const delta = Directions.delta(entity.moveCommand.direction);\n\n            entity.fireEvent('TryMove', delta);\n\n            entity.moveCommand.destroy();\n        });\n    }\n}\n","import { Moniker, Actor } from '../ecs/components';\nimport System from './System';\n\nexport default class UISystem extends System {\n    #query = null;\n\n    constructor(game) {\n        super(game);\n        this.#query = this.game.ecs.createQuery({\n            all: [Moniker, Actor],\n        });\n    }\n\n    update(dt) {\n        const turn = this.game.clock.turn;\n        const subTurn = `${this.game.clock.subTurn}`.padEnd(3, '0');\n\n        const x = this.game.mouse.x;\n        const y = this.game.mouse.y;\n        const hasMouse = this.game.mouse.hasMouse;\n\n        this.game.renderer.drawText(\n            1,\n            1,\n            `Knossonia (${x}, ${y}) ${hasMouse}`\n        );\n\n        const str = `${turn}.${subTurn}`;\n        const len = Math.ceil(this.game.renderer.computeTextWidth(str))\n\n        this.game.renderer.drawText(\n            this.game.renderer.width - 1 - len,\n            1,\n            str\n        );\n    }\n}\n","import Manager from '../Manager';\n\nexport default class MouseManager extends Manager {\n    #x = 0;\n    #y = 0;\n    #hasMouse = false;\n\n    get x() {\n        return this.#x;\n    }\n\n    get y() {\n        return this.#y;\n    }\n\n    get hasMouse() {\n        return this.#hasMouse;\n    }\n\n    updatePosition(x, y) {\n        this.#x = Math.max(0, x);\n        this.#y = Math.max(0, y);\n    }\n\n    updateMouseEnter() {\n        this.#hasMouse = true;\n    }\n\n    updateMouseLeave() {\n        this.#hasMouse = false;\n    }\n}\n","import { INPUT_DOMAIN_DEFAULT } from './InputDomainType';\nimport commands from './commands';\nimport Manager from '../Manager';\n\nexport default class CommandManager extends Manager {\n    #commands = {};\n    #domainStack = [INPUT_DOMAIN_DEFAULT];\n\n    constructor(game) {\n        super(game);\n        commands.forEach((cmd) => this.registerCommand(cmd));\n    }\n\n    onInputEvent(evt) {\n        const cmd = this.getCommandForInputEvent(evt);\n\n        if (cmd) {\n            this.game.screens.onInputCommand(cmd);\n        }\n    }\n\n    pushDomain(domain) {\n        this.#domainStack.push(domain);\n    }\n\n    popDomain(domain) {\n        const index = this.#domainStack.lastIndexOf(domain);\n\n        if (index > -1) {\n            this.#domainStack.splice(index, 1);\n        }\n    }\n\n    getDomainCommands(domain) {\n        return this.#commands[domain] || [];\n    }\n\n    getCommandForInputEvent(evt) {\n        for (let i = this.#domainStack.length - 1; i >= 0; i--) {\n            const domain = this.#domainStack[i];\n            const cmds = this.getDomainCommands(domain);\n            const cmd = cmds.find((cmd) => cmd.matches(evt));\n\n            if (cmd) {\n                return cmd;\n            }\n        }\n    }\n\n    registerCommand(command) {\n        if (!this.#commands[command.domain]) {\n            this.#commands[command.domain] = [];\n        }\n\n        this.#commands[command.domain].push(command);\n    }\n}\n","export const INPUT_DOMAIN_DEFAULT = 0;\nexport const INPUT_DOMAIN_MAIN_MENU = 1;\nexport const INPUT_DOMAIN_ADVENTURE = 2;\nexport const INPUT_DOMAIN_LOOK = 3;\n","import {\n    INPUT_DOMAIN_MAIN_MENU,\n    INPUT_DOMAIN_DEFAULT,\n    INPUT_DOMAIN_ADVENTURE,\n} from './InputDomainType';\nimport InputCommand from './InputCommand';\nimport {\n    INPUT_CMD_WAIT,\n    INPUT_CMD_MOVE_NW,\n    INPUT_CMD_MOVE_N,\n    INPUT_CMD_MOVE_NE,\n    INPUT_CMD_MOVE_W,\n    INPUT_CMD_MOVE_E,\n    INPUT_CMD_MOVE_SW,\n    INPUT_CMD_MOVE_S,\n    INPUT_CMD_MOVE_SE,\n    INPUT_CMD_CONFIRM,\n    INPUT_CMD_CANCEL,\n    INPUT_CMD_SAVE,\n    INPUT_CMD_LOAD,\n    INPUT_CMD_LOOK,\n} from './InputCommandType';\nimport {\n    KEY_S,\n    KEY_Q,\n    KEY_W,\n    KEY_E,\n    KEY_A,\n    KEY_D,\n    KEY_Z,\n    KEY_X,\n    KEY_C,\n    KEY_ENTER,\n    KEY_ESCAPE,\n    KEY_UP,\n    KEY_LEFT,\n    KEY_RIGHT,\n    KEY_DOWN,\n    KEY_SPACE,\n    KEY_L,\n} from './KeyCodes';\n\nconst cmd = (domain, type, name, isKeyboard, key, shift, ctrl, alt, meta) =>\n    new InputCommand({\n        domain,\n        type,\n        name,\n        isKeyboard,\n        key,\n        shift,\n        ctrl,\n        alt,\n        meta,\n    });\n\n// prettier-ignore\nexport default [\n    // DOMAIN                   CMD                 NAME        KB    KEY           SHIFT  CTRL   ALT    META\n    cmd(INPUT_DOMAIN_DEFAULT,   INPUT_CMD_CONFIRM,  'confirm',  true, KEY_ENTER,    false, false, false, false),\n    cmd(INPUT_DOMAIN_DEFAULT,   INPUT_CMD_CONFIRM,  'confirm2', true, KEY_SPACE,    false, true,  false, false),\n    cmd(INPUT_DOMAIN_DEFAULT,   INPUT_CMD_CANCEL,   'cancel',   true, KEY_ESCAPE,   false, false, false, false),\n    cmd(INPUT_DOMAIN_DEFAULT,   INPUT_CMD_SAVE,     'save',     true, KEY_S,        false, true,  false, false),\n    cmd(INPUT_DOMAIN_DEFAULT,   INPUT_CMD_LOAD,     'load',     true, KEY_L,        false, true,  false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_WAIT,     'wait',     true, KEY_S,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_NW,  'move_nw',  true, KEY_Q,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_N,   'move_n',   true, KEY_W,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_N,   'move_n2',  true, KEY_UP,       false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_NE,  'move_ne',  true, KEY_E,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_W,   'move_w',   true, KEY_A,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_W,   'move_w2',  true, KEY_LEFT,     false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_E,   'move_e',   true, KEY_D,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_E,   'move_e2',  true, KEY_RIGHT,    false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_SW,  'move_sw',  true, KEY_Z,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_S,   'move_s',   true, KEY_X,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_S,   'move_s2',  true, KEY_DOWN,     false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_MOVE_SE,  'move_se',  true, KEY_C,        false, false, false, false),\n    cmd(INPUT_DOMAIN_ADVENTURE, INPUT_CMD_LOOK,     'look',     true, KEY_L,        false, false, false, false),\n];\n","import InputKeyboardEvent from './events/InputEvent';\n\nexport default class InputCommand {\n    constructor(data) {\n        this.domain = data.domain;\n        this.type = data.type;\n        this.name = data.name;\n        this.isKeyboard = data.isKeyboard;\n        this.key = data.key;\n        this.shift = data.shift;\n        this.ctrl = data.ctrl;\n        this.alt = data.alt;\n        this.meta = data.meta;\n    }\n\n    matches(inputEvent) {\n        const isKeyboard = inputEvent instanceof InputKeyboardEvent;\n\n        return (\n            this.isKeyboard == isKeyboard &&\n            this.key == inputEvent.key &&\n            this.shift == inputEvent.shift &&\n            this.ctrl == inputEvent.ctrl &&\n            this.alt == inputEvent.alt &&\n            this.meta == inputEvent.meta\n        );\n    }\n}\n","export const INPUT_CMD_MOVE_NW = 0;\nexport const INPUT_CMD_MOVE_N = 1;\nexport const INPUT_CMD_MOVE_NE = 2;\nexport const INPUT_CMD_MOVE_W = 3;\nexport const INPUT_CMD_MOVE_E = 4;\nexport const INPUT_CMD_MOVE_SW = 5;\nexport const INPUT_CMD_MOVE_S = 6;\nexport const INPUT_CMD_MOVE_SE = 7;\nexport const INPUT_CMD_WAIT = 8;\nexport const INPUT_CMD_CONFIRM = 9;\nexport const INPUT_CMD_CANCEL = 10;\nexport const INPUT_CMD_SAVE = 11;\nexport const INPUT_CMD_LOAD = 12;\nexport const INPUT_CMD_LOOK = 13;\n","export const KEY_CANCEL = 3;\nexport const KEY_HELP = 6;\nexport const KEY_BACK_SPACE = 8;\nexport const KEY_TAB = 9;\nexport const KEY_CLEAR = 12;\nexport const KEY_ENTER = 13;\nexport const KEY_ENTER_SPECIAL = 14;\nexport const KEY_SHIFT = 16;\nexport const KEY_CONTROL = 17;\nexport const KEY_ALT = 18;\nexport const KEY_PAUSE = 19;\nexport const KEY_CAPS_LOCK = 20;\nexport const KEY_KANA = 21;\nexport const KEY_EISU = 22;\nexport const KEY_JUNJA = 23;\nexport const KEY_FINAL = 24;\nexport const KEY_HANJA = 25;\nexport const KEY_ESCAPE = 27;\nexport const KEY_CONVERT = 28;\nexport const KEY_NONCONVERT = 29;\nexport const KEY_ACCEPT = 30;\nexport const KEY_MODECHANGE = 31;\nexport const KEY_SPACE = 32;\nexport const KEY_PAGE_UP = 33;\nexport const KEY_PAGE_DOWN = 34;\nexport const KEY_END = 35;\nexport const KEY_HOME = 36;\nexport const KEY_LEFT = 37;\nexport const KEY_UP = 38;\nexport const KEY_RIGHT = 39;\nexport const KEY_DOWN = 40;\nexport const KEY_SELECT = 41;\nexport const KEY_PRINT = 42;\nexport const KEY_EXECUTE = 43;\nexport const KEY_PRINTSCREEN = 44;\nexport const KEY_INSERT = 45;\nexport const KEY_DELETE = 46;\nexport const KEY_NUM_0 = 48;\nexport const KEY_NUM_1 = 49;\nexport const KEY_NUM_2 = 50;\nexport const KEY_NUM_3 = 51;\nexport const KEY_NUM_4 = 52;\nexport const KEY_NUM_5 = 53;\nexport const KEY_NUM_6 = 54;\nexport const KEY_NUM_7 = 55;\nexport const KEY_NUM_8 = 56;\nexport const KEY_NUM_9 = 57;\nexport const KEY_COLON = 58;\nexport const KEY_SEMICOLON = 59;\nexport const KEY_LESS_THAN = 60;\nexport const KEY_EQUALS = 61;\nexport const KEY_GREATER_THAN = 62;\nexport const KEY_QUESTION_MARK = 63;\nexport const KEY_AT = 64;\nexport const KEY_A = 65;\nexport const KEY_B = 66;\nexport const KEY_C = 67;\nexport const KEY_D = 68;\nexport const KEY_E = 69;\nexport const KEY_F = 70;\nexport const KEY_G = 71;\nexport const KEY_H = 72;\nexport const KEY_I = 73;\nexport const KEY_J = 74;\nexport const KEY_K = 75;\nexport const KEY_L = 76;\nexport const KEY_M = 77;\nexport const KEY_N = 78;\nexport const KEY_O = 79;\nexport const KEY_P = 80;\nexport const KEY_Q = 81;\nexport const KEY_R = 82;\nexport const KEY_S = 83;\nexport const KEY_T = 84;\nexport const KEY_U = 85;\nexport const KEY_V = 86;\nexport const KEY_W = 87;\nexport const KEY_X = 88;\nexport const KEY_Y = 89;\nexport const KEY_Z = 90;\nexport const KEY_META = 91; // windows key (windows) or command key (mac)\nexport const KEY_CONTEXT_MENU = 93;\nexport const KEY_SLEEP = 95;\nexport const KEY_NUMPAD_0 = 96;\nexport const KEY_NUMPAD_1 = 97;\nexport const KEY_NUMPAD_2 = 98;\nexport const KEY_NUMPAD_3 = 99;\nexport const KEY_NUMPAD_4 = 100;\nexport const KEY_NUMPAD_5 = 101;\nexport const KEY_NUMPAD_6 = 102;\nexport const KEY_NUMPAD_7 = 103;\nexport const KEY_NUMPAD_8 = 104;\nexport const KEY_NUMPAD_9 = 105;\nexport const KEY_MULTIPLY = 106;\nexport const KEY_ADD = 107;\nexport const KEY_SEPARATOR = 108;\nexport const KEY_SUBTRACT = 109;\nexport const KEY_DECIMAL = 110;\nexport const KEY_DIVIDE = 111;\nexport const KEY_F1 = 112;\nexport const KEY_F2 = 113;\nexport const KEY_F3 = 114;\nexport const KEY_F4 = 115;\nexport const KEY_F5 = 116;\nexport const KEY_F6 = 117;\nexport const KEY_F7 = 118;\nexport const KEY_F8 = 119;\nexport const KEY_F9 = 120;\nexport const KEY_F10 = 121;\nexport const KEY_F11 = 122;\nexport const KEY_F12 = 123;\nexport const KEY_F13 = 124;\nexport const KEY_F14 = 125;\nexport const KEY_F15 = 126;\nexport const KEY_F16 = 127;\nexport const KEY_F17 = 128;\nexport const KEY_F18 = 129;\nexport const KEY_F19 = 130;\nexport const KEY_F20 = 131;\nexport const KEY_F21 = 132;\nexport const KEY_F22 = 133;\nexport const KEY_F23 = 134;\nexport const KEY_F24 = 135;\nexport const KEY_NUM_LOCK = 144;\nexport const KEY_SCROLL_LOCK = 145;\nexport const KEY_WIN_OEM_FJ_JISHO = 146;\nexport const KEY_WIN_OEM_FJ_MASSHOU = 147;\nexport const KEY_WIN_OEM_FJ_TOUROKU = 148;\nexport const KEY_WIN_OEM_FJ_LOYA = 149;\nexport const KEY_WIN_OEM_FJ_ROYA = 150;\nexport const KEY_CIRCUMFLEX = 160;\nexport const KEY_EXCLAMATION = 161;\nexport const KEY_DOUBLE_QUOTE = 162;\nexport const KEY_HASH = 163;\nexport const KEY_DOLLAR = 164;\nexport const KEY_PERCENT = 165;\nexport const KEY_AMPERSAND = 166;\nexport const KEY_UNDERSCORE = 167;\nexport const KEY_OPEN_PAREN = 168;\nexport const KEY_CLOSE_PAREN = 169;\nexport const KEY_ASTERISK = 170;\nexport const KEY_PLUS = 171;\nexport const KEY_PIPE = 172;\nexport const KEY_HYPHEN_MINUS = 173;\nexport const KEY_OPEN_CURLY_BRACKET = 174;\nexport const KEY_CLOSE_CURLY_BRACKET = 175;\nexport const KEY_TILDE = 176;\nexport const KEY_VOLUME_MUTE = 181;\nexport const KEY_VOLUME_DOWN = 182;\nexport const KEY_VOLUME_UP = 183;\nexport const KEY_SEMICOLON_2 = 186;\nexport const KEY_EQUALS_2 = 187;\nexport const KEY_COMMA = 188;\nexport const KEY_MINUS = 189;\nexport const KEY_PERIOD = 190;\nexport const KEY_SLASH = 191;\nexport const KEY_BACK_QUOTE = 192;\nexport const KEY_OPEN_BRACKET = 219;\nexport const KEY_BACK_SLASH = 220;\nexport const KEY_CLOSE_BRACKET = 221;\nexport const KEY_QUOTE = 222;\nexport const KEY_META_2 = 224;\nexport const KEY_ALTGR = 225;\nexport const KEY_WIN_ICO_HELP = 227;\nexport const KEY_WIN_ICO_00 = 228;\nexport const KEY_WIN_ICO_CLEAR = 230;\nexport const KEY_WIN_OEM_RESET = 233;\nexport const KEY_WIN_OEM_JUMP = 234;\nexport const KEY_WIN_OEM_PA1 = 235;\nexport const KEY_WIN_OEM_PA2 = 236;\nexport const KEY_WIN_OEM_PA3 = 237;\nexport const KEY_WIN_OEM_WSCTRL = 238;\nexport const KEY_WIN_OEM_CUSEL = 239;\nexport const KEY_WIN_OEM_ATTN = 240;\nexport const KEY_WIN_OEM_FINISH = 241;\nexport const KEY_WIN_OEM_COPY = 242;\nexport const KEY_WIN_OEM_AUTO = 243;\nexport const KEY_WIN_OEM_ENLW = 244;\nexport const KEY_WIN_OEM_BACKTAB = 245;\nexport const KEY_ATTN = 246;\nexport const KEY_CRSEL = 247;\nexport const KEY_EXSEL = 248;\nexport const KEY_EREOF = 249;\nexport const KEY_PLAY = 250;\nexport const KEY_ZOOM = 251;\nexport const KEY_PA1 = 253;\nexport const KEY_WIN_OEM_CLEAR = 254;\n","import { SCREEN_MAIN_MENU, SCREEN_ADVENTURE } from './ScreenType';\nimport AdventureScreen from './screens/AdventureScreen';\nimport MainMenuScreen from './screens/MainMenuScreen';\nimport Manager from '../Manager';\n\nexport default class ScreenManager extends Manager {\n    #screenType = SCREEN_MAIN_MENU;\n    #screens = {};\n\n    constructor(game) {\n        super(game);\n        this.#screens = {\n            [SCREEN_MAIN_MENU]: new MainMenuScreen(game),\n            [SCREEN_ADVENTURE]: new AdventureScreen(game),\n        };\n    }\n\n    get screen() {\n        return this.#screens[this.#screenType];\n    }\n\n    setScreen(screenType) {\n        this.screen.onLeave();\n        this.#screenType = screenType;\n        this.screen.onEnter();\n        this.game.renderSystem.render();\n    }\n\n    onInputCommand(cmd) {\n        this.screen.onInputCommand(cmd);\n    }\n\n    update(dt) {\n        this.screen.onUpdate(dt);\n    }\n\n    onLoadGame(data) {\n        this.setScreen(SCREEN_ADVENTURE);\n    }\n}\n","export const SCREEN_MAIN_MENU = 0;\nexport const SCREEN_ADVENTURE = 1;\n","import Screen from './Screen';\nimport {\n    INPUT_CMD_MOVE_N,\n    INPUT_CMD_MOVE_NE,\n    INPUT_CMD_MOVE_W,\n    INPUT_CMD_WAIT,\n    INPUT_CMD_MOVE_E,\n    INPUT_CMD_MOVE_SW,\n    INPUT_CMD_MOVE_S,\n    INPUT_CMD_MOVE_SE,\n    INPUT_CMD_MOVE_NW,\n    INPUT_CMD_CANCEL,\n    INPUT_CMD_SAVE,\n    INPUT_CMD_LOAD,\n    INPUT_CMD_LOOK,\n} from '../../input/InputCommandType';\nimport { INPUT_DOMAIN_ADVENTURE } from '../../input/InputDomainType';\nimport {\n    DIR_N,\n    DIR_W,\n    DIR_Z,\n    DIR_E,\n    DIR_S,\n    DIR_NW,\n    DIR_SW,\n    DIR_SE,\n    DIR_NE,\n} from '../../../enums/Directions';\nimport { SCREEN_MAIN_MENU } from '../ScreenType';\n\nexport default class AdventureScreen extends Screen {\n    onEnter() {\n        this.game.renderer.clear();\n        this.game.commands.pushDomain(INPUT_DOMAIN_ADVENTURE);\n    }\n\n    onLeave() {\n        this.game.commands.popDomain(INPUT_DOMAIN_ADVENTURE);\n    }\n\n    onDirectionInput(dir) {\n        if (this.game.cursor.isEnabled) {\n            this.game.cursor.move(dir);\n        } else {\n            this.game.player.move(dir);\n        }\n    }\n\n    onInputCommand(cmd) {\n        if (cmd.type === INPUT_CMD_SAVE) {\n            this.game.state.saveGame();\n        }\n        if (cmd.type === INPUT_CMD_LOAD) {\n            this.game.state.loadGame();\n        }\n        if (cmd.type === INPUT_CMD_LOOK) {\n            this.game.cursor.toggle();\n        }\n        if (cmd.type === INPUT_CMD_CANCEL) {\n            if (this.game.cursor.isEnabled) {\n                this.game.cursor.disable();\n            } else {\n                this.game.screens.setScreen(SCREEN_MAIN_MENU);\n            }\n        }\n        if (cmd.type === INPUT_CMD_WAIT) {\n            this.game.player.wait();\n        }\n        if (cmd.type === INPUT_CMD_MOVE_NW) {\n            this.onDirectionInput(DIR_NW);\n        }\n        if (cmd.type === INPUT_CMD_MOVE_N) {\n            this.onDirectionInput(DIR_N);\n        }\n        if (cmd.type === INPUT_CMD_MOVE_NE) {\n            this.onDirectionInput(DIR_NE);\n        }\n        if (cmd.type === INPUT_CMD_MOVE_W) {\n            this.onDirectionInput(DIR_W);\n        }\n        if (cmd.type === INPUT_CMD_MOVE_E) {\n            this.onDirectionInput(DIR_E);\n        }\n        if (cmd.type === INPUT_CMD_MOVE_SW) {\n            this.onDirectionInput(DIR_SW);\n        }\n        if (cmd.type === INPUT_CMD_MOVE_S) {\n            this.onDirectionInput(DIR_S);\n        }\n        if (cmd.type === INPUT_CMD_MOVE_SE) {\n            this.onDirectionInput(DIR_SE);\n        }\n    }\n}\n","export default class Screen {\n    #game;\n\n    get game() {\n        return this.#game;\n    }\n\n    constructor(game) {\n        this.#game = game;\n    }\n\n    onEnter() {}\n\n    onLeave() {}\n\n    onInputCommand(cmd) {}\n\n    onUpdate(dt) {}\n}\n","import Screen from './Screen';\nimport {\n    INPUT_CMD_CONFIRM,\n    INPUT_CMD_SAVE,\n    INPUT_CMD_LOAD,\n} from '../../input/InputCommandType';\nimport { INPUT_DOMAIN_MAIN_MENU } from '../../input/InputDomainType';\nimport { SCREEN_ADVENTURE } from '../ScreenType';\n\nexport default class MainMenuScreen extends Screen {\n    onEnter() {\n        this.game.commands.pushDomain(INPUT_DOMAIN_MAIN_MENU);\n    }\n\n    onLeave() {\n        this.game.commands.popDomain(INPUT_DOMAIN_MAIN_MENU);\n    }\n\n    onInputCommand(cmd) {\n        if (cmd.type === INPUT_CMD_CONFIRM) {\n            this.game.state.newGame();\n            this.game.screens.setScreen(SCREEN_ADVENTURE);\n        }\n\n        if (cmd.type === INPUT_CMD_SAVE) {\n            this.game.state.saveGame();\n        }\n\n        if (cmd.type === INPUT_CMD_LOAD) {\n            this.game.state.loadGame();\n        }\n    }\n\n    onUpdate(dt) {\n        this.game.renderer.clear();\n        this.game.renderer.drawText(1, 1, `Knossonia`);\n        this.game.renderer.drawText(1, 3, `press enter to embark`);\n        this.game.renderer.drawText(\n            1,\n            7,\n            `move [w, a, d, x]`\n        );\n        this.game.renderer.drawText(\n            1,\n            8,\n            `save [ctrl+s]`\n        );\n        this.game.renderer.drawText(\n            1,\n            9,\n            `load [ctrl+l]`\n        );\n    }\n}\n","import Manager from './Manager';\nimport { BoredGoalType } from '../ai/GoalTypes';\nimport { MoveCommand } from '../ecs/components';\n\nexport default class PlayerManager extends Manager {\n    #entityId = null;\n\n    get entity() {\n        return this.game.ecs.getEntity(this.#entityId);\n    }\n\n    get isTurn() {\n        return this.entity.actor.hasEnergy;\n    }\n\n    get x() {\n        return this.entity.position.x;\n    }\n\n    get y() {\n        return this.entity.position.y;\n    }\n\n    onNewGame() {\n        const player = this.game.ecs.createPrefab('Player', {\n            position: {\n                x: 16,\n                y: 16,\n            },\n        });\n\n        this.#entityId = player.id;\n\n        for (let i = 0; i < 3; i++) {\n            const wanderer = this.game.ecs.createPrefab('HumanWanderer', {\n                moniker: {\n                    name: `Wanderer ${i}`,\n                },\n                position: {\n                    x: 4 + i,\n                    y: 16,\n                },\n            });\n\n            wanderer.brain.pushGoal(BoredGoalType.create());\n        }\n\n        for (let i = 0; i < 4; i++) {\n            for (let j = 0; j < 6; j++) {\n                const type = (j + i) % 2 === 0 ? 'SmallPineTree' : 'PineTree';\n\n                this.game.ecs.createPrefab(type, {\n                    position: {\n                        x: 10 + i,\n                        y: 5 + j,\n                    },\n                });\n            }\n        }\n    }\n\n    move(direction) {\n        if (!this.isTurn) {\n            return;\n        }\n\n        if (this.entity.has(MoveCommand)) {\n            this.entity.remove(MoveCommand);\n        }\n\n        this.entity.add(MoveCommand, {\n            direction,\n        });\n    }\n\n    wait(turns = 1) {\n        if (!this.isTurn) {\n            return;\n        }\n\n        this.entity.fireEvent('energy-consumed', turns * 1000);\n    }\n\n    onSaveGame() {\n        return {\n            playerEntityId: this.#entityId,\n        };\n    }\n\n    onLoadGame(data) {\n        this.#entityId = data.playerEntityId;\n    }\n}\n","import Manager from './Manager';\n\nexport default class GameStateManager extends Manager {\n    newGame() {\n        console.log('NEW GAME');\n        this.game.clock.onNewGame();\n        this.game.engine.onNewGame();\n        this.game.player.onNewGame();\n    }\n\n    saveGame() {\n        const data = {\n            ...this.game.clock.onSaveGame(),\n            ...this.game.player.onSaveGame(),\n            ...this.game.engine.onSaveGame(),\n        };\n\n        console.log('SAVE GAME', data);\n        localStorage.setItem('save', JSON.stringify(data));\n    }\n\n    loadGame() {\n        const data = JSON.parse(localStorage.getItem('save'));\n\n        console.log('LOAD GAME', data);\n\n        this.game.clock.onLoadGame(data);\n        this.game.engine.onLoadGame(data);\n        this.game.player.onLoadGame(data);\n        this.game.screens.onLoadGame(data);\n    }\n}\n","import Manager from './Manager';\n\nexport default class ClockManager extends Manager {\n    #tick = 0;\n    #tickDelta = 0;\n\n    get tick() {\n        return this.#tick;\n    }\n\n    get tickDelta() {\n        return this.#tickDelta;\n    }\n\n    get turn() {\n        return Math.floor(this.#tick / 1000);\n    }\n\n    get subTurn() {\n        return this.#tick - this.turn * 1000;\n    }\n\n    incrementTick(delta) {\n        this.#tickDelta = delta;\n        this.#tick += delta;\n    }\n\n    onNewGame() {\n        this.#tick = 0;\n        this.#tickDelta = 0;\n    }\n\n    onLoadGame(data) {\n        this.#tick = data.clock.tick;\n        this.#tickDelta = data.clock.tickDelta;\n    }\n\n    onSaveGame() {\n        return {\n            clock: {\n                tick: this.tick,\n                tickDelta: this.tickDelta\n            }\n        };\n    }\n}\n","import * as Directions from '../enums/Directions';\nimport System from './System';\n\nexport default class CursorSystem extends System {\n    #isEnabled = false;\n    #x = 1;\n    #y = 1;\n\n    get x() {\n        return this.#x;\n    }\n\n    get y() {\n        return this.#y;\n    }\n\n    get isEnabled() {\n        return this.#isEnabled;\n    }\n\n    enable() {\n        this.#x = this.game.player.x;\n        this.#y = this.game.player.y;\n        this.#isEnabled = true;\n    }\n\n    disable() {\n        this.#isEnabled = false;\n    }\n\n    toggle() {\n        if (this.isEnabled) {\n            this.disable();\n        } else {\n            this.enable();\n        }\n    }\n\n    move(direction) {\n        const delta = Directions.delta(direction);\n        this.#x += delta.x;\n        this.#y += delta.y;\n    }\n\n    update(dt) {\n        if (!this.#isEnabled) {\n            return;\n        }\n\n        this.game.renderer.draw(this.x, this.y, 'X', 'yellow');\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tif(mode & 2 && typeof value == 'object' && value) {\n\t\tfor(const key in value) def[key] = () => value[key];\n\t}\n\tdef['default'] = () => value;\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module\n__webpack_require__(0);\n// This entry module used 'exports' so it can't be inlined\n"],"sourceRoot":""}